# 7\. Vulnerability Scanning

In this Learning Module, we will cover the following Learning Units:

-   Vulnerability Scanning Theory
-   Vulnerability Scanning with Nessus
-   Vulnerability Scanning with Nmap

The discovery of vulnerabilities is an integral part of any security assessment. The process of identifying the attack surface of a piece of software, system, or network is called [_Vulnerability Scanning_](https://en.wikipedia.org/wiki/Vulnerability_scanner).

Vulnerability scanners come in many different forms, from individual scripts that identify a single vulnerability to complex commercial solutions that scan a broad variety of vulnerabilities. Automated vulnerability scanners can be invaluable for penetration testers as they help quickly establish a baseline on the target network before performing a more thorough manual testing analysis to get adequate coverage. Common types of vulnerability scanners are web application and network vulnerability scanners.

In this Module, we will analyze automated network vulnerability scanning. We'll begin with the theory behind vulnerability scanning and then use [_Nessus_](https://www.tenable.com/products/nessus) and [_Nmap_](https://nmap.org) to perform different kinds of vulnerability scans.

## 7.1. Vulnerability Scanning Theory

This Learning Unit covers the following Learning Objectives:

-   Gain a basic understanding of the vulnerability scanning process
-   Learn about the different types of vulnerability scans
-   Understand the considerations of a vulnerability scan

In this Learning Unit, we'll discuss the theory behind vulnerability scanning. Before inspecting our tools, we need to outline the basic workflow of a vulnerability scanner and understand how it finds vulnerabilities. We will also review the different types and considerations of a vulnerability scan.

## 7.1.1. How Vulnerability Scanners Work

Every vulnerability scanner has its own customized workflow but the basic process behind vulnerability scanning is implementation independent. The basic process of an automated vulnerability scanner can be described as:

1.  Host discovery
2.  Port scanning
3.  Operating system, service, and version detection
4.  Matching the results to a vulnerability database

[_Host Discovery_](https://capec.mitre.org/data/definitions/292.html) tells the scanner if the target is up and responding. The scanner then uses various techniques to identify all open ports on the system and detect all remotely accessible services with corresponding versions. In addition, operating system detection will be done in this step.

Based on all gathered information, the vulnerability scanner will then query a vulnerability database to match the found data to vulnerabilities. Examples of vulnerability databases are the [_National Vulnerability Database_](https://nvd.nist.gov) and the [_Common Vulnerabilities and Exposures_](https://cve.mitre.org/cve/search_cve_list.html) (CVE) program.

Most commercial vulnerability scanners also have the functionality to verify found vulnerabilities by attempting to partially or fully exploit them. This can significantly reduce missed vulnerabilities but can impact the stability of the service or system.

Vulnerabilities are identified by the [CVE system](https://cve.mitre.org). While this allows us to identify and find verified vulnerabilities, the CVE identifier provides no information about the severity of a vulnerability.

The [_Common Vulnerability Scoring System_](https://nvd.nist.gov/vuln-metrics/cvss) (CVSS) is a framework for addressing the characteristics and severity of vulnerabilities. Each CVE has a CVSS score assigned. The two major versions are [CVSS v2](https://www.first.org/cvss/v2/guide) and [CVSS v3](https://www.first.org/cvss/user-guide). Both versions use a range from 0 to 10 to rate vulnerabilities with different severity labels. The following figure from the [_National Institute of Standards and Technology_](https://www.nist.gov/) (NIST) lists the range of the base score and associated severity for CVSS v2.0 and CVSS v3.0.

![Figure 1: CVSS Ratings](https://static.offsec.com/offsec-courses/PEN-200/imgs/vulnscan/fb1c4b88cfa79e2b55f21ff88ad29222-vulnscan_cvssv1.png)

Figure 1: CVSS Ratings

To obtain a CVSS score, we can review the CVE in a vulnerability database, or if there is no CVE assigned, we can use a [_CVSS calculator_](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator). In 2019, CVSS v3.1 was released, which clarified and improved the existing version.

We need to be aware that the results of a vulnerability scan can be incomplete or contain wrongfully detected vulnerabilities.

A [_false positive_](https://www.cgisecurity.com/questions/falsepositive.shtml) occurs when a vulnerability is detected but the target is not vulnerable. This can happen through a wrong service and version detection or a configuration that makes the target unexploitable. False positives can also occur when patches or updates are [_backported_](https://access.redhat.com/security/updates/backporting), meaning that security fixes are applied to an older version of software.

[_False negative_](https://www.cgisecurity.com/questions/falsenegative.shtml) is another important term. It occurs when a vulnerability is missed by the vulnerability scanner.

In a penetration test, we often need to find the right balance between manual and automated vulnerability scanning. Let's explore both options briefly.

A manual vulnerability scan will inevitably be very resource-intensive and time-consuming. When there is a huge amount of data to analyze, we often reach our cognitive limit quickly and overlook vital details. On the other hand, manual vulnerability scanning allows for the discovery of complex and logical vulnerabilities that are rather difficult to discover using any type of automated scanner.

Automated vulnerability scans are invaluable when working on engagements for a multitude of reasons. First, in nearly all types of assessments, we have time constraints. Therefore, when we have a big enterprise network to scan, we cannot manually review every system. This is especially true when thinking about new or complex vulnerabilities. Second, by using automated scanners, we can quickly identify easily detected vulnerabilities and other low-hanging fruit.

We should take the time to explore the inner workings of every automated tool we plan to use in a security assessment. This will not only assist us in configuring the tool and digesting the results properly but doing that will help us understand the limitations that must be overcome with manually applied expertise.

#### Labs

1.  Is this a false positive or a false negative? A vulnerability scanner identifies a vulnerability for a Linux web server. The target runs on Windows and the vulnerability is only exploitable on Linux.

Answer

# 7\. Vulnerability Scanning

In this Learning Module, we will cover the following Learning Units:

-   Vulnerability Scanning Theory
-   Vulnerability Scanning with Nessus
-   Vulnerability Scanning with Nmap

The discovery of vulnerabilities is an integral part of any security assessment. The process of identifying the attack surface of a piece of software, system, or network is called [_Vulnerability Scanning_](https://en.wikipedia.org/wiki/Vulnerability_scanner).

Vulnerability scanners come in many different forms, from individual scripts that identify a single vulnerability to complex commercial solutions that scan a broad variety of vulnerabilities. Automated vulnerability scanners can be invaluable for penetration testers as they help quickly establish a baseline on the target network before performing a more thorough manual testing analysis to get adequate coverage. Common types of vulnerability scanners are web application and network vulnerability scanners.

In this Module, we will analyze automated network vulnerability scanning. We'll begin with the theory behind vulnerability scanning and then use [_Nessus_](https://www.tenable.com/products/nessus) and [_Nmap_](https://nmap.org) to perform different kinds of vulnerability scans.

## 7.1. Vulnerability Scanning Theory

This Learning Unit covers the following Learning Objectives:

-   Gain a basic understanding of the vulnerability scanning process
-   Learn about the different types of vulnerability scans
-   Understand the considerations of a vulnerability scan

In this Learning Unit, we'll discuss the theory behind vulnerability scanning. Before inspecting our tools, we need to outline the basic workflow of a vulnerability scanner and understand how it finds vulnerabilities. We will also review the different types and considerations of a vulnerability scan.

## 7.1.1. How Vulnerability Scanners Work

Every vulnerability scanner has its own customized workflow but the basic process behind vulnerability scanning is implementation independent. The basic process of an automated vulnerability scanner can be described as:

1.  Host discovery
2.  Port scanning
3.  Operating system, service, and version detection
4.  Matching the results to a vulnerability database

[_Host Discovery_](https://capec.mitre.org/data/definitions/292.html) tells the scanner if the target is up and responding. The scanner then uses various techniques to identify all open ports on the system and detect all remotely accessible services with corresponding versions. In addition, operating system detection will be done in this step.

Based on all gathered information, the vulnerability scanner will then query a vulnerability database to match the found data to vulnerabilities. Examples of vulnerability databases are the [_National Vulnerability Database_](https://nvd.nist.gov) and the [_Common Vulnerabilities and Exposures_](https://cve.mitre.org/cve/search_cve_list.html) (CVE) program.

Most commercial vulnerability scanners also have the functionality to verify found vulnerabilities by attempting to partially or fully exploit them. This can significantly reduce missed vulnerabilities but can impact the stability of the service or system.

Vulnerabilities are identified by the [CVE system](https://cve.mitre.org). While this allows us to identify and find verified vulnerabilities, the CVE identifier provides no information about the severity of a vulnerability.

The [_Common Vulnerability Scoring System_](https://nvd.nist.gov/vuln-metrics/cvss) (CVSS) is a framework for addressing the characteristics and severity of vulnerabilities. Each CVE has a CVSS score assigned. The two major versions are [CVSS v2](https://www.first.org/cvss/v2/guide) and [CVSS v3](https://www.first.org/cvss/user-guide). Both versions use a range from 0 to 10 to rate vulnerabilities with different severity labels. The following figure from the [_National Institute of Standards and Technology_](https://www.nist.gov/) (NIST) lists the range of the base score and associated severity for CVSS v2.0 and CVSS v3.0.

![Figure 1: CVSS Ratings](https://static.offsec.com/offsec-courses/PEN-200/imgs/vulnscan/fb1c4b88cfa79e2b55f21ff88ad29222-vulnscan_cvssv1.png)

Figure 1: CVSS Ratings

To obtain a CVSS score, we can review the CVE in a vulnerability database, or if there is no CVE assigned, we can use a [_CVSS calculator_](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator). In 2019, CVSS v3.1 was released, which clarified and improved the existing version.

We need to be aware that the results of a vulnerability scan can be incomplete or contain wrongfully detected vulnerabilities.

A [_false positive_](https://www.cgisecurity.com/questions/falsepositive.shtml) occurs when a vulnerability is detected but the target is not vulnerable. This can happen through a wrong service and version detection or a configuration that makes the target unexploitable. False positives can also occur when patches or updates are [_backported_](https://access.redhat.com/security/updates/backporting), meaning that security fixes are applied to an older version of software.

[_False negative_](https://www.cgisecurity.com/questions/falsenegative.shtml) is another important term. It occurs when a vulnerability is missed by the vulnerability scanner.

In a penetration test, we often need to find the right balance between manual and automated vulnerability scanning. Let's explore both options briefly.

A manual vulnerability scan will inevitably be very resource-intensive and time-consuming. When there is a huge amount of data to analyze, we often reach our cognitive limit quickly and overlook vital details. On the other hand, manual vulnerability scanning allows for the discovery of complex and logical vulnerabilities that are rather difficult to discover using any type of automated scanner.

Automated vulnerability scans are invaluable when working on engagements for a multitude of reasons. First, in nearly all types of assessments, we have time constraints. Therefore, when we have a big enterprise network to scan, we cannot manually review every system. This is especially true when thinking about new or complex vulnerabilities. Second, by using automated scanners, we can quickly identify easily detected vulnerabilities and other low-hanging fruit.

We should take the time to explore the inner workings of every automated tool we plan to use in a security assessment. This will not only assist us in configuring the tool and digesting the results properly but doing that will help us understand the limitations that must be overcome with manually applied expertise.

#### Labs

1.  Is this a false positive or a false negative? A vulnerability scanner identifies a vulnerability for a Linux web server. The target runs on Windows and the vulnerability is only exploitable on Linux.

Answer

# 7\. Vulnerability Scanning

In this Learning Module, we will cover the following Learning Units:

-   Vulnerability Scanning Theory
-   Vulnerability Scanning with Nessus
-   Vulnerability Scanning with Nmap

The discovery of vulnerabilities is an integral part of any security assessment. The process of identifying the attack surface of a piece of software, system, or network is called [_Vulnerability Scanning_](https://en.wikipedia.org/wiki/Vulnerability_scanner).

Vulnerability scanners come in many different forms, from individual scripts that identify a single vulnerability to complex commercial solutions that scan a broad variety of vulnerabilities. Automated vulnerability scanners can be invaluable for penetration testers as they help quickly establish a baseline on the target network before performing a more thorough manual testing analysis to get adequate coverage. Common types of vulnerability scanners are web application and network vulnerability scanners.

In this Module, we will analyze automated network vulnerability scanning. We'll begin with the theory behind vulnerability scanning and then use [_Nessus_](https://www.tenable.com/products/nessus) and [_Nmap_](https://nmap.org) to perform different kinds of vulnerability scans.

## 7.1. Vulnerability Scanning Theory

This Learning Unit covers the following Learning Objectives:

-   Gain a basic understanding of the vulnerability scanning process
-   Learn about the different types of vulnerability scans
-   Understand the considerations of a vulnerability scan

In this Learning Unit, we'll discuss the theory behind vulnerability scanning. Before inspecting our tools, we need to outline the basic workflow of a vulnerability scanner and understand how it finds vulnerabilities. We will also review the different types and considerations of a vulnerability scan.

## 7.1.1. How Vulnerability Scanners Work

Every vulnerability scanner has its own customized workflow but the basic process behind vulnerability scanning is implementation independent. The basic process of an automated vulnerability scanner can be described as:

1.  Host discovery
2.  Port scanning
3.  Operating system, service, and version detection
4.  Matching the results to a vulnerability database

[_Host Discovery_](https://capec.mitre.org/data/definitions/292.html) tells the scanner if the target is up and responding. The scanner then uses various techniques to identify all open ports on the system and detect all remotely accessible services with corresponding versions. In addition, operating system detection will be done in this step.

Based on all gathered information, the vulnerability scanner will then query a vulnerability database to match the found data to vulnerabilities. Examples of vulnerability databases are the [_National Vulnerability Database_](https://nvd.nist.gov) and the [_Common Vulnerabilities and Exposures_](https://cve.mitre.org/cve/search_cve_list.html) (CVE) program.

Most commercial vulnerability scanners also have the functionality to verify found vulnerabilities by attempting to partially or fully exploit them. This can significantly reduce missed vulnerabilities but can impact the stability of the service or system.

Vulnerabilities are identified by the [CVE system](https://cve.mitre.org). While this allows us to identify and find verified vulnerabilities, the CVE identifier provides no information about the severity of a vulnerability.

The [_Common Vulnerability Scoring System_](https://nvd.nist.gov/vuln-metrics/cvss) (CVSS) is a framework for addressing the characteristics and severity of vulnerabilities. Each CVE has a CVSS score assigned. The two major versions are [CVSS v2](https://www.first.org/cvss/v2/guide) and [CVSS v3](https://www.first.org/cvss/user-guide). Both versions use a range from 0 to 10 to rate vulnerabilities with different severity labels. The following figure from the [_National Institute of Standards and Technology_](https://www.nist.gov/) (NIST) lists the range of the base score and associated severity for CVSS v2.0 and CVSS v3.0.

![Figure 1: CVSS Ratings](https://static.offsec.com/offsec-courses/PEN-200/imgs/vulnscan/fb1c4b88cfa79e2b55f21ff88ad29222-vulnscan_cvssv1.png)

Figure 1: CVSS Ratings

To obtain a CVSS score, we can review the CVE in a vulnerability database, or if there is no CVE assigned, we can use a [_CVSS calculator_](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator). In 2019, CVSS v3.1 was released, which clarified and improved the existing version.

We need to be aware that the results of a vulnerability scan can be incomplete or contain wrongfully detected vulnerabilities.

A [_false positive_](https://www.cgisecurity.com/questions/falsepositive.shtml) occurs when a vulnerability is detected but the target is not vulnerable. This can happen through a wrong service and version detection or a configuration that makes the target unexploitable. False positives can also occur when patches or updates are [_backported_](https://access.redhat.com/security/updates/backporting), meaning that security fixes are applied to an older version of software.

[_False negative_](https://www.cgisecurity.com/questions/falsenegative.shtml) is another important term. It occurs when a vulnerability is missed by the vulnerability scanner.

In a penetration test, we often need to find the right balance between manual and automated vulnerability scanning. Let's explore both options briefly.

A manual vulnerability scan will inevitably be very resource-intensive and time-consuming. When there is a huge amount of data to analyze, we often reach our cognitive limit quickly and overlook vital details. On the other hand, manual vulnerability scanning allows for the discovery of complex and logical vulnerabilities that are rather difficult to discover using any type of automated scanner.

Automated vulnerability scans are invaluable when working on engagements for a multitude of reasons. First, in nearly all types of assessments, we have time constraints. Therefore, when we have a big enterprise network to scan, we cannot manually review every system. This is especially true when thinking about new or complex vulnerabilities. Second, by using automated scanners, we can quickly identify easily detected vulnerabilities and other low-hanging fruit.

We should take the time to explore the inner workings of every automated tool we plan to use in a security assessment. This will not only assist us in configuring the tool and digesting the results properly but doing that will help us understand the limitations that must be overcome with manually applied expertise.

#### Labs

1.  Is this a false positive or a false negative? A vulnerability scanner identifies a vulnerability for a Linux web server. The target runs on Windows and the vulnerability is only exploitable on Linux.

Answer

# 7\. Vulnerability Scanning

In this Learning Module, we will cover the following Learning Units:

-   Vulnerability Scanning Theory
-   Vulnerability Scanning with Nessus
-   Vulnerability Scanning with Nmap

The discovery of vulnerabilities is an integral part of any security assessment. The process of identifying the attack surface of a piece of software, system, or network is called [_Vulnerability Scanning_](https://en.wikipedia.org/wiki/Vulnerability_scanner).

Vulnerability scanners come in many different forms, from individual scripts that identify a single vulnerability to complex commercial solutions that scan a broad variety of vulnerabilities. Automated vulnerability scanners can be invaluable for penetration testers as they help quickly establish a baseline on the target network before performing a more thorough manual testing analysis to get adequate coverage. Common types of vulnerability scanners are web application and network vulnerability scanners.

In this Module, we will analyze automated network vulnerability scanning. We'll begin with the theory behind vulnerability scanning and then use [_Nessus_](https://www.tenable.com/products/nessus) and [_Nmap_](https://nmap.org) to perform different kinds of vulnerability scans.

## 7.1. Vulnerability Scanning Theory

This Learning Unit covers the following Learning Objectives:

-   Gain a basic understanding of the vulnerability scanning process
-   Learn about the different types of vulnerability scans
-   Understand the considerations of a vulnerability scan

In this Learning Unit, we'll discuss the theory behind vulnerability scanning. Before inspecting our tools, we need to outline the basic workflow of a vulnerability scanner and understand how it finds vulnerabilities. We will also review the different types and considerations of a vulnerability scan.

## 7.1.1. How Vulnerability Scanners Work

Every vulnerability scanner has its own customized workflow but the basic process behind vulnerability scanning is implementation independent. The basic process of an automated vulnerability scanner can be described as:

1.  Host discovery
2.  Port scanning
3.  Operating system, service, and version detection
4.  Matching the results to a vulnerability database

[_Host Discovery_](https://capec.mitre.org/data/definitions/292.html) tells the scanner if the target is up and responding. The scanner then uses various techniques to identify all open ports on the system and detect all remotely accessible services with corresponding versions. In addition, operating system detection will be done in this step.

Based on all gathered information, the vulnerability scanner will then query a vulnerability database to match the found data to vulnerabilities. Examples of vulnerability databases are the [_National Vulnerability Database_](https://nvd.nist.gov) and the [_Common Vulnerabilities and Exposures_](https://cve.mitre.org/cve/search_cve_list.html) (CVE) program.

Most commercial vulnerability scanners also have the functionality to verify found vulnerabilities by attempting to partially or fully exploit them. This can significantly reduce missed vulnerabilities but can impact the stability of the service or system.

Vulnerabilities are identified by the [CVE system](https://cve.mitre.org). While this allows us to identify and find verified vulnerabilities, the CVE identifier provides no information about the severity of a vulnerability.

The [_Common Vulnerability Scoring System_](https://nvd.nist.gov/vuln-metrics/cvss) (CVSS) is a framework for addressing the characteristics and severity of vulnerabilities. Each CVE has a CVSS score assigned. The two major versions are [CVSS v2](https://www.first.org/cvss/v2/guide) and [CVSS v3](https://www.first.org/cvss/user-guide). Both versions use a range from 0 to 10 to rate vulnerabilities with different severity labels. The following figure from the [_National Institute of Standards and Technology_](https://www.nist.gov/) (NIST) lists the range of the base score and associated severity for CVSS v2.0 and CVSS v3.0.

![Figure 1: CVSS Ratings](https://static.offsec.com/offsec-courses/PEN-200/imgs/vulnscan/fb1c4b88cfa79e2b55f21ff88ad29222-vulnscan_cvssv1.png)

Figure 1: CVSS Ratings

To obtain a CVSS score, we can review the CVE in a vulnerability database, or if there is no CVE assigned, we can use a [_CVSS calculator_](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator). In 2019, CVSS v3.1 was released, which clarified and improved the existing version.

We need to be aware that the results of a vulnerability scan can be incomplete or contain wrongfully detected vulnerabilities.

A [_false positive_](https://www.cgisecurity.com/questions/falsepositive.shtml) occurs when a vulnerability is detected but the target is not vulnerable. This can happen through a wrong service and version detection or a configuration that makes the target unexploitable. False positives can also occur when patches or updates are [_backported_](https://access.redhat.com/security/updates/backporting), meaning that security fixes are applied to an older version of software.

[_False negative_](https://www.cgisecurity.com/questions/falsenegative.shtml) is another important term. It occurs when a vulnerability is missed by the vulnerability scanner.

In a penetration test, we often need to find the right balance between manual and automated vulnerability scanning. Let's explore both options briefly.

A manual vulnerability scan will inevitably be very resource-intensive and time-consuming. When there is a huge amount of data to analyze, we often reach our cognitive limit quickly and overlook vital details. On the other hand, manual vulnerability scanning allows for the discovery of complex and logical vulnerabilities that are rather difficult to discover using any type of automated scanner.

Automated vulnerability scans are invaluable when working on engagements for a multitude of reasons. First, in nearly all types of assessments, we have time constraints. Therefore, when we have a big enterprise network to scan, we cannot manually review every system. This is especially true when thinking about new or complex vulnerabilities. Second, by using automated scanners, we can quickly identify easily detected vulnerabilities and other low-hanging fruit.

We should take the time to explore the inner workings of every automated tool we plan to use in a security assessment. This will not only assist us in configuring the tool and digesting the results properly but doing that will help us understand the limitations that must be overcome with manually applied expertise.

#### Labs

1.  Is this a false positive or a false negative? A vulnerability scanner identifies a vulnerability for a Linux web server. The target runs on Windows and the vulnerability is only exploitable on Linux.

Answer

# 7\. Vulnerability Scanning

In this Learning Module, we will cover the following Learning Units:

-   Vulnerability Scanning Theory
-   Vulnerability Scanning with Nessus
-   Vulnerability Scanning with Nmap

The discovery of vulnerabilities is an integral part of any security assessment. The process of identifying the attack surface of a piece of software, system, or network is called [_Vulnerability Scanning_](https://en.wikipedia.org/wiki/Vulnerability_scanner).

Vulnerability scanners come in many different forms, from individual scripts that identify a single vulnerability to complex commercial solutions that scan a broad variety of vulnerabilities. Automated vulnerability scanners can be invaluable for penetration testers as they help quickly establish a baseline on the target network before performing a more thorough manual testing analysis to get adequate coverage. Common types of vulnerability scanners are web application and network vulnerability scanners.

In this Module, we will analyze automated network vulnerability scanning. We'll begin with the theory behind vulnerability scanning and then use [_Nessus_](https://www.tenable.com/products/nessus) and [_Nmap_](https://nmap.org) to perform different kinds of vulnerability scans.

## 7.1. Vulnerability Scanning Theory

This Learning Unit covers the following Learning Objectives:

-   Gain a basic understanding of the vulnerability scanning process
-   Learn about the different types of vulnerability scans
-   Understand the considerations of a vulnerability scan

In this Learning Unit, we'll discuss the theory behind vulnerability scanning. Before inspecting our tools, we need to outline the basic workflow of a vulnerability scanner and understand how it finds vulnerabilities. We will also review the different types and considerations of a vulnerability scan.

## 7.1.1. How Vulnerability Scanners Work

Every vulnerability scanner has its own customized workflow but the basic process behind vulnerability scanning is implementation independent. The basic process of an automated vulnerability scanner can be described as:

1.  Host discovery
2.  Port scanning
3.  Operating system, service, and version detection
4.  Matching the results to a vulnerability database

[_Host Discovery_](https://capec.mitre.org/data/definitions/292.html) tells the scanner if the target is up and responding. The scanner then uses various techniques to identify all open ports on the system and detect all remotely accessible services with corresponding versions. In addition, operating system detection will be done in this step.

Based on all gathered information, the vulnerability scanner will then query a vulnerability database to match the found data to vulnerabilities. Examples of vulnerability databases are the [_National Vulnerability Database_](https://nvd.nist.gov) and the [_Common Vulnerabilities and Exposures_](https://cve.mitre.org/cve/search_cve_list.html) (CVE) program.

Most commercial vulnerability scanners also have the functionality to verify found vulnerabilities by attempting to partially or fully exploit them. This can significantly reduce missed vulnerabilities but can impact the stability of the service or system.

Vulnerabilities are identified by the [CVE system](https://cve.mitre.org). While this allows us to identify and find verified vulnerabilities, the CVE identifier provides no information about the severity of a vulnerability.

The [_Common Vulnerability Scoring System_](https://nvd.nist.gov/vuln-metrics/cvss) (CVSS) is a framework for addressing the characteristics and severity of vulnerabilities. Each CVE has a CVSS score assigned. The two major versions are [CVSS v2](https://www.first.org/cvss/v2/guide) and [CVSS v3](https://www.first.org/cvss/user-guide). Both versions use a range from 0 to 10 to rate vulnerabilities with different severity labels. The following figure from the [_National Institute of Standards and Technology_](https://www.nist.gov/) (NIST) lists the range of the base score and associated severity for CVSS v2.0 and CVSS v3.0.

![Figure 1: CVSS Ratings](https://static.offsec.com/offsec-courses/PEN-200/imgs/vulnscan/fb1c4b88cfa79e2b55f21ff88ad29222-vulnscan_cvssv1.png)

Figure 1: CVSS Ratings

To obtain a CVSS score, we can review the CVE in a vulnerability database, or if there is no CVE assigned, we can use a [_CVSS calculator_](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator). In 2019, CVSS v3.1 was released, which clarified and improved the existing version.

We need to be aware that the results of a vulnerability scan can be incomplete or contain wrongfully detected vulnerabilities.

A [_false positive_](https://www.cgisecurity.com/questions/falsepositive.shtml) occurs when a vulnerability is detected but the target is not vulnerable. This can happen through a wrong service and version detection or a configuration that makes the target unexploitable. False positives can also occur when patches or updates are [_backported_](https://access.redhat.com/security/updates/backporting), meaning that security fixes are applied to an older version of software.

[_False negative_](https://www.cgisecurity.com/questions/falsenegative.shtml) is another important term. It occurs when a vulnerability is missed by the vulnerability scanner.

In a penetration test, we often need to find the right balance between manual and automated vulnerability scanning. Let's explore both options briefly.

A manual vulnerability scan will inevitably be very resource-intensive and time-consuming. When there is a huge amount of data to analyze, we often reach our cognitive limit quickly and overlook vital details. On the other hand, manual vulnerability scanning allows for the discovery of complex and logical vulnerabilities that are rather difficult to discover using any type of automated scanner.

Automated vulnerability scans are invaluable when working on engagements for a multitude of reasons. First, in nearly all types of assessments, we have time constraints. Therefore, when we have a big enterprise network to scan, we cannot manually review every system. This is especially true when thinking about new or complex vulnerabilities. Second, by using automated scanners, we can quickly identify easily detected vulnerabilities and other low-hanging fruit.

We should take the time to explore the inner workings of every automated tool we plan to use in a security assessment. This will not only assist us in configuring the tool and digesting the results properly but doing that will help us understand the limitations that must be overcome with manually applied expertise.

#### Labs

1.  Is this a false positive or a false negative? A vulnerability scanner identifies a vulnerability for a Linux web server. The target runs on Windows and the vulnerability is only exploitable on Linux.

Answer

# 7\. Vulnerability Scanning

In this Learning Module, we will cover the following Learning Units:

-   Vulnerability Scanning Theory
-   Vulnerability Scanning with Nessus
-   Vulnerability Scanning with Nmap

The discovery of vulnerabilities is an integral part of any security assessment. The process of identifying the attack surface of a piece of software, system, or network is called [_Vulnerability Scanning_](https://en.wikipedia.org/wiki/Vulnerability_scanner).

Vulnerability scanners come in many different forms, from individual scripts that identify a single vulnerability to complex commercial solutions that scan a broad variety of vulnerabilities. Automated vulnerability scanners can be invaluable for penetration testers as they help quickly establish a baseline on the target network before performing a more thorough manual testing analysis to get adequate coverage. Common types of vulnerability scanners are web application and network vulnerability scanners.

In this Module, we will analyze automated network vulnerability scanning. We'll begin with the theory behind vulnerability scanning and then use [_Nessus_](https://www.tenable.com/products/nessus) and [_Nmap_](https://nmap.org) to perform different kinds of vulnerability scans.

## 7.1. Vulnerability Scanning Theory

This Learning Unit covers the following Learning Objectives:

-   Gain a basic understanding of the vulnerability scanning process
-   Learn about the different types of vulnerability scans
-   Understand the considerations of a vulnerability scan

In this Learning Unit, we'll discuss the theory behind vulnerability scanning. Before inspecting our tools, we need to outline the basic workflow of a vulnerability scanner and understand how it finds vulnerabilities. We will also review the different types and considerations of a vulnerability scan.

## 7.1.1. How Vulnerability Scanners Work

Every vulnerability scanner has its own customized workflow but the basic process behind vulnerability scanning is implementation independent. The basic process of an automated vulnerability scanner can be described as:

1.  Host discovery
2.  Port scanning
3.  Operating system, service, and version detection
4.  Matching the results to a vulnerability database

[_Host Discovery_](https://capec.mitre.org/data/definitions/292.html) tells the scanner if the target is up and responding. The scanner then uses various techniques to identify all open ports on the system and detect all remotely accessible services with corresponding versions. In addition, operating system detection will be done in this step.

Based on all gathered information, the vulnerability scanner will then query a vulnerability database to match the found data to vulnerabilities. Examples of vulnerability databases are the [_National Vulnerability Database_](https://nvd.nist.gov) and the [_Common Vulnerabilities and Exposures_](https://cve.mitre.org/cve/search_cve_list.html) (CVE) program.

Most commercial vulnerability scanners also have the functionality to verify found vulnerabilities by attempting to partially or fully exploit them. This can significantly reduce missed vulnerabilities but can impact the stability of the service or system.

Vulnerabilities are identified by the [CVE system](https://cve.mitre.org). While this allows us to identify and find verified vulnerabilities, the CVE identifier provides no information about the severity of a vulnerability.

The [_Common Vulnerability Scoring System_](https://nvd.nist.gov/vuln-metrics/cvss) (CVSS) is a framework for addressing the characteristics and severity of vulnerabilities. Each CVE has a CVSS score assigned. The two major versions are [CVSS v2](https://www.first.org/cvss/v2/guide) and [CVSS v3](https://www.first.org/cvss/user-guide). Both versions use a range from 0 to 10 to rate vulnerabilities with different severity labels. The following figure from the [_National Institute of Standards and Technology_](https://www.nist.gov/) (NIST) lists the range of the base score and associated severity for CVSS v2.0 and CVSS v3.0.

![Figure 1: CVSS Ratings](https://static.offsec.com/offsec-courses/PEN-200/imgs/vulnscan/fb1c4b88cfa79e2b55f21ff88ad29222-vulnscan_cvssv1.png)

Figure 1: CVSS Ratings

To obtain a CVSS score, we can review the CVE in a vulnerability database, or if there is no CVE assigned, we can use a [_CVSS calculator_](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator). In 2019, CVSS v3.1 was released, which clarified and improved the existing version.

We need to be aware that the results of a vulnerability scan can be incomplete or contain wrongfully detected vulnerabilities.

A [_false positive_](https://www.cgisecurity.com/questions/falsepositive.shtml) occurs when a vulnerability is detected but the target is not vulnerable. This can happen through a wrong service and version detection or a configuration that makes the target unexploitable. False positives can also occur when patches or updates are [_backported_](https://access.redhat.com/security/updates/backporting), meaning that security fixes are applied to an older version of software.

[_False negative_](https://www.cgisecurity.com/questions/falsenegative.shtml) is another important term. It occurs when a vulnerability is missed by the vulnerability scanner.

In a penetration test, we often need to find the right balance between manual and automated vulnerability scanning. Let's explore both options briefly.

A manual vulnerability scan will inevitably be very resource-intensive and time-consuming. When there is a huge amount of data to analyze, we often reach our cognitive limit quickly and overlook vital details. On the other hand, manual vulnerability scanning allows for the discovery of complex and logical vulnerabilities that are rather difficult to discover using any type of automated scanner.

Automated vulnerability scans are invaluable when working on engagements for a multitude of reasons. First, in nearly all types of assessments, we have time constraints. Therefore, when we have a big enterprise network to scan, we cannot manually review every system. This is especially true when thinking about new or complex vulnerabilities. Second, by using automated scanners, we can quickly identify easily detected vulnerabilities and other low-hanging fruit.

We should take the time to explore the inner workings of every automated tool we plan to use in a security assessment. This will not only assist us in configuring the tool and digesting the results properly but doing that will help us understand the limitations that must be overcome with manually applied expertise.

#### Labs

1.  Is this a false positive or a false negative? A vulnerability scanner identifies a vulnerability for a Linux web server. The target runs on Windows and the vulnerability is only exploitable on Linux.

Answer

# 7\. Vulnerability Scanning

In this Learning Module, we will cover the following Learning Units:

-   Vulnerability Scanning Theory
-   Vulnerability Scanning with Nessus
-   Vulnerability Scanning with Nmap

The discovery of vulnerabilities is an integral part of any security assessment. The process of identifying the attack surface of a piece of software, system, or network is called [_Vulnerability Scanning_](https://en.wikipedia.org/wiki/Vulnerability_scanner).

Vulnerability scanners come in many different forms, from individual scripts that identify a single vulnerability to complex commercial solutions that scan a broad variety of vulnerabilities. Automated vulnerability scanners can be invaluable for penetration testers as they help quickly establish a baseline on the target network before performing a more thorough manual testing analysis to get adequate coverage. Common types of vulnerability scanners are web application and network vulnerability scanners.

In this Module, we will analyze automated network vulnerability scanning. We'll begin with the theory behind vulnerability scanning and then use [_Nessus_](https://www.tenable.com/products/nessus) and [_Nmap_](https://nmap.org) to perform different kinds of vulnerability scans.

## 7.1. Vulnerability Scanning Theory

This Learning Unit covers the following Learning Objectives:

-   Gain a basic understanding of the vulnerability scanning process
-   Learn about the different types of vulnerability scans
-   Understand the considerations of a vulnerability scan

In this Learning Unit, we'll discuss the theory behind vulnerability scanning. Before inspecting our tools, we need to outline the basic workflow of a vulnerability scanner and understand how it finds vulnerabilities. We will also review the different types and considerations of a vulnerability scan.

## 7.1.1. How Vulnerability Scanners Work

Every vulnerability scanner has its own customized workflow but the basic process behind vulnerability scanning is implementation independent. The basic process of an automated vulnerability scanner can be described as:

1.  Host discovery
2.  Port scanning
3.  Operating system, service, and version detection
4.  Matching the results to a vulnerability database

[_Host Discovery_](https://capec.mitre.org/data/definitions/292.html) tells the scanner if the target is up and responding. The scanner then uses various techniques to identify all open ports on the system and detect all remotely accessible services with corresponding versions. In addition, operating system detection will be done in this step.

Based on all gathered information, the vulnerability scanner will then query a vulnerability database to match the found data to vulnerabilities. Examples of vulnerability databases are the [_National Vulnerability Database_](https://nvd.nist.gov) and the [_Common Vulnerabilities and Exposures_](https://cve.mitre.org/cve/search_cve_list.html) (CVE) program.

Most commercial vulnerability scanners also have the functionality to verify found vulnerabilities by attempting to partially or fully exploit them. This can significantly reduce missed vulnerabilities but can impact the stability of the service or system.

Vulnerabilities are identified by the [CVE system](https://cve.mitre.org). While this allows us to identify and find verified vulnerabilities, the CVE identifier provides no information about the severity of a vulnerability.

The [_Common Vulnerability Scoring System_](https://nvd.nist.gov/vuln-metrics/cvss) (CVSS) is a framework for addressing the characteristics and severity of vulnerabilities. Each CVE has a CVSS score assigned. The two major versions are [CVSS v2](https://www.first.org/cvss/v2/guide) and [CVSS v3](https://www.first.org/cvss/user-guide). Both versions use a range from 0 to 10 to rate vulnerabilities with different severity labels. The following figure from the [_National Institute of Standards and Technology_](https://www.nist.gov/) (NIST) lists the range of the base score and associated severity for CVSS v2.0 and CVSS v3.0.

![Figure 1: CVSS Ratings](https://static.offsec.com/offsec-courses/PEN-200/imgs/vulnscan/fb1c4b88cfa79e2b55f21ff88ad29222-vulnscan_cvssv1.png)

Figure 1: CVSS Ratings

To obtain a CVSS score, we can review the CVE in a vulnerability database, or if there is no CVE assigned, we can use a [_CVSS calculator_](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator). In 2019, CVSS v3.1 was released, which clarified and improved the existing version.

We need to be aware that the results of a vulnerability scan can be incomplete or contain wrongfully detected vulnerabilities.

A [_false positive_](https://www.cgisecurity.com/questions/falsepositive.shtml) occurs when a vulnerability is detected but the target is not vulnerable. This can happen through a wrong service and version detection or a configuration that makes the target unexploitable. False positives can also occur when patches or updates are [_backported_](https://access.redhat.com/security/updates/backporting), meaning that security fixes are applied to an older version of software.

[_False negative_](https://www.cgisecurity.com/questions/falsenegative.shtml) is another important term. It occurs when a vulnerability is missed by the vulnerability scanner.

In a penetration test, we often need to find the right balance between manual and automated vulnerability scanning. Let's explore both options briefly.

A manual vulnerability scan will inevitably be very resource-intensive and time-consuming. When there is a huge amount of data to analyze, we often reach our cognitive limit quickly and overlook vital details. On the other hand, manual vulnerability scanning allows for the discovery of complex and logical vulnerabilities that are rather difficult to discover using any type of automated scanner.

Automated vulnerability scans are invaluable when working on engagements for a multitude of reasons. First, in nearly all types of assessments, we have time constraints. Therefore, when we have a big enterprise network to scan, we cannot manually review every system. This is especially true when thinking about new or complex vulnerabilities. Second, by using automated scanners, we can quickly identify easily detected vulnerabilities and other low-hanging fruit.

We should take the time to explore the inner workings of every automated tool we plan to use in a security assessment. This will not only assist us in configuring the tool and digesting the results properly but doing that will help us understand the limitations that must be overcome with manually applied expertise.

#### Labs

1.  Is this a false positive or a false negative? A vulnerability scanner identifies a vulnerability for a Linux web server. The target runs on Windows and the vulnerability is only exploitable on Linux.

Answer

# 7\. Vulnerability Scanning

In this Learning Module, we will cover the following Learning Units:

-   Vulnerability Scanning Theory
-   Vulnerability Scanning with Nessus
-   Vulnerability Scanning with Nmap

The discovery of vulnerabilities is an integral part of any security assessment. The process of identifying the attack surface of a piece of software, system, or network is called [_Vulnerability Scanning_](https://en.wikipedia.org/wiki/Vulnerability_scanner).

Vulnerability scanners come in many different forms, from individual scripts that identify a single vulnerability to complex commercial solutions that scan a broad variety of vulnerabilities. Automated vulnerability scanners can be invaluable for penetration testers as they help quickly establish a baseline on the target network before performing a more thorough manual testing analysis to get adequate coverage. Common types of vulnerability scanners are web application and network vulnerability scanners.

In this Module, we will analyze automated network vulnerability scanning. We'll begin with the theory behind vulnerability scanning and then use [_Nessus_](https://www.tenable.com/products/nessus) and [_Nmap_](https://nmap.org) to perform different kinds of vulnerability scans.

## 7.1. Vulnerability Scanning Theory

This Learning Unit covers the following Learning Objectives:

-   Gain a basic understanding of the vulnerability scanning process
-   Learn about the different types of vulnerability scans
-   Understand the considerations of a vulnerability scan

In this Learning Unit, we'll discuss the theory behind vulnerability scanning. Before inspecting our tools, we need to outline the basic workflow of a vulnerability scanner and understand how it finds vulnerabilities. We will also review the different types and considerations of a vulnerability scan.

## 7.1.1. How Vulnerability Scanners Work

Every vulnerability scanner has its own customized workflow but the basic process behind vulnerability scanning is implementation independent. The basic process of an automated vulnerability scanner can be described as:

1.  Host discovery
2.  Port scanning
3.  Operating system, service, and version detection
4.  Matching the results to a vulnerability database

[_Host Discovery_](https://capec.mitre.org/data/definitions/292.html) tells the scanner if the target is up and responding. The scanner then uses various techniques to identify all open ports on the system and detect all remotely accessible services with corresponding versions. In addition, operating system detection will be done in this step.

Based on all gathered information, the vulnerability scanner will then query a vulnerability database to match the found data to vulnerabilities. Examples of vulnerability databases are the [_National Vulnerability Database_](https://nvd.nist.gov) and the [_Common Vulnerabilities and Exposures_](https://cve.mitre.org/cve/search_cve_list.html) (CVE) program.

Most commercial vulnerability scanners also have the functionality to verify found vulnerabilities by attempting to partially or fully exploit them. This can significantly reduce missed vulnerabilities but can impact the stability of the service or system.

Vulnerabilities are identified by the [CVE system](https://cve.mitre.org). While this allows us to identify and find verified vulnerabilities, the CVE identifier provides no information about the severity of a vulnerability.

The [_Common Vulnerability Scoring System_](https://nvd.nist.gov/vuln-metrics/cvss) (CVSS) is a framework for addressing the characteristics and severity of vulnerabilities. Each CVE has a CVSS score assigned. The two major versions are [CVSS v2](https://www.first.org/cvss/v2/guide) and [CVSS v3](https://www.first.org/cvss/user-guide). Both versions use a range from 0 to 10 to rate vulnerabilities with different severity labels. The following figure from the [_National Institute of Standards and Technology_](https://www.nist.gov/) (NIST) lists the range of the base score and associated severity for CVSS v2.0 and CVSS v3.0.

![Figure 1: CVSS Ratings](https://static.offsec.com/offsec-courses/PEN-200/imgs/vulnscan/fb1c4b88cfa79e2b55f21ff88ad29222-vulnscan_cvssv1.png)

Figure 1: CVSS Ratings

To obtain a CVSS score, we can review the CVE in a vulnerability database, or if there is no CVE assigned, we can use a [_CVSS calculator_](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator). In 2019, CVSS v3.1 was released, which clarified and improved the existing version.

We need to be aware that the results of a vulnerability scan can be incomplete or contain wrongfully detected vulnerabilities.

A [_false positive_](https://www.cgisecurity.com/questions/falsepositive.shtml) occurs when a vulnerability is detected but the target is not vulnerable. This can happen through a wrong service and version detection or a configuration that makes the target unexploitable. False positives can also occur when patches or updates are [_backported_](https://access.redhat.com/security/updates/backporting), meaning that security fixes are applied to an older version of software.

[_False negative_](https://www.cgisecurity.com/questions/falsenegative.shtml) is another important term. It occurs when a vulnerability is missed by the vulnerability scanner.

In a penetration test, we often need to find the right balance between manual and automated vulnerability scanning. Let's explore both options briefly.

A manual vulnerability scan will inevitably be very resource-intensive and time-consuming. When there is a huge amount of data to analyze, we often reach our cognitive limit quickly and overlook vital details. On the other hand, manual vulnerability scanning allows for the discovery of complex and logical vulnerabilities that are rather difficult to discover using any type of automated scanner.

Automated vulnerability scans are invaluable when working on engagements for a multitude of reasons. First, in nearly all types of assessments, we have time constraints. Therefore, when we have a big enterprise network to scan, we cannot manually review every system. This is especially true when thinking about new or complex vulnerabilities. Second, by using automated scanners, we can quickly identify easily detected vulnerabilities and other low-hanging fruit.

We should take the time to explore the inner workings of every automated tool we plan to use in a security assessment. This will not only assist us in configuring the tool and digesting the results properly but doing that will help us understand the limitations that must be overcome with manually applied expertise.

#### Labs

1.  Is this a false positive or a false negative? A vulnerability scanner identifies a vulnerability for a Linux web server. The target runs on Windows and the vulnerability is only exploitable on Linux.

Answer

# 7\. Vulnerability Scanning

In this Learning Module, we will cover the following Learning Units:

-   Vulnerability Scanning Theory
-   Vulnerability Scanning with Nessus
-   Vulnerability Scanning with Nmap

The discovery of vulnerabilities is an integral part of any security assessment. The process of identifying the attack surface of a piece of software, system, or network is called [_Vulnerability Scanning_](https://en.wikipedia.org/wiki/Vulnerability_scanner).

Vulnerability scanners come in many different forms, from individual scripts that identify a single vulnerability to complex commercial solutions that scan a broad variety of vulnerabilities. Automated vulnerability scanners can be invaluable for penetration testers as they help quickly establish a baseline on the target network before performing a more thorough manual testing analysis to get adequate coverage. Common types of vulnerability scanners are web application and network vulnerability scanners.

In this Module, we will analyze automated network vulnerability scanning. We'll begin with the theory behind vulnerability scanning and then use [_Nessus_](https://www.tenable.com/products/nessus) and [_Nmap_](https://nmap.org) to perform different kinds of vulnerability scans.

## 7.1. Vulnerability Scanning Theory

This Learning Unit covers the following Learning Objectives:

-   Gain a basic understanding of the vulnerability scanning process
-   Learn about the different types of vulnerability scans
-   Understand the considerations of a vulnerability scan

In this Learning Unit, we'll discuss the theory behind vulnerability scanning. Before inspecting our tools, we need to outline the basic workflow of a vulnerability scanner and understand how it finds vulnerabilities. We will also review the different types and considerations of a vulnerability scan.

## 7.1.1. How Vulnerability Scanners Work

Every vulnerability scanner has its own customized workflow but the basic process behind vulnerability scanning is implementation independent. The basic process of an automated vulnerability scanner can be described as:

1.  Host discovery
2.  Port scanning
3.  Operating system, service, and version detection
4.  Matching the results to a vulnerability database

[_Host Discovery_](https://capec.mitre.org/data/definitions/292.html) tells the scanner if the target is up and responding. The scanner then uses various techniques to identify all open ports on the system and detect all remotely accessible services with corresponding versions. In addition, operating system detection will be done in this step.

Based on all gathered information, the vulnerability scanner will then query a vulnerability database to match the found data to vulnerabilities. Examples of vulnerability databases are the [_National Vulnerability Database_](https://nvd.nist.gov) and the [_Common Vulnerabilities and Exposures_](https://cve.mitre.org/cve/search_cve_list.html) (CVE) program.

Most commercial vulnerability scanners also have the functionality to verify found vulnerabilities by attempting to partially or fully exploit them. This can significantly reduce missed vulnerabilities but can impact the stability of the service or system.

Vulnerabilities are identified by the [CVE system](https://cve.mitre.org). While this allows us to identify and find verified vulnerabilities, the CVE identifier provides no information about the severity of a vulnerability.

The [_Common Vulnerability Scoring System_](https://nvd.nist.gov/vuln-metrics/cvss) (CVSS) is a framework for addressing the characteristics and severity of vulnerabilities. Each CVE has a CVSS score assigned. The two major versions are [CVSS v2](https://www.first.org/cvss/v2/guide) and [CVSS v3](https://www.first.org/cvss/user-guide). Both versions use a range from 0 to 10 to rate vulnerabilities with different severity labels. The following figure from the [_National Institute of Standards and Technology_](https://www.nist.gov/) (NIST) lists the range of the base score and associated severity for CVSS v2.0 and CVSS v3.0.

![Figure 1: CVSS Ratings](https://static.offsec.com/offsec-courses/PEN-200/imgs/vulnscan/fb1c4b88cfa79e2b55f21ff88ad29222-vulnscan_cvssv1.png)

Figure 1: CVSS Ratings

To obtain a CVSS score, we can review the CVE in a vulnerability database, or if there is no CVE assigned, we can use a [_CVSS calculator_](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator). In 2019, CVSS v3.1 was released, which clarified and improved the existing version.

We need to be aware that the results of a vulnerability scan can be incomplete or contain wrongfully detected vulnerabilities.

A [_false positive_](https://www.cgisecurity.com/questions/falsepositive.shtml) occurs when a vulnerability is detected but the target is not vulnerable. This can happen through a wrong service and version detection or a configuration that makes the target unexploitable. False positives can also occur when patches or updates are [_backported_](https://access.redhat.com/security/updates/backporting), meaning that security fixes are applied to an older version of software.

[_False negative_](https://www.cgisecurity.com/questions/falsenegative.shtml) is another important term. It occurs when a vulnerability is missed by the vulnerability scanner.

In a penetration test, we often need to find the right balance between manual and automated vulnerability scanning. Let's explore both options briefly.

A manual vulnerability scan will inevitably be very resource-intensive and time-consuming. When there is a huge amount of data to analyze, we often reach our cognitive limit quickly and overlook vital details. On the other hand, manual vulnerability scanning allows for the discovery of complex and logical vulnerabilities that are rather difficult to discover using any type of automated scanner.

Automated vulnerability scans are invaluable when working on engagements for a multitude of reasons. First, in nearly all types of assessments, we have time constraints. Therefore, when we have a big enterprise network to scan, we cannot manually review every system. This is especially true when thinking about new or complex vulnerabilities. Second, by using automated scanners, we can quickly identify easily detected vulnerabilities and other low-hanging fruit.

We should take the time to explore the inner workings of every automated tool we plan to use in a security assessment. This will not only assist us in configuring the tool and digesting the results properly but doing that will help us understand the limitations that must be overcome with manually applied expertise.

#### Labs

1.  Is this a false positive or a false negative? A vulnerability scanner identifies a vulnerability for a Linux web server. The target runs on Windows and the vulnerability is only exploitable on Linux.

Answer

# 7\. Vulnerability Scanning

In this Learning Module, we will cover the following Learning Units:

-   Vulnerability Scanning Theory
-   Vulnerability Scanning with Nessus
-   Vulnerability Scanning with Nmap

The discovery of vulnerabilities is an integral part of any security assessment. The process of identifying the attack surface of a piece of software, system, or network is called [_Vulnerability Scanning_](https://en.wikipedia.org/wiki/Vulnerability_scanner).

Vulnerability scanners come in many different forms, from individual scripts that identify a single vulnerability to complex commercial solutions that scan a broad variety of vulnerabilities. Automated vulnerability scanners can be invaluable for penetration testers as they help quickly establish a baseline on the target network before performing a more thorough manual testing analysis to get adequate coverage. Common types of vulnerability scanners are web application and network vulnerability scanners.

In this Module, we will analyze automated network vulnerability scanning. We'll begin with the theory behind vulnerability scanning and then use [_Nessus_](https://www.tenable.com/products/nessus) and [_Nmap_](https://nmap.org) to perform different kinds of vulnerability scans.

## 7.1. Vulnerability Scanning Theory

This Learning Unit covers the following Learning Objectives:

-   Gain a basic understanding of the vulnerability scanning process
-   Learn about the different types of vulnerability scans
-   Understand the considerations of a vulnerability scan

In this Learning Unit, we'll discuss the theory behind vulnerability scanning. Before inspecting our tools, we need to outline the basic workflow of a vulnerability scanner and understand how it finds vulnerabilities. We will also review the different types and considerations of a vulnerability scan.

## 7.1.1. How Vulnerability Scanners Work

Every vulnerability scanner has its own customized workflow but the basic process behind vulnerability scanning is implementation independent. The basic process of an automated vulnerability scanner can be described as:

1.  Host discovery
2.  Port scanning
3.  Operating system, service, and version detection
4.  Matching the results to a vulnerability database

[_Host Discovery_](https://capec.mitre.org/data/definitions/292.html) tells the scanner if the target is up and responding. The scanner then uses various techniques to identify all open ports on the system and detect all remotely accessible services with corresponding versions. In addition, operating system detection will be done in this step.

Based on all gathered information, the vulnerability scanner will then query a vulnerability database to match the found data to vulnerabilities. Examples of vulnerability databases are the [_National Vulnerability Database_](https://nvd.nist.gov) and the [_Common Vulnerabilities and Exposures_](https://cve.mitre.org/cve/search_cve_list.html) (CVE) program.

Most commercial vulnerability scanners also have the functionality to verify found vulnerabilities by attempting to partially or fully exploit them. This can significantly reduce missed vulnerabilities but can impact the stability of the service or system.

Vulnerabilities are identified by the [CVE system](https://cve.mitre.org). While this allows us to identify and find verified vulnerabilities, the CVE identifier provides no information about the severity of a vulnerability.

The [_Common Vulnerability Scoring System_](https://nvd.nist.gov/vuln-metrics/cvss) (CVSS) is a framework for addressing the characteristics and severity of vulnerabilities. Each CVE has a CVSS score assigned. The two major versions are [CVSS v2](https://www.first.org/cvss/v2/guide) and [CVSS v3](https://www.first.org/cvss/user-guide). Both versions use a range from 0 to 10 to rate vulnerabilities with different severity labels. The following figure from the [_National Institute of Standards and Technology_](https://www.nist.gov/) (NIST) lists the range of the base score and associated severity for CVSS v2.0 and CVSS v3.0.

![Figure 1: CVSS Ratings](https://static.offsec.com/offsec-courses/PEN-200/imgs/vulnscan/fb1c4b88cfa79e2b55f21ff88ad29222-vulnscan_cvssv1.png)

Figure 1: CVSS Ratings

To obtain a CVSS score, we can review the CVE in a vulnerability database, or if there is no CVE assigned, we can use a [_CVSS calculator_](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator). In 2019, CVSS v3.1 was released, which clarified and improved the existing version.

We need to be aware that the results of a vulnerability scan can be incomplete or contain wrongfully detected vulnerabilities.

A [_false positive_](https://www.cgisecurity.com/questions/falsepositive.shtml) occurs when a vulnerability is detected but the target is not vulnerable. This can happen through a wrong service and version detection or a configuration that makes the target unexploitable. False positives can also occur when patches or updates are [_backported_](https://access.redhat.com/security/updates/backporting), meaning that security fixes are applied to an older version of software.

[_False negative_](https://www.cgisecurity.com/questions/falsenegative.shtml) is another important term. It occurs when a vulnerability is missed by the vulnerability scanner.

In a penetration test, we often need to find the right balance between manual and automated vulnerability scanning. Let's explore both options briefly.

A manual vulnerability scan will inevitably be very resource-intensive and time-consuming. When there is a huge amount of data to analyze, we often reach our cognitive limit quickly and overlook vital details. On the other hand, manual vulnerability scanning allows for the discovery of complex and logical vulnerabilities that are rather difficult to discover using any type of automated scanner.

Automated vulnerability scans are invaluable when working on engagements for a multitude of reasons. First, in nearly all types of assessments, we have time constraints. Therefore, when we have a big enterprise network to scan, we cannot manually review every system. This is especially true when thinking about new or complex vulnerabilities. Second, by using automated scanners, we can quickly identify easily detected vulnerabilities and other low-hanging fruit.

We should take the time to explore the inner workings of every automated tool we plan to use in a security assessment. This will not only assist us in configuring the tool and digesting the results properly but doing that will help us understand the limitations that must be overcome with manually applied expertise.

#### Labs

1.  Is this a false positive or a false negative? A vulnerability scanner identifies a vulnerability for a Linux web server. The target runs on Windows and the vulnerability is only exploitable on Linux.

Answer

# 7\. Vulnerability Scanning

In this Learning Module, we will cover the following Learning Units:

-   Vulnerability Scanning Theory
-   Vulnerability Scanning with Nessus
-   Vulnerability Scanning with Nmap

The discovery of vulnerabilities is an integral part of any security assessment. The process of identifying the attack surface of a piece of software, system, or network is called [_Vulnerability Scanning_](https://en.wikipedia.org/wiki/Vulnerability_scanner).

Vulnerability scanners come in many different forms, from individual scripts that identify a single vulnerability to complex commercial solutions that scan a broad variety of vulnerabilities. Automated vulnerability scanners can be invaluable for penetration testers as they help quickly establish a baseline on the target network before performing a more thorough manual testing analysis to get adequate coverage. Common types of vulnerability scanners are web application and network vulnerability scanners.

In this Module, we will analyze automated network vulnerability scanning. We'll begin with the theory behind vulnerability scanning and then use [_Nessus_](https://www.tenable.com/products/nessus) and [_Nmap_](https://nmap.org) to perform different kinds of vulnerability scans.

## 7.1. Vulnerability Scanning Theory

This Learning Unit covers the following Learning Objectives:

-   Gain a basic understanding of the vulnerability scanning process
-   Learn about the different types of vulnerability scans
-   Understand the considerations of a vulnerability scan

In this Learning Unit, we'll discuss the theory behind vulnerability scanning. Before inspecting our tools, we need to outline the basic workflow of a vulnerability scanner and understand how it finds vulnerabilities. We will also review the different types and considerations of a vulnerability scan.

## 7.1.1. How Vulnerability Scanners Work

Every vulnerability scanner has its own customized workflow but the basic process behind vulnerability scanning is implementation independent. The basic process of an automated vulnerability scanner can be described as:

1.  Host discovery
2.  Port scanning
3.  Operating system, service, and version detection
4.  Matching the results to a vulnerability database

[_Host Discovery_](https://capec.mitre.org/data/definitions/292.html) tells the scanner if the target is up and responding. The scanner then uses various techniques to identify all open ports on the system and detect all remotely accessible services with corresponding versions. In addition, operating system detection will be done in this step.

Based on all gathered information, the vulnerability scanner will then query a vulnerability database to match the found data to vulnerabilities. Examples of vulnerability databases are the [_National Vulnerability Database_](https://nvd.nist.gov) and the [_Common Vulnerabilities and Exposures_](https://cve.mitre.org/cve/search_cve_list.html) (CVE) program.

Most commercial vulnerability scanners also have the functionality to verify found vulnerabilities by attempting to partially or fully exploit them. This can significantly reduce missed vulnerabilities but can impact the stability of the service or system.

Vulnerabilities are identified by the [CVE system](https://cve.mitre.org). While this allows us to identify and find verified vulnerabilities, the CVE identifier provides no information about the severity of a vulnerability.

The [_Common Vulnerability Scoring System_](https://nvd.nist.gov/vuln-metrics/cvss) (CVSS) is a framework for addressing the characteristics and severity of vulnerabilities. Each CVE has a CVSS score assigned. The two major versions are [CVSS v2](https://www.first.org/cvss/v2/guide) and [CVSS v3](https://www.first.org/cvss/user-guide). Both versions use a range from 0 to 10 to rate vulnerabilities with different severity labels. The following figure from the [_National Institute of Standards and Technology_](https://www.nist.gov/) (NIST) lists the range of the base score and associated severity for CVSS v2.0 and CVSS v3.0.

![Figure 1: CVSS Ratings](https://static.offsec.com/offsec-courses/PEN-200/imgs/vulnscan/fb1c4b88cfa79e2b55f21ff88ad29222-vulnscan_cvssv1.png)

Figure 1: CVSS Ratings

To obtain a CVSS score, we can review the CVE in a vulnerability database, or if there is no CVE assigned, we can use a [_CVSS calculator_](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator). In 2019, CVSS v3.1 was released, which clarified and improved the existing version.

We need to be aware that the results of a vulnerability scan can be incomplete or contain wrongfully detected vulnerabilities.

A [_false positive_](https://www.cgisecurity.com/questions/falsepositive.shtml) occurs when a vulnerability is detected but the target is not vulnerable. This can happen through a wrong service and version detection or a configuration that makes the target unexploitable. False positives can also occur when patches or updates are [_backported_](https://access.redhat.com/security/updates/backporting), meaning that security fixes are applied to an older version of software.

[_False negative_](https://www.cgisecurity.com/questions/falsenegative.shtml) is another important term. It occurs when a vulnerability is missed by the vulnerability scanner.

In a penetration test, we often need to find the right balance between manual and automated vulnerability scanning. Let's explore both options briefly.

A manual vulnerability scan will inevitably be very resource-intensive and time-consuming. When there is a huge amount of data to analyze, we often reach our cognitive limit quickly and overlook vital details. On the other hand, manual vulnerability scanning allows for the discovery of complex and logical vulnerabilities that are rather difficult to discover using any type of automated scanner.

Automated vulnerability scans are invaluable when working on engagements for a multitude of reasons. First, in nearly all types of assessments, we have time constraints. Therefore, when we have a big enterprise network to scan, we cannot manually review every system. This is especially true when thinking about new or complex vulnerabilities. Second, by using automated scanners, we can quickly identify easily detected vulnerabilities and other low-hanging fruit.

We should take the time to explore the inner workings of every automated tool we plan to use in a security assessment. This will not only assist us in configuring the tool and digesting the results properly but doing that will help us understand the limitations that must be overcome with manually applied expertise.

#### Labs

1.  Is this a false positive or a false negative? A vulnerability scanner identifies a vulnerability for a Linux web server. The target runs on Windows and the vulnerability is only exploitable on Linux.

Answer

# 7\. Vulnerability Scanning

In this Learning Module, we will cover the following Learning Units:

-   Vulnerability Scanning Theory
-   Vulnerability Scanning with Nessus
-   Vulnerability Scanning with Nmap

The discovery of vulnerabilities is an integral part of any security assessment. The process of identifying the attack surface of a piece of software, system, or network is called [_Vulnerability Scanning_](https://en.wikipedia.org/wiki/Vulnerability_scanner).

Vulnerability scanners come in many different forms, from individual scripts that identify a single vulnerability to complex commercial solutions that scan a broad variety of vulnerabilities. Automated vulnerability scanners can be invaluable for penetration testers as they help quickly establish a baseline on the target network before performing a more thorough manual testing analysis to get adequate coverage. Common types of vulnerability scanners are web application and network vulnerability scanners.

In this Module, we will analyze automated network vulnerability scanning. We'll begin with the theory behind vulnerability scanning and then use [_Nessus_](https://www.tenable.com/products/nessus) and [_Nmap_](https://nmap.org) to perform different kinds of vulnerability scans.

## 7.1. Vulnerability Scanning Theory

This Learning Unit covers the following Learning Objectives:

-   Gain a basic understanding of the vulnerability scanning process
-   Learn about the different types of vulnerability scans
-   Understand the considerations of a vulnerability scan

In this Learning Unit, we'll discuss the theory behind vulnerability scanning. Before inspecting our tools, we need to outline the basic workflow of a vulnerability scanner and understand how it finds vulnerabilities. We will also review the different types and considerations of a vulnerability scan.

## 7.1.1. How Vulnerability Scanners Work

Every vulnerability scanner has its own customized workflow but the basic process behind vulnerability scanning is implementation independent. The basic process of an automated vulnerability scanner can be described as:

1.  Host discovery
2.  Port scanning
3.  Operating system, service, and version detection
4.  Matching the results to a vulnerability database

[_Host Discovery_](https://capec.mitre.org/data/definitions/292.html) tells the scanner if the target is up and responding. The scanner then uses various techniques to identify all open ports on the system and detect all remotely accessible services with corresponding versions. In addition, operating system detection will be done in this step.

Based on all gathered information, the vulnerability scanner will then query a vulnerability database to match the found data to vulnerabilities. Examples of vulnerability databases are the [_National Vulnerability Database_](https://nvd.nist.gov) and the [_Common Vulnerabilities and Exposures_](https://cve.mitre.org/cve/search_cve_list.html) (CVE) program.

Most commercial vulnerability scanners also have the functionality to verify found vulnerabilities by attempting to partially or fully exploit them. This can significantly reduce missed vulnerabilities but can impact the stability of the service or system.

Vulnerabilities are identified by the [CVE system](https://cve.mitre.org). While this allows us to identify and find verified vulnerabilities, the CVE identifier provides no information about the severity of a vulnerability.

The [_Common Vulnerability Scoring System_](https://nvd.nist.gov/vuln-metrics/cvss) (CVSS) is a framework for addressing the characteristics and severity of vulnerabilities. Each CVE has a CVSS score assigned. The two major versions are [CVSS v2](https://www.first.org/cvss/v2/guide) and [CVSS v3](https://www.first.org/cvss/user-guide). Both versions use a range from 0 to 10 to rate vulnerabilities with different severity labels. The following figure from the [_National Institute of Standards and Technology_](https://www.nist.gov/) (NIST) lists the range of the base score and associated severity for CVSS v2.0 and CVSS v3.0.

![Figure 1: CVSS Ratings](https://static.offsec.com/offsec-courses/PEN-200/imgs/vulnscan/fb1c4b88cfa79e2b55f21ff88ad29222-vulnscan_cvssv1.png)

Figure 1: CVSS Ratings

To obtain a CVSS score, we can review the CVE in a vulnerability database, or if there is no CVE assigned, we can use a [_CVSS calculator_](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator). In 2019, CVSS v3.1 was released, which clarified and improved the existing version.

We need to be aware that the results of a vulnerability scan can be incomplete or contain wrongfully detected vulnerabilities.

A [_false positive_](https://www.cgisecurity.com/questions/falsepositive.shtml) occurs when a vulnerability is detected but the target is not vulnerable. This can happen through a wrong service and version detection or a configuration that makes the target unexploitable. False positives can also occur when patches or updates are [_backported_](https://access.redhat.com/security/updates/backporting), meaning that security fixes are applied to an older version of software.

[_False negative_](https://www.cgisecurity.com/questions/falsenegative.shtml) is another important term. It occurs when a vulnerability is missed by the vulnerability scanner.

In a penetration test, we often need to find the right balance between manual and automated vulnerability scanning. Let's explore both options briefly.

A manual vulnerability scan will inevitably be very resource-intensive and time-consuming. When there is a huge amount of data to analyze, we often reach our cognitive limit quickly and overlook vital details. On the other hand, manual vulnerability scanning allows for the discovery of complex and logical vulnerabilities that are rather difficult to discover using any type of automated scanner.

Automated vulnerability scans are invaluable when working on engagements for a multitude of reasons. First, in nearly all types of assessments, we have time constraints. Therefore, when we have a big enterprise network to scan, we cannot manually review every system. This is especially true when thinking about new or complex vulnerabilities. Second, by using automated scanners, we can quickly identify easily detected vulnerabilities and other low-hanging fruit.

We should take the time to explore the inner workings of every automated tool we plan to use in a security assessment. This will not only assist us in configuring the tool and digesting the results properly but doing that will help us understand the limitations that must be overcome with manually applied expertise.

#### Labs

1.  Is this a false positive or a false negative? A vulnerability scanner identifies a vulnerability for a Linux web server. The target runs on Windows and the vulnerability is only exploitable on Linux.

Answer

# 7\. Vulnerability Scanning

In this Learning Module, we will cover the following Learning Units:

-   Vulnerability Scanning Theory
-   Vulnerability Scanning with Nessus
-   Vulnerability Scanning with Nmap

The discovery of vulnerabilities is an integral part of any security assessment. The process of identifying the attack surface of a piece of software, system, or network is called [_Vulnerability Scanning_](https://en.wikipedia.org/wiki/Vulnerability_scanner).

Vulnerability scanners come in many different forms, from individual scripts that identify a single vulnerability to complex commercial solutions that scan a broad variety of vulnerabilities. Automated vulnerability scanners can be invaluable for penetration testers as they help quickly establish a baseline on the target network before performing a more thorough manual testing analysis to get adequate coverage. Common types of vulnerability scanners are web application and network vulnerability scanners.

In this Module, we will analyze automated network vulnerability scanning. We'll begin with the theory behind vulnerability scanning and then use [_Nessus_](https://www.tenable.com/products/nessus) and [_Nmap_](https://nmap.org) to perform different kinds of vulnerability scans.

## 7.1. Vulnerability Scanning Theory

This Learning Unit covers the following Learning Objectives:

-   Gain a basic understanding of the vulnerability scanning process
-   Learn about the different types of vulnerability scans
-   Understand the considerations of a vulnerability scan

In this Learning Unit, we'll discuss the theory behind vulnerability scanning. Before inspecting our tools, we need to outline the basic workflow of a vulnerability scanner and understand how it finds vulnerabilities. We will also review the different types and considerations of a vulnerability scan.

## 7.1.1. How Vulnerability Scanners Work

Every vulnerability scanner has its own customized workflow but the basic process behind vulnerability scanning is implementation independent. The basic process of an automated vulnerability scanner can be described as:

1.  Host discovery
2.  Port scanning
3.  Operating system, service, and version detection
4.  Matching the results to a vulnerability database

[_Host Discovery_](https://capec.mitre.org/data/definitions/292.html) tells the scanner if the target is up and responding. The scanner then uses various techniques to identify all open ports on the system and detect all remotely accessible services with corresponding versions. In addition, operating system detection will be done in this step.

Based on all gathered information, the vulnerability scanner will then query a vulnerability database to match the found data to vulnerabilities. Examples of vulnerability databases are the [_National Vulnerability Database_](https://nvd.nist.gov) and the [_Common Vulnerabilities and Exposures_](https://cve.mitre.org/cve/search_cve_list.html) (CVE) program.

Most commercial vulnerability scanners also have the functionality to verify found vulnerabilities by attempting to partially or fully exploit them. This can significantly reduce missed vulnerabilities but can impact the stability of the service or system.

Vulnerabilities are identified by the [CVE system](https://cve.mitre.org). While this allows us to identify and find verified vulnerabilities, the CVE identifier provides no information about the severity of a vulnerability.

The [_Common Vulnerability Scoring System_](https://nvd.nist.gov/vuln-metrics/cvss) (CVSS) is a framework for addressing the characteristics and severity of vulnerabilities. Each CVE has a CVSS score assigned. The two major versions are [CVSS v2](https://www.first.org/cvss/v2/guide) and [CVSS v3](https://www.first.org/cvss/user-guide). Both versions use a range from 0 to 10 to rate vulnerabilities with different severity labels. The following figure from the [_National Institute of Standards and Technology_](https://www.nist.gov/) (NIST) lists the range of the base score and associated severity for CVSS v2.0 and CVSS v3.0.

![Figure 1: CVSS Ratings](https://static.offsec.com/offsec-courses/PEN-200/imgs/vulnscan/fb1c4b88cfa79e2b55f21ff88ad29222-vulnscan_cvssv1.png)

Figure 1: CVSS Ratings

To obtain a CVSS score, we can review the CVE in a vulnerability database, or if there is no CVE assigned, we can use a [_CVSS calculator_](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator). In 2019, CVSS v3.1 was released, which clarified and improved the existing version.

We need to be aware that the results of a vulnerability scan can be incomplete or contain wrongfully detected vulnerabilities.

A [_false positive_](https://www.cgisecurity.com/questions/falsepositive.shtml) occurs when a vulnerability is detected but the target is not vulnerable. This can happen through a wrong service and version detection or a configuration that makes the target unexploitable. False positives can also occur when patches or updates are [_backported_](https://access.redhat.com/security/updates/backporting), meaning that security fixes are applied to an older version of software.

[_False negative_](https://www.cgisecurity.com/questions/falsenegative.shtml) is another important term. It occurs when a vulnerability is missed by the vulnerability scanner.

In a penetration test, we often need to find the right balance between manual and automated vulnerability scanning. Let's explore both options briefly.

A manual vulnerability scan will inevitably be very resource-intensive and time-consuming. When there is a huge amount of data to analyze, we often reach our cognitive limit quickly and overlook vital details. On the other hand, manual vulnerability scanning allows for the discovery of complex and logical vulnerabilities that are rather difficult to discover using any type of automated scanner.

Automated vulnerability scans are invaluable when working on engagements for a multitude of reasons. First, in nearly all types of assessments, we have time constraints. Therefore, when we have a big enterprise network to scan, we cannot manually review every system. This is especially true when thinking about new or complex vulnerabilities. Second, by using automated scanners, we can quickly identify easily detected vulnerabilities and other low-hanging fruit.

We should take the time to explore the inner workings of every automated tool we plan to use in a security assessment. This will not only assist us in configuring the tool and digesting the results properly but doing that will help us understand the limitations that must be overcome with manually applied expertise.

#### Labs

1.  Is this a false positive or a false negative? A vulnerability scanner identifies a vulnerability for a Linux web server. The target runs on Windows and the vulnerability is only exploitable on Linux.

Answer

# 7\. Vulnerability Scanning

In this Learning Module, we will cover the following Learning Units:

-   Vulnerability Scanning Theory
-   Vulnerability Scanning with Nessus
-   Vulnerability Scanning with Nmap

The discovery of vulnerabilities is an integral part of any security assessment. The process of identifying the attack surface of a piece of software, system, or network is called [_Vulnerability Scanning_](https://en.wikipedia.org/wiki/Vulnerability_scanner).

Vulnerability scanners come in many different forms, from individual scripts that identify a single vulnerability to complex commercial solutions that scan a broad variety of vulnerabilities. Automated vulnerability scanners can be invaluable for penetration testers as they help quickly establish a baseline on the target network before performing a more thorough manual testing analysis to get adequate coverage. Common types of vulnerability scanners are web application and network vulnerability scanners.

In this Module, we will analyze automated network vulnerability scanning. We'll begin with the theory behind vulnerability scanning and then use [_Nessus_](https://www.tenable.com/products/nessus) and [_Nmap_](https://nmap.org) to perform different kinds of vulnerability scans.

## 7.1. Vulnerability Scanning Theory

This Learning Unit covers the following Learning Objectives:

-   Gain a basic understanding of the vulnerability scanning process
-   Learn about the different types of vulnerability scans
-   Understand the considerations of a vulnerability scan

In this Learning Unit, we'll discuss the theory behind vulnerability scanning. Before inspecting our tools, we need to outline the basic workflow of a vulnerability scanner and understand how it finds vulnerabilities. We will also review the different types and considerations of a vulnerability scan.

## 7.1.1. How Vulnerability Scanners Work

Every vulnerability scanner has its own customized workflow but the basic process behind vulnerability scanning is implementation independent. The basic process of an automated vulnerability scanner can be described as:

1.  Host discovery
2.  Port scanning
3.  Operating system, service, and version detection
4.  Matching the results to a vulnerability database

[_Host Discovery_](https://capec.mitre.org/data/definitions/292.html) tells the scanner if the target is up and responding. The scanner then uses various techniques to identify all open ports on the system and detect all remotely accessible services with corresponding versions. In addition, operating system detection will be done in this step.

Based on all gathered information, the vulnerability scanner will then query a vulnerability database to match the found data to vulnerabilities. Examples of vulnerability databases are the [_National Vulnerability Database_](https://nvd.nist.gov) and the [_Common Vulnerabilities and Exposures_](https://cve.mitre.org/cve/search_cve_list.html) (CVE) program.

Most commercial vulnerability scanners also have the functionality to verify found vulnerabilities by attempting to partially or fully exploit them. This can significantly reduce missed vulnerabilities but can impact the stability of the service or system.

Vulnerabilities are identified by the [CVE system](https://cve.mitre.org). While this allows us to identify and find verified vulnerabilities, the CVE identifier provides no information about the severity of a vulnerability.

The [_Common Vulnerability Scoring System_](https://nvd.nist.gov/vuln-metrics/cvss) (CVSS) is a framework for addressing the characteristics and severity of vulnerabilities. Each CVE has a CVSS score assigned. The two major versions are [CVSS v2](https://www.first.org/cvss/v2/guide) and [CVSS v3](https://www.first.org/cvss/user-guide). Both versions use a range from 0 to 10 to rate vulnerabilities with different severity labels. The following figure from the [_National Institute of Standards and Technology_](https://www.nist.gov/) (NIST) lists the range of the base score and associated severity for CVSS v2.0 and CVSS v3.0.

![Figure 1: CVSS Ratings](https://static.offsec.com/offsec-courses/PEN-200/imgs/vulnscan/fb1c4b88cfa79e2b55f21ff88ad29222-vulnscan_cvssv1.png)

Figure 1: CVSS Ratings

To obtain a CVSS score, we can review the CVE in a vulnerability database, or if there is no CVE assigned, we can use a [_CVSS calculator_](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator). In 2019, CVSS v3.1 was released, which clarified and improved the existing version.

We need to be aware that the results of a vulnerability scan can be incomplete or contain wrongfully detected vulnerabilities.

A [_false positive_](https://www.cgisecurity.com/questions/falsepositive.shtml) occurs when a vulnerability is detected but the target is not vulnerable. This can happen through a wrong service and version detection or a configuration that makes the target unexploitable. False positives can also occur when patches or updates are [_backported_](https://access.redhat.com/security/updates/backporting), meaning that security fixes are applied to an older version of software.

[_False negative_](https://www.cgisecurity.com/questions/falsenegative.shtml) is another important term. It occurs when a vulnerability is missed by the vulnerability scanner.

In a penetration test, we often need to find the right balance between manual and automated vulnerability scanning. Let's explore both options briefly.

A manual vulnerability scan will inevitably be very resource-intensive and time-consuming. When there is a huge amount of data to analyze, we often reach our cognitive limit quickly and overlook vital details. On the other hand, manual vulnerability scanning allows for the discovery of complex and logical vulnerabilities that are rather difficult to discover using any type of automated scanner.

Automated vulnerability scans are invaluable when working on engagements for a multitude of reasons. First, in nearly all types of assessments, we have time constraints. Therefore, when we have a big enterprise network to scan, we cannot manually review every system. This is especially true when thinking about new or complex vulnerabilities. Second, by using automated scanners, we can quickly identify easily detected vulnerabilities and other low-hanging fruit.

We should take the time to explore the inner workings of every automated tool we plan to use in a security assessment. This will not only assist us in configuring the tool and digesting the results properly but doing that will help us understand the limitations that must be overcome with manually applied expertise.

#### Labs

1.  Is this a false positive or a false negative? A vulnerability scanner identifies a vulnerability for a Linux web server. The target runs on Windows and the vulnerability is only exploitable on Linux.

Answer

# 7\. Vulnerability Scanning

In this Learning Module, we will cover the following Learning Units:

-   Vulnerability Scanning Theory
-   Vulnerability Scanning with Nessus
-   Vulnerability Scanning with Nmap

The discovery of vulnerabilities is an integral part of any security assessment. The process of identifying the attack surface of a piece of software, system, or network is called [_Vulnerability Scanning_](https://en.wikipedia.org/wiki/Vulnerability_scanner).

Vulnerability scanners come in many different forms, from individual scripts that identify a single vulnerability to complex commercial solutions that scan a broad variety of vulnerabilities. Automated vulnerability scanners can be invaluable for penetration testers as they help quickly establish a baseline on the target network before performing a more thorough manual testing analysis to get adequate coverage. Common types of vulnerability scanners are web application and network vulnerability scanners.

In this Module, we will analyze automated network vulnerability scanning. We'll begin with the theory behind vulnerability scanning and then use [_Nessus_](https://www.tenable.com/products/nessus) and [_Nmap_](https://nmap.org) to perform different kinds of vulnerability scans.

## 7.1. Vulnerability Scanning Theory

This Learning Unit covers the following Learning Objectives:

-   Gain a basic understanding of the vulnerability scanning process
-   Learn about the different types of vulnerability scans
-   Understand the considerations of a vulnerability scan

In this Learning Unit, we'll discuss the theory behind vulnerability scanning. Before inspecting our tools, we need to outline the basic workflow of a vulnerability scanner and understand how it finds vulnerabilities. We will also review the different types and considerations of a vulnerability scan.

## 7.1.1. How Vulnerability Scanners Work

Every vulnerability scanner has its own customized workflow but the basic process behind vulnerability scanning is implementation independent. The basic process of an automated vulnerability scanner can be described as:

1.  Host discovery
2.  Port scanning
3.  Operating system, service, and version detection
4.  Matching the results to a vulnerability database

[_Host Discovery_](https://capec.mitre.org/data/definitions/292.html) tells the scanner if the target is up and responding. The scanner then uses various techniques to identify all open ports on the system and detect all remotely accessible services with corresponding versions. In addition, operating system detection will be done in this step.

Based on all gathered information, the vulnerability scanner will then query a vulnerability database to match the found data to vulnerabilities. Examples of vulnerability databases are the [_National Vulnerability Database_](https://nvd.nist.gov) and the [_Common Vulnerabilities and Exposures_](https://cve.mitre.org/cve/search_cve_list.html) (CVE) program.

Most commercial vulnerability scanners also have the functionality to verify found vulnerabilities by attempting to partially or fully exploit them. This can significantly reduce missed vulnerabilities but can impact the stability of the service or system.

Vulnerabilities are identified by the [CVE system](https://cve.mitre.org). While this allows us to identify and find verified vulnerabilities, the CVE identifier provides no information about the severity of a vulnerability.

The [_Common Vulnerability Scoring System_](https://nvd.nist.gov/vuln-metrics/cvss) (CVSS) is a framework for addressing the characteristics and severity of vulnerabilities. Each CVE has a CVSS score assigned. The two major versions are [CVSS v2](https://www.first.org/cvss/v2/guide) and [CVSS v3](https://www.first.org/cvss/user-guide). Both versions use a range from 0 to 10 to rate vulnerabilities with different severity labels. The following figure from the [_National Institute of Standards and Technology_](https://www.nist.gov/) (NIST) lists the range of the base score and associated severity for CVSS v2.0 and CVSS v3.0.

![Figure 1: CVSS Ratings](https://static.offsec.com/offsec-courses/PEN-200/imgs/vulnscan/fb1c4b88cfa79e2b55f21ff88ad29222-vulnscan_cvssv1.png)

Figure 1: CVSS Ratings

To obtain a CVSS score, we can review the CVE in a vulnerability database, or if there is no CVE assigned, we can use a [_CVSS calculator_](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator). In 2019, CVSS v3.1 was released, which clarified and improved the existing version.

We need to be aware that the results of a vulnerability scan can be incomplete or contain wrongfully detected vulnerabilities.

A [_false positive_](https://www.cgisecurity.com/questions/falsepositive.shtml) occurs when a vulnerability is detected but the target is not vulnerable. This can happen through a wrong service and version detection or a configuration that makes the target unexploitable. False positives can also occur when patches or updates are [_backported_](https://access.redhat.com/security/updates/backporting), meaning that security fixes are applied to an older version of software.

[_False negative_](https://www.cgisecurity.com/questions/falsenegative.shtml) is another important term. It occurs when a vulnerability is missed by the vulnerability scanner.

In a penetration test, we often need to find the right balance between manual and automated vulnerability scanning. Let's explore both options briefly.

A manual vulnerability scan will inevitably be very resource-intensive and time-consuming. When there is a huge amount of data to analyze, we often reach our cognitive limit quickly and overlook vital details. On the other hand, manual vulnerability scanning allows for the discovery of complex and logical vulnerabilities that are rather difficult to discover using any type of automated scanner.

Automated vulnerability scans are invaluable when working on engagements for a multitude of reasons. First, in nearly all types of assessments, we have time constraints. Therefore, when we have a big enterprise network to scan, we cannot manually review every system. This is especially true when thinking about new or complex vulnerabilities. Second, by using automated scanners, we can quickly identify easily detected vulnerabilities and other low-hanging fruit.

We should take the time to explore the inner workings of every automated tool we plan to use in a security assessment. This will not only assist us in configuring the tool and digesting the results properly but doing that will help us understand the limitations that must be overcome with manually applied expertise.

#### Labs

1.  Is this a false positive or a false negative? A vulnerability scanner identifies a vulnerability for a Linux web server. The target runs on Windows and the vulnerability is only exploitable on Linux.

Answer

# 7\. Vulnerability Scanning

In this Learning Module, we will cover the following Learning Units:

-   Vulnerability Scanning Theory
-   Vulnerability Scanning with Nessus
-   Vulnerability Scanning with Nmap

The discovery of vulnerabilities is an integral part of any security assessment. The process of identifying the attack surface of a piece of software, system, or network is called [_Vulnerability Scanning_](https://en.wikipedia.org/wiki/Vulnerability_scanner).

Vulnerability scanners come in many different forms, from individual scripts that identify a single vulnerability to complex commercial solutions that scan a broad variety of vulnerabilities. Automated vulnerability scanners can be invaluable for penetration testers as they help quickly establish a baseline on the target network before performing a more thorough manual testing analysis to get adequate coverage. Common types of vulnerability scanners are web application and network vulnerability scanners.

In this Module, we will analyze automated network vulnerability scanning. We'll begin with the theory behind vulnerability scanning and then use [_Nessus_](https://www.tenable.com/products/nessus) and [_Nmap_](https://nmap.org) to perform different kinds of vulnerability scans.

## 7.1. Vulnerability Scanning Theory

This Learning Unit covers the following Learning Objectives:

-   Gain a basic understanding of the vulnerability scanning process
-   Learn about the different types of vulnerability scans
-   Understand the considerations of a vulnerability scan

In this Learning Unit, we'll discuss the theory behind vulnerability scanning. Before inspecting our tools, we need to outline the basic workflow of a vulnerability scanner and understand how it finds vulnerabilities. We will also review the different types and considerations of a vulnerability scan.

## 7.1.1. How Vulnerability Scanners Work

Every vulnerability scanner has its own customized workflow but the basic process behind vulnerability scanning is implementation independent. The basic process of an automated vulnerability scanner can be described as:

1.  Host discovery
2.  Port scanning
3.  Operating system, service, and version detection
4.  Matching the results to a vulnerability database

[_Host Discovery_](https://capec.mitre.org/data/definitions/292.html) tells the scanner if the target is up and responding. The scanner then uses various techniques to identify all open ports on the system and detect all remotely accessible services with corresponding versions. In addition, operating system detection will be done in this step.

Based on all gathered information, the vulnerability scanner will then query a vulnerability database to match the found data to vulnerabilities. Examples of vulnerability databases are the [_National Vulnerability Database_](https://nvd.nist.gov) and the [_Common Vulnerabilities and Exposures_](https://cve.mitre.org/cve/search_cve_list.html) (CVE) program.

Most commercial vulnerability scanners also have the functionality to verify found vulnerabilities by attempting to partially or fully exploit them. This can significantly reduce missed vulnerabilities but can impact the stability of the service or system.

Vulnerabilities are identified by the [CVE system](https://cve.mitre.org). While this allows us to identify and find verified vulnerabilities, the CVE identifier provides no information about the severity of a vulnerability.

The [_Common Vulnerability Scoring System_](https://nvd.nist.gov/vuln-metrics/cvss) (CVSS) is a framework for addressing the characteristics and severity of vulnerabilities. Each CVE has a CVSS score assigned. The two major versions are [CVSS v2](https://www.first.org/cvss/v2/guide) and [CVSS v3](https://www.first.org/cvss/user-guide). Both versions use a range from 0 to 10 to rate vulnerabilities with different severity labels. The following figure from the [_National Institute of Standards and Technology_](https://www.nist.gov/) (NIST) lists the range of the base score and associated severity for CVSS v2.0 and CVSS v3.0.

![Figure 1: CVSS Ratings](https://static.offsec.com/offsec-courses/PEN-200/imgs/vulnscan/fb1c4b88cfa79e2b55f21ff88ad29222-vulnscan_cvssv1.png)

Figure 1: CVSS Ratings

To obtain a CVSS score, we can review the CVE in a vulnerability database, or if there is no CVE assigned, we can use a [_CVSS calculator_](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator). In 2019, CVSS v3.1 was released, which clarified and improved the existing version.

We need to be aware that the results of a vulnerability scan can be incomplete or contain wrongfully detected vulnerabilities.

A [_false positive_](https://www.cgisecurity.com/questions/falsepositive.shtml) occurs when a vulnerability is detected but the target is not vulnerable. This can happen through a wrong service and version detection or a configuration that makes the target unexploitable. False positives can also occur when patches or updates are [_backported_](https://access.redhat.com/security/updates/backporting), meaning that security fixes are applied to an older version of software.

[_False negative_](https://www.cgisecurity.com/questions/falsenegative.shtml) is another important term. It occurs when a vulnerability is missed by the vulnerability scanner.

In a penetration test, we often need to find the right balance between manual and automated vulnerability scanning. Let's explore both options briefly.

A manual vulnerability scan will inevitably be very resource-intensive and time-consuming. When there is a huge amount of data to analyze, we often reach our cognitive limit quickly and overlook vital details. On the other hand, manual vulnerability scanning allows for the discovery of complex and logical vulnerabilities that are rather difficult to discover using any type of automated scanner.

Automated vulnerability scans are invaluable when working on engagements for a multitude of reasons. First, in nearly all types of assessments, we have time constraints. Therefore, when we have a big enterprise network to scan, we cannot manually review every system. This is especially true when thinking about new or complex vulnerabilities. Second, by using automated scanners, we can quickly identify easily detected vulnerabilities and other low-hanging fruit.

We should take the time to explore the inner workings of every automated tool we plan to use in a security assessment. This will not only assist us in configuring the tool and digesting the results properly but doing that will help us understand the limitations that must be overcome with manually applied expertise.

#### Labs

1.  Is this a false positive or a false negative? A vulnerability scanner identifies a vulnerability for a Linux web server. The target runs on Windows and the vulnerability is only exploitable on Linux.

Answer

# 7\. Vulnerability Scanning

In this Learning Module, we will cover the following Learning Units:

-   Vulnerability Scanning Theory
-   Vulnerability Scanning with Nessus
-   Vulnerability Scanning with Nmap

The discovery of vulnerabilities is an integral part of any security assessment. The process of identifying the attack surface of a piece of software, system, or network is called [_Vulnerability Scanning_](https://en.wikipedia.org/wiki/Vulnerability_scanner).

Vulnerability scanners come in many different forms, from individual scripts that identify a single vulnerability to complex commercial solutions that scan a broad variety of vulnerabilities. Automated vulnerability scanners can be invaluable for penetration testers as they help quickly establish a baseline on the target network before performing a more thorough manual testing analysis to get adequate coverage. Common types of vulnerability scanners are web application and network vulnerability scanners.

In this Module, we will analyze automated network vulnerability scanning. We'll begin with the theory behind vulnerability scanning and then use [_Nessus_](https://www.tenable.com/products/nessus) and [_Nmap_](https://nmap.org) to perform different kinds of vulnerability scans.

## 7.1. Vulnerability Scanning Theory

This Learning Unit covers the following Learning Objectives:

-   Gain a basic understanding of the vulnerability scanning process
-   Learn about the different types of vulnerability scans
-   Understand the considerations of a vulnerability scan

In this Learning Unit, we'll discuss the theory behind vulnerability scanning. Before inspecting our tools, we need to outline the basic workflow of a vulnerability scanner and understand how it finds vulnerabilities. We will also review the different types and considerations of a vulnerability scan.

## 7.1.1. How Vulnerability Scanners Work

Every vulnerability scanner has its own customized workflow but the basic process behind vulnerability scanning is implementation independent. The basic process of an automated vulnerability scanner can be described as:

1.  Host discovery
2.  Port scanning
3.  Operating system, service, and version detection
4.  Matching the results to a vulnerability database

[_Host Discovery_](https://capec.mitre.org/data/definitions/292.html) tells the scanner if the target is up and responding. The scanner then uses various techniques to identify all open ports on the system and detect all remotely accessible services with corresponding versions. In addition, operating system detection will be done in this step.

Based on all gathered information, the vulnerability scanner will then query a vulnerability database to match the found data to vulnerabilities. Examples of vulnerability databases are the [_National Vulnerability Database_](https://nvd.nist.gov) and the [_Common Vulnerabilities and Exposures_](https://cve.mitre.org/cve/search_cve_list.html) (CVE) program.

Most commercial vulnerability scanners also have the functionality to verify found vulnerabilities by attempting to partially or fully exploit them. This can significantly reduce missed vulnerabilities but can impact the stability of the service or system.

Vulnerabilities are identified by the [CVE system](https://cve.mitre.org). While this allows us to identify and find verified vulnerabilities, the CVE identifier provides no information about the severity of a vulnerability.

The [_Common Vulnerability Scoring System_](https://nvd.nist.gov/vuln-metrics/cvss) (CVSS) is a framework for addressing the characteristics and severity of vulnerabilities. Each CVE has a CVSS score assigned. The two major versions are [CVSS v2](https://www.first.org/cvss/v2/guide) and [CVSS v3](https://www.first.org/cvss/user-guide). Both versions use a range from 0 to 10 to rate vulnerabilities with different severity labels. The following figure from the [_National Institute of Standards and Technology_](https://www.nist.gov/) (NIST) lists the range of the base score and associated severity for CVSS v2.0 and CVSS v3.0.

![Figure 1: CVSS Ratings](https://static.offsec.com/offsec-courses/PEN-200/imgs/vulnscan/fb1c4b88cfa79e2b55f21ff88ad29222-vulnscan_cvssv1.png)

Figure 1: CVSS Ratings

To obtain a CVSS score, we can review the CVE in a vulnerability database, or if there is no CVE assigned, we can use a [_CVSS calculator_](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator). In 2019, CVSS v3.1 was released, which clarified and improved the existing version.

We need to be aware that the results of a vulnerability scan can be incomplete or contain wrongfully detected vulnerabilities.

A [_false positive_](https://www.cgisecurity.com/questions/falsepositive.shtml) occurs when a vulnerability is detected but the target is not vulnerable. This can happen through a wrong service and version detection or a configuration that makes the target unexploitable. False positives can also occur when patches or updates are [_backported_](https://access.redhat.com/security/updates/backporting), meaning that security fixes are applied to an older version of software.

[_False negative_](https://www.cgisecurity.com/questions/falsenegative.shtml) is another important term. It occurs when a vulnerability is missed by the vulnerability scanner.

In a penetration test, we often need to find the right balance between manual and automated vulnerability scanning. Let's explore both options briefly.

A manual vulnerability scan will inevitably be very resource-intensive and time-consuming. When there is a huge amount of data to analyze, we often reach our cognitive limit quickly and overlook vital details. On the other hand, manual vulnerability scanning allows for the discovery of complex and logical vulnerabilities that are rather difficult to discover using any type of automated scanner.

Automated vulnerability scans are invaluable when working on engagements for a multitude of reasons. First, in nearly all types of assessments, we have time constraints. Therefore, when we have a big enterprise network to scan, we cannot manually review every system. This is especially true when thinking about new or complex vulnerabilities. Second, by using automated scanners, we can quickly identify easily detected vulnerabilities and other low-hanging fruit.

We should take the time to explore the inner workings of every automated tool we plan to use in a security assessment. This will not only assist us in configuring the tool and digesting the results properly but doing that will help us understand the limitations that must be overcome with manually applied expertise.

#### Labs

1.  Is this a false positive or a false negative? A vulnerability scanner identifies a vulnerability for a Linux web server. The target runs on Windows and the vulnerability is only exploitable on Linux.

Answer

# 7\. Vulnerability Scanning

In this Learning Module, we will cover the following Learning Units:

-   Vulnerability Scanning Theory
-   Vulnerability Scanning with Nessus
-   Vulnerability Scanning with Nmap

The discovery of vulnerabilities is an integral part of any security assessment. The process of identifying the attack surface of a piece of software, system, or network is called [_Vulnerability Scanning_](https://en.wikipedia.org/wiki/Vulnerability_scanner).

Vulnerability scanners come in many different forms, from individual scripts that identify a single vulnerability to complex commercial solutions that scan a broad variety of vulnerabilities. Automated vulnerability scanners can be invaluable for penetration testers as they help quickly establish a baseline on the target network before performing a more thorough manual testing analysis to get adequate coverage. Common types of vulnerability scanners are web application and network vulnerability scanners.

In this Module, we will analyze automated network vulnerability scanning. We'll begin with the theory behind vulnerability scanning and then use [_Nessus_](https://www.tenable.com/products/nessus) and [_Nmap_](https://nmap.org) to perform different kinds of vulnerability scans.

## 7.1. Vulnerability Scanning Theory

This Learning Unit covers the following Learning Objectives:

-   Gain a basic understanding of the vulnerability scanning process
-   Learn about the different types of vulnerability scans
-   Understand the considerations of a vulnerability scan

In this Learning Unit, we'll discuss the theory behind vulnerability scanning. Before inspecting our tools, we need to outline the basic workflow of a vulnerability scanner and understand how it finds vulnerabilities. We will also review the different types and considerations of a vulnerability scan.

## 7.1.1. How Vulnerability Scanners Work

Every vulnerability scanner has its own customized workflow but the basic process behind vulnerability scanning is implementation independent. The basic process of an automated vulnerability scanner can be described as:

1.  Host discovery
2.  Port scanning
3.  Operating system, service, and version detection
4.  Matching the results to a vulnerability database

[_Host Discovery_](https://capec.mitre.org/data/definitions/292.html) tells the scanner if the target is up and responding. The scanner then uses various techniques to identify all open ports on the system and detect all remotely accessible services with corresponding versions. In addition, operating system detection will be done in this step.

Based on all gathered information, the vulnerability scanner will then query a vulnerability database to match the found data to vulnerabilities. Examples of vulnerability databases are the [_National Vulnerability Database_](https://nvd.nist.gov) and the [_Common Vulnerabilities and Exposures_](https://cve.mitre.org/cve/search_cve_list.html) (CVE) program.

Most commercial vulnerability scanners also have the functionality to verify found vulnerabilities by attempting to partially or fully exploit them. This can significantly reduce missed vulnerabilities but can impact the stability of the service or system.

Vulnerabilities are identified by the [CVE system](https://cve.mitre.org). While this allows us to identify and find verified vulnerabilities, the CVE identifier provides no information about the severity of a vulnerability.

The [_Common Vulnerability Scoring System_](https://nvd.nist.gov/vuln-metrics/cvss) (CVSS) is a framework for addressing the characteristics and severity of vulnerabilities. Each CVE has a CVSS score assigned. The two major versions are [CVSS v2](https://www.first.org/cvss/v2/guide) and [CVSS v3](https://www.first.org/cvss/user-guide). Both versions use a range from 0 to 10 to rate vulnerabilities with different severity labels. The following figure from the [_National Institute of Standards and Technology_](https://www.nist.gov/) (NIST) lists the range of the base score and associated severity for CVSS v2.0 and CVSS v3.0.

![Figure 1: CVSS Ratings](https://static.offsec.com/offsec-courses/PEN-200/imgs/vulnscan/fb1c4b88cfa79e2b55f21ff88ad29222-vulnscan_cvssv1.png)

Figure 1: CVSS Ratings

To obtain a CVSS score, we can review the CVE in a vulnerability database, or if there is no CVE assigned, we can use a [_CVSS calculator_](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator). In 2019, CVSS v3.1 was released, which clarified and improved the existing version.

We need to be aware that the results of a vulnerability scan can be incomplete or contain wrongfully detected vulnerabilities.

A [_false positive_](https://www.cgisecurity.com/questions/falsepositive.shtml) occurs when a vulnerability is detected but the target is not vulnerable. This can happen through a wrong service and version detection or a configuration that makes the target unexploitable. False positives can also occur when patches or updates are [_backported_](https://access.redhat.com/security/updates/backporting), meaning that security fixes are applied to an older version of software.

[_False negative_](https://www.cgisecurity.com/questions/falsenegative.shtml) is another important term. It occurs when a vulnerability is missed by the vulnerability scanner.

In a penetration test, we often need to find the right balance between manual and automated vulnerability scanning. Let's explore both options briefly.

A manual vulnerability scan will inevitably be very resource-intensive and time-consuming. When there is a huge amount of data to analyze, we often reach our cognitive limit quickly and overlook vital details. On the other hand, manual vulnerability scanning allows for the discovery of complex and logical vulnerabilities that are rather difficult to discover using any type of automated scanner.

Automated vulnerability scans are invaluable when working on engagements for a multitude of reasons. First, in nearly all types of assessments, we have time constraints. Therefore, when we have a big enterprise network to scan, we cannot manually review every system. This is especially true when thinking about new or complex vulnerabilities. Second, by using automated scanners, we can quickly identify easily detected vulnerabilities and other low-hanging fruit.

We should take the time to explore the inner workings of every automated tool we plan to use in a security assessment. This will not only assist us in configuring the tool and digesting the results properly but doing that will help us understand the limitations that must be overcome with manually applied expertise.

#### Labs

1.  Is this a false positive or a false negative? A vulnerability scanner identifies a vulnerability for a Linux web server. The target runs on Windows and the vulnerability is only exploitable on Linux.

Answer

# 7\. Vulnerability Scanning

In this Learning Module, we will cover the following Learning Units:

-   Vulnerability Scanning Theory
-   Vulnerability Scanning with Nessus
-   Vulnerability Scanning with Nmap

The discovery of vulnerabilities is an integral part of any security assessment. The process of identifying the attack surface of a piece of software, system, or network is called [_Vulnerability Scanning_](https://en.wikipedia.org/wiki/Vulnerability_scanner).

Vulnerability scanners come in many different forms, from individual scripts that identify a single vulnerability to complex commercial solutions that scan a broad variety of vulnerabilities. Automated vulnerability scanners can be invaluable for penetration testers as they help quickly establish a baseline on the target network before performing a more thorough manual testing analysis to get adequate coverage. Common types of vulnerability scanners are web application and network vulnerability scanners.

In this Module, we will analyze automated network vulnerability scanning. We'll begin with the theory behind vulnerability scanning and then use [_Nessus_](https://www.tenable.com/products/nessus) and [_Nmap_](https://nmap.org) to perform different kinds of vulnerability scans.

## 7.1. Vulnerability Scanning Theory

This Learning Unit covers the following Learning Objectives:

-   Gain a basic understanding of the vulnerability scanning process
-   Learn about the different types of vulnerability scans
-   Understand the considerations of a vulnerability scan

In this Learning Unit, we'll discuss the theory behind vulnerability scanning. Before inspecting our tools, we need to outline the basic workflow of a vulnerability scanner and understand how it finds vulnerabilities. We will also review the different types and considerations of a vulnerability scan.

## 7.1.1. How Vulnerability Scanners Work

Every vulnerability scanner has its own customized workflow but the basic process behind vulnerability scanning is implementation independent. The basic process of an automated vulnerability scanner can be described as:

1.  Host discovery
2.  Port scanning
3.  Operating system, service, and version detection
4.  Matching the results to a vulnerability database

[_Host Discovery_](https://capec.mitre.org/data/definitions/292.html) tells the scanner if the target is up and responding. The scanner then uses various techniques to identify all open ports on the system and detect all remotely accessible services with corresponding versions. In addition, operating system detection will be done in this step.

Based on all gathered information, the vulnerability scanner will then query a vulnerability database to match the found data to vulnerabilities. Examples of vulnerability databases are the [_National Vulnerability Database_](https://nvd.nist.gov) and the [_Common Vulnerabilities and Exposures_](https://cve.mitre.org/cve/search_cve_list.html) (CVE) program.

Most commercial vulnerability scanners also have the functionality to verify found vulnerabilities by attempting to partially or fully exploit them. This can significantly reduce missed vulnerabilities but can impact the stability of the service or system.

Vulnerabilities are identified by the [CVE system](https://cve.mitre.org). While this allows us to identify and find verified vulnerabilities, the CVE identifier provides no information about the severity of a vulnerability.

The [_Common Vulnerability Scoring System_](https://nvd.nist.gov/vuln-metrics/cvss) (CVSS) is a framework for addressing the characteristics and severity of vulnerabilities. Each CVE has a CVSS score assigned. The two major versions are [CVSS v2](https://www.first.org/cvss/v2/guide) and [CVSS v3](https://www.first.org/cvss/user-guide). Both versions use a range from 0 to 10 to rate vulnerabilities with different severity labels. The following figure from the [_National Institute of Standards and Technology_](https://www.nist.gov/) (NIST) lists the range of the base score and associated severity for CVSS v2.0 and CVSS v3.0.

![Figure 1: CVSS Ratings](https://static.offsec.com/offsec-courses/PEN-200/imgs/vulnscan/fb1c4b88cfa79e2b55f21ff88ad29222-vulnscan_cvssv1.png)

Figure 1: CVSS Ratings

To obtain a CVSS score, we can review the CVE in a vulnerability database, or if there is no CVE assigned, we can use a [_CVSS calculator_](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator). In 2019, CVSS v3.1 was released, which clarified and improved the existing version.

We need to be aware that the results of a vulnerability scan can be incomplete or contain wrongfully detected vulnerabilities.

A [_false positive_](https://www.cgisecurity.com/questions/falsepositive.shtml) occurs when a vulnerability is detected but the target is not vulnerable. This can happen through a wrong service and version detection or a configuration that makes the target unexploitable. False positives can also occur when patches or updates are [_backported_](https://access.redhat.com/security/updates/backporting), meaning that security fixes are applied to an older version of software.

[_False negative_](https://www.cgisecurity.com/questions/falsenegative.shtml) is another important term. It occurs when a vulnerability is missed by the vulnerability scanner.

In a penetration test, we often need to find the right balance between manual and automated vulnerability scanning. Let's explore both options briefly.

A manual vulnerability scan will inevitably be very resource-intensive and time-consuming. When there is a huge amount of data to analyze, we often reach our cognitive limit quickly and overlook vital details. On the other hand, manual vulnerability scanning allows for the discovery of complex and logical vulnerabilities that are rather difficult to discover using any type of automated scanner.

Automated vulnerability scans are invaluable when working on engagements for a multitude of reasons. First, in nearly all types of assessments, we have time constraints. Therefore, when we have a big enterprise network to scan, we cannot manually review every system. This is especially true when thinking about new or complex vulnerabilities. Second, by using automated scanners, we can quickly identify easily detected vulnerabilities and other low-hanging fruit.

We should take the time to explore the inner workings of every automated tool we plan to use in a security assessment. This will not only assist us in configuring the tool and digesting the results properly but doing that will help us understand the limitations that must be overcome with manually applied expertise.

#### Labs

1.  Is this a false positive or a false negative? A vulnerability scanner identifies a vulnerability for a Linux web server. The target runs on Windows and the vulnerability is only exploitable on Linux.

Answer

# 7\. Vulnerability Scanning

In this Learning Module, we will cover the following Learning Units:

-   Vulnerability Scanning Theory
-   Vulnerability Scanning with Nessus
-   Vulnerability Scanning with Nmap

The discovery of vulnerabilities is an integral part of any security assessment. The process of identifying the attack surface of a piece of software, system, or network is called [_Vulnerability Scanning_](https://en.wikipedia.org/wiki/Vulnerability_scanner).

Vulnerability scanners come in many different forms, from individual scripts that identify a single vulnerability to complex commercial solutions that scan a broad variety of vulnerabilities. Automated vulnerability scanners can be invaluable for penetration testers as they help quickly establish a baseline on the target network before performing a more thorough manual testing analysis to get adequate coverage. Common types of vulnerability scanners are web application and network vulnerability scanners.

In this Module, we will analyze automated network vulnerability scanning. We'll begin with the theory behind vulnerability scanning and then use [_Nessus_](https://www.tenable.com/products/nessus) and [_Nmap_](https://nmap.org) to perform different kinds of vulnerability scans.

## 7.1. Vulnerability Scanning Theory

This Learning Unit covers the following Learning Objectives:

-   Gain a basic understanding of the vulnerability scanning process
-   Learn about the different types of vulnerability scans
-   Understand the considerations of a vulnerability scan

In this Learning Unit, we'll discuss the theory behind vulnerability scanning. Before inspecting our tools, we need to outline the basic workflow of a vulnerability scanner and understand how it finds vulnerabilities. We will also review the different types and considerations of a vulnerability scan.

## 7.1.1. How Vulnerability Scanners Work

Every vulnerability scanner has its own customized workflow but the basic process behind vulnerability scanning is implementation independent. The basic process of an automated vulnerability scanner can be described as:

1.  Host discovery
2.  Port scanning
3.  Operating system, service, and version detection
4.  Matching the results to a vulnerability database

[_Host Discovery_](https://capec.mitre.org/data/definitions/292.html) tells the scanner if the target is up and responding. The scanner then uses various techniques to identify all open ports on the system and detect all remotely accessible services with corresponding versions. In addition, operating system detection will be done in this step.

Based on all gathered information, the vulnerability scanner will then query a vulnerability database to match the found data to vulnerabilities. Examples of vulnerability databases are the [_National Vulnerability Database_](https://nvd.nist.gov) and the [_Common Vulnerabilities and Exposures_](https://cve.mitre.org/cve/search_cve_list.html) (CVE) program.

Most commercial vulnerability scanners also have the functionality to verify found vulnerabilities by attempting to partially or fully exploit them. This can significantly reduce missed vulnerabilities but can impact the stability of the service or system.

Vulnerabilities are identified by the [CVE system](https://cve.mitre.org). While this allows us to identify and find verified vulnerabilities, the CVE identifier provides no information about the severity of a vulnerability.

The [_Common Vulnerability Scoring System_](https://nvd.nist.gov/vuln-metrics/cvss) (CVSS) is a framework for addressing the characteristics and severity of vulnerabilities. Each CVE has a CVSS score assigned. The two major versions are [CVSS v2](https://www.first.org/cvss/v2/guide) and [CVSS v3](https://www.first.org/cvss/user-guide). Both versions use a range from 0 to 10 to rate vulnerabilities with different severity labels. The following figure from the [_National Institute of Standards and Technology_](https://www.nist.gov/) (NIST) lists the range of the base score and associated severity for CVSS v2.0 and CVSS v3.0.

![Figure 1: CVSS Ratings](https://static.offsec.com/offsec-courses/PEN-200/imgs/vulnscan/fb1c4b88cfa79e2b55f21ff88ad29222-vulnscan_cvssv1.png)

Figure 1: CVSS Ratings

To obtain a CVSS score, we can review the CVE in a vulnerability database, or if there is no CVE assigned, we can use a [_CVSS calculator_](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator). In 2019, CVSS v3.1 was released, which clarified and improved the existing version.

We need to be aware that the results of a vulnerability scan can be incomplete or contain wrongfully detected vulnerabilities.

A [_false positive_](https://www.cgisecurity.com/questions/falsepositive.shtml) occurs when a vulnerability is detected but the target is not vulnerable. This can happen through a wrong service and version detection or a configuration that makes the target unexploitable. False positives can also occur when patches or updates are [_backported_](https://access.redhat.com/security/updates/backporting), meaning that security fixes are applied to an older version of software.

[_False negative_](https://www.cgisecurity.com/questions/falsenegative.shtml) is another important term. It occurs when a vulnerability is missed by the vulnerability scanner.

In a penetration test, we often need to find the right balance between manual and automated vulnerability scanning. Let's explore both options briefly.

A manual vulnerability scan will inevitably be very resource-intensive and time-consuming. When there is a huge amount of data to analyze, we often reach our cognitive limit quickly and overlook vital details. On the other hand, manual vulnerability scanning allows for the discovery of complex and logical vulnerabilities that are rather difficult to discover using any type of automated scanner.

Automated vulnerability scans are invaluable when working on engagements for a multitude of reasons. First, in nearly all types of assessments, we have time constraints. Therefore, when we have a big enterprise network to scan, we cannot manually review every system. This is especially true when thinking about new or complex vulnerabilities. Second, by using automated scanners, we can quickly identify easily detected vulnerabilities and other low-hanging fruit.

We should take the time to explore the inner workings of every automated tool we plan to use in a security assessment. This will not only assist us in configuring the tool and digesting the results properly but doing that will help us understand the limitations that must be overcome with manually applied expertise.

#### Labs

1.  Is this a false positive or a false negative? A vulnerability scanner identifies a vulnerability for a Linux web server. The target runs on Windows and the vulnerability is only exploitable on Linux.

Answer

# 7\. Vulnerability Scanning

In this Learning Module, we will cover the following Learning Units:

-   Vulnerability Scanning Theory
-   Vulnerability Scanning with Nessus
-   Vulnerability Scanning with Nmap

The discovery of vulnerabilities is an integral part of any security assessment. The process of identifying the attack surface of a piece of software, system, or network is called [_Vulnerability Scanning_](https://en.wikipedia.org/wiki/Vulnerability_scanner).

Vulnerability scanners come in many different forms, from individual scripts that identify a single vulnerability to complex commercial solutions that scan a broad variety of vulnerabilities. Automated vulnerability scanners can be invaluable for penetration testers as they help quickly establish a baseline on the target network before performing a more thorough manual testing analysis to get adequate coverage. Common types of vulnerability scanners are web application and network vulnerability scanners.

In this Module, we will analyze automated network vulnerability scanning. We'll begin with the theory behind vulnerability scanning and then use [_Nessus_](https://www.tenable.com/products/nessus) and [_Nmap_](https://nmap.org) to perform different kinds of vulnerability scans.

## 7.1. Vulnerability Scanning Theory

This Learning Unit covers the following Learning Objectives:

-   Gain a basic understanding of the vulnerability scanning process
-   Learn about the different types of vulnerability scans
-   Understand the considerations of a vulnerability scan

In this Learning Unit, we'll discuss the theory behind vulnerability scanning. Before inspecting our tools, we need to outline the basic workflow of a vulnerability scanner and understand how it finds vulnerabilities. We will also review the different types and considerations of a vulnerability scan.

## 7.1.1. How Vulnerability Scanners Work

Every vulnerability scanner has its own customized workflow but the basic process behind vulnerability scanning is implementation independent. The basic process of an automated vulnerability scanner can be described as:

1.  Host discovery
2.  Port scanning
3.  Operating system, service, and version detection
4.  Matching the results to a vulnerability database

[_Host Discovery_](https://capec.mitre.org/data/definitions/292.html) tells the scanner if the target is up and responding. The scanner then uses various techniques to identify all open ports on the system and detect all remotely accessible services with corresponding versions. In addition, operating system detection will be done in this step.

Based on all gathered information, the vulnerability scanner will then query a vulnerability database to match the found data to vulnerabilities. Examples of vulnerability databases are the [_National Vulnerability Database_](https://nvd.nist.gov) and the [_Common Vulnerabilities and Exposures_](https://cve.mitre.org/cve/search_cve_list.html) (CVE) program.

Most commercial vulnerability scanners also have the functionality to verify found vulnerabilities by attempting to partially or fully exploit them. This can significantly reduce missed vulnerabilities but can impact the stability of the service or system.

Vulnerabilities are identified by the [CVE system](https://cve.mitre.org). While this allows us to identify and find verified vulnerabilities, the CVE identifier provides no information about the severity of a vulnerability.

The [_Common Vulnerability Scoring System_](https://nvd.nist.gov/vuln-metrics/cvss) (CVSS) is a framework for addressing the characteristics and severity of vulnerabilities. Each CVE has a CVSS score assigned. The two major versions are [CVSS v2](https://www.first.org/cvss/v2/guide) and [CVSS v3](https://www.first.org/cvss/user-guide). Both versions use a range from 0 to 10 to rate vulnerabilities with different severity labels. The following figure from the [_National Institute of Standards and Technology_](https://www.nist.gov/) (NIST) lists the range of the base score and associated severity for CVSS v2.0 and CVSS v3.0.

![Figure 1: CVSS Ratings](https://static.offsec.com/offsec-courses/PEN-200/imgs/vulnscan/fb1c4b88cfa79e2b55f21ff88ad29222-vulnscan_cvssv1.png)

Figure 1: CVSS Ratings

To obtain a CVSS score, we can review the CVE in a vulnerability database, or if there is no CVE assigned, we can use a [_CVSS calculator_](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator). In 2019, CVSS v3.1 was released, which clarified and improved the existing version.

We need to be aware that the results of a vulnerability scan can be incomplete or contain wrongfully detected vulnerabilities.

A [_false positive_](https://www.cgisecurity.com/questions/falsepositive.shtml) occurs when a vulnerability is detected but the target is not vulnerable. This can happen through a wrong service and version detection or a configuration that makes the target unexploitable. False positives can also occur when patches or updates are [_backported_](https://access.redhat.com/security/updates/backporting), meaning that security fixes are applied to an older version of software.

[_False negative_](https://www.cgisecurity.com/questions/falsenegative.shtml) is another important term. It occurs when a vulnerability is missed by the vulnerability scanner.

In a penetration test, we often need to find the right balance between manual and automated vulnerability scanning. Let's explore both options briefly.

A manual vulnerability scan will inevitably be very resource-intensive and time-consuming. When there is a huge amount of data to analyze, we often reach our cognitive limit quickly and overlook vital details. On the other hand, manual vulnerability scanning allows for the discovery of complex and logical vulnerabilities that are rather difficult to discover using any type of automated scanner.

Automated vulnerability scans are invaluable when working on engagements for a multitude of reasons. First, in nearly all types of assessments, we have time constraints. Therefore, when we have a big enterprise network to scan, we cannot manually review every system. This is especially true when thinking about new or complex vulnerabilities. Second, by using automated scanners, we can quickly identify easily detected vulnerabilities and other low-hanging fruit.

We should take the time to explore the inner workings of every automated tool we plan to use in a security assessment. This will not only assist us in configuring the tool and digesting the results properly but doing that will help us understand the limitations that must be overcome with manually applied expertise.

#### Labs

1.  Is this a false positive or a false negative? A vulnerability scanner identifies a vulnerability for a Linux web server. The target runs on Windows and the vulnerability is only exploitable on Linux.

Answer